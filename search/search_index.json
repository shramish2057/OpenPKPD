{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"OpenPKPD Documentation","text":"<p>OpenPKPD is a transparent, validated pharmacokinetics and pharmacodynamics (PK/PD) modeling infrastructure built for reproducibility and scientific rigor.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Comprehensive PK/PD Models: One/Two/Three-compartment IV &amp; oral, transit absorption, Michaelis-Menten, direct Emax, sigmoid Emax, biophase equilibration, indirect response</li> <li>IV Infusion Support: Zero-order infusion with duration specification, overlapping infusions</li> <li>Population Simulation: Inter-individual variability (IIV), inter-occasion variability (IOV), and covariate effects</li> <li>Parameter Estimation (NLME): FOCE-I, SAEM, and Laplacian estimation methods with standard error computation</li> <li>Non-Compartmental Analysis (NCA): FDA/EMA-compliant exposure metrics with bioequivalence analysis</li> <li>Visual Predictive Checks (VPC): Standard VPC, prediction-corrected VPC (pcVPC), stratification, bootstrap CIs</li> <li>Clinical Trial Simulation: Parallel, crossover, dose-escalation, bioequivalence designs with power analysis</li> <li>Model Import: NONMEM (.ctl) and Monolix (.mlxtran) model file parsing</li> <li>Data Import: CDISC/SDTM format support (PC, EX, DM domains) in CSV and XPT formats</li> <li>Residual Error Models: Additive, proportional, combined, and exponential error</li> <li>Sensitivity Analysis: Single-subject and population-level parameter sensitivity</li> <li>Reproducible Artifacts: JSON-serialized execution artifacts with semantic versioning</li> <li>Multi-Language Support: Julia core with Python bindings and CLI interface</li> <li>Professional Visualization: Matplotlib and Plotly backends with estimation diagnostics</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#installation","title":"Installation","text":"<pre><code># Clone the repository\ngit clone https://github.com/openpkpd/openpkpd.git\ncd openpkpd\n\n# Install Julia dependencies\njulia --project=packages/core -e 'using Pkg; Pkg.instantiate()'\n\n# (Optional) Install Python bindings\ncd packages/python\npython3 -m venv .venv\nsource .venv/bin/activate\npip install -e \".[all]\"\n</code></pre>"},{"location":"#your-first-simulation-julia","title":"Your First Simulation (Julia)","text":"<pre><code>using OpenPKPDCore\n\n# Define a one-compartment IV bolus model\nspec = ModelSpec(\n    OneCompIVBolus(),\n    \"quickstart\",\n    OneCompIVBolusParams(5.0, 50.0),  # CL=5 L/h, V=50 L\n    [DoseEvent(0.0, 100.0)]            # 100 mg at t=0\n)\n\n# Define simulation grid and solver\ngrid = SimGrid(0.0, 24.0, collect(0.0:1.0:24.0))\nsolver = SolverSpec(:Tsit5, 1e-6, 1e-9, 10000)\n\n# Run simulation\nresult = simulate(spec, grid, solver)\n\n# Access results\nprintln(\"Time points: \", result.t)\nprintln(\"Concentrations: \", result.observations[:conc])\n</code></pre>"},{"location":"#your-first-simulation-python","title":"Your First Simulation (Python)","text":"<pre><code>import openpkpd\n\n# Initialize Julia bridge\nopenpkpd.init_julia()\n\n# Run IV bolus simulation\nresult = openpkpd.simulate_pk_iv_bolus(\n    cl=5.0,\n    v=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0,\n    t1=24.0,\n    saveat=[float(t) for t in range(25)]\n)\n\nprint(\"Concentrations:\", result[\"observations\"][\"conc\"])\n</code></pre>"},{"location":"#using-the-cli","title":"Using the CLI","text":"<pre><code># Check version\n./packages/cli/bin/openpkpd version\n\n# Run simulation from spec\n./packages/cli/bin/openpkpd simulate --spec simulation.json --out result.json\n\n# Run NCA analysis\n./packages/cli/bin/openpkpd nca --spec nca_spec.json --out nca_result.json\n\n# Run parameter estimation\n./packages/cli/bin/openpkpd estimate --spec estimate_spec.json --out fit.json\n\n# Compute VPC\n./packages/cli/bin/openpkpd vpc --spec vpc_spec.json --out vpc_result.json\n\n# Run clinical trial simulation\n./packages/cli/bin/openpkpd trial --spec trial_spec.json --out trial_result.json\n\n# Import NONMEM model\n./packages/cli/bin/openpkpd import --input run001.ctl --format nonmem --out model.json\n\n# Replay an artifact\n./packages/cli/bin/openpkpd replay --artifact validation/golden/pk_iv_bolus.json\n\n# Validate golden artifacts\n./packages/cli/bin/openpkpd validate-golden\n</code></pre>"},{"location":"#core-concepts","title":"Core Concepts","text":""},{"location":"#models","title":"Models","text":"<p>OpenPKPD provides a comprehensive library of validated pharmacokinetic and pharmacodynamic models:</p>"},{"location":"#pharmacokinetic-models","title":"Pharmacokinetic Models","text":"Model Description Key Use Cases <code>OneCompIVBolus</code> One-compartment with IV bolus dosing Simple IV drugs, initial PK characterization <code>OneCompOralFirstOrder</code> One-compartment with first-order oral absorption Immediate-release oral formulations <code>TwoCompIVBolus</code> Two-compartment with IV bolus dosing Distribution phase modeling, antibodies <code>TwoCompOral</code> Two-compartment with first-order oral absorption Oral drugs with tissue distribution <code>ThreeCompIVBolus</code> Three-compartment with IV bolus dosing Deep tissue distribution, long half-life drugs <code>TransitAbsorption</code> Transit compartment absorption model Delayed/complex oral absorption, GI transit <code>MichaelisMentenElimination</code> Saturable (nonlinear) elimination High-dose drugs, biologics, enzyme saturation"},{"location":"#pharmacodynamic-models","title":"Pharmacodynamic Models","text":"Model Description Key Use Cases <code>DirectEmax</code> Direct effect Emax model Immediate drug effects, receptor binding <code>SigmoidEmax</code> Sigmoid Emax with Hill coefficient Steep dose-response, cooperative binding <code>BiophaseEquilibration</code> Effect compartment model CNS effects, delayed equilibration <code>IndirectResponseTurnover</code> Indirect response turnover model Enzyme/receptor modulation, biomarkers"},{"location":"#non-compartmental-analysis-nca","title":"Non-Compartmental Analysis (NCA)","text":"<p>FDA/EMA-compliant NCA for exposure assessment:</p> <pre><code>from openpkpd.nca import run_nca\n\nresult = run_nca(times, conc, dose)\nprint(f\"Cmax: {result.cmax}, t\u00bd: {result.t_half}\")\n</code></pre>"},{"location":"#clinical-trial-simulation","title":"Clinical Trial Simulation","text":"<p>Complete trial simulation capabilities:</p> <pre><code>from openpkpd import trial\n\ndesign = trial.parallel_design(2)\nregimen = trial.dosing_qd(100.0, 28)\npop = trial.generate_virtual_population(100)\n</code></pre>"},{"location":"#visualization","title":"Visualization","text":"<p>Dual-backend (Matplotlib/Plotly) visualization:</p> <pre><code>from openpkpd import viz\n\nviz.set_backend(\"matplotlib\")\nviz.plot_conc_time(result)\nviz.plot_vpc(pop_result, observed_data)\n</code></pre>"},{"location":"#population-variability","title":"Population Variability","text":"<p>Model variability at multiple levels:</p> <ul> <li>IIV (Inter-Individual Variability): Log-normal distribution of parameters across individuals</li> <li>IOV (Inter-Occasion Variability): Parameter variation between dosing occasions</li> <li>Covariates: Linear, power, or exponential effects of patient characteristics</li> </ul>"},{"location":"#artifacts-reproducibility","title":"Artifacts &amp; Reproducibility","text":"<p>Every simulation can be serialized to a JSON artifact containing:</p> <ul> <li>Complete model specification</li> <li>Solver settings and grid</li> <li>Results with full precision</li> <li>Semantic version fingerprint</li> </ul> <p>Artifacts can be replayed to verify reproducibility across versions.</p>"},{"location":"#documentation-contents","title":"Documentation Contents","text":"Section Description Models Complete PK and PD model reference Parameter Estimation NLME estimation (FOCE-I, SAEM, Laplacian) Population Simulation IIV, IOV, and covariate modeling NCA Non-compartmental analysis (FDA/EMA compliant) VPC Visual Predictive Checks Trial Simulation Clinical trial design and simulation Data Import CDISC/SDTM data format support Model Import NONMEM and Monolix model parsing Visualization Matplotlib and Plotly plotting Sensitivity Analysis Parameter sensitivity methods Architecture System design and boundaries Semantics Versioning and numerical semantics Reproducibility Artifacts and validation CLI Reference Command-line interface Python Bindings Python API reference"},{"location":"#version-information","title":"Version Information","text":"<pre><code>OpenPKPD Version: 0.1.0\nEvent Semantics: 1.0.0\nSolver Semantics: 1.0.0\nArtifact Schema: 1.0.0\n</code></pre>"},{"location":"#license","title":"License","text":"<p>OpenPKPD is open source software. See the repository for license details.</p>"},{"location":"architecture/","title":"Architecture","text":"<p>OpenPKPD is designed with transparency, reproducibility, and validation as core principles.</p>"},{"location":"architecture/#design-philosophy","title":"Design Philosophy","text":""},{"location":"architecture/#1-pure-data-specifications","title":"1. Pure Data Specifications","text":"<p>All simulation inputs are immutable data structures with no hidden state:</p> <pre><code># Everything needed is explicit in the spec\nspec = ModelSpec(\n    OneCompIVBolus(),           # Model type\n    \"my_model\",                 # Name\n    OneCompIVBolusParams(5, 50), # Parameters\n    [DoseEvent(0, 100)]         # Doses\n)\n</code></pre> <p>Benefits:</p> <ul> <li>Complete traceability in artifacts</li> <li>No side effects or global state</li> <li>Reproducible across versions</li> </ul>"},{"location":"architecture/#2-validated-models","title":"2. Validated Models","text":"<p>Every model implementation includes:</p> <ul> <li>Mathematical equations documented in code</li> <li>Parameter validation (constraints checked at simulation time)</li> <li>Unit tests against analytical solutions</li> <li>Golden artifacts for regression testing</li> </ul>"},{"location":"architecture/#3-semantic-versioning","title":"3. Semantic Versioning","text":"<p>Three independent version numbers track numerical behavior:</p> Version Scope Example Change Event Semantics Dose handling How doses at t=0 are applied Solver Semantics ODE solving Tolerance interpretation Artifact Schema JSON format Field names, structure <p>Version Bump Policy: Any change to numerical output requires a semantic version bump.</p>"},{"location":"architecture/#4-artifact-driven-validation","title":"4. Artifact-Driven Validation","text":"<p>Every simulation can produce a JSON artifact that:</p> <ul> <li>Contains complete inputs and outputs</li> <li>Includes semantic version fingerprint</li> <li>Can be replayed to verify reproducibility</li> </ul>"},{"location":"architecture/#system-architecture","title":"System Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        User Interfaces                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   Julia API     \u2502   Python API    \u2502         CLI                 \u2502\n\u2502   (direct)      \u2502   (juliacall)   \u2502    (OpenPKPDCLI)           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                 \u2502                     \u2502\n         \u25bc                 \u25bc                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     OpenPKPDCore                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502   Models    \u2502  \u2502   Engine    \u2502  \u2502    Serialization        \u2502 \u2502\n\u2502  \u2502  (PK/PD)    \u2502  \u2502  (Solver)   \u2502  \u2502    (JSON Artifacts)     \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 Population  \u2502  \u2502 Sensitivity \u2502  \u2502    Analysis             \u2502 \u2502\n\u2502  \u2502 (IIV/IOV)   \u2502  \u2502 (Perturb)   \u2502  \u2502    (Metrics)            \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  DifferentialEquations.jl                       \u2502\n\u2502                      (ODE Solver)                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#module-structure","title":"Module Structure","text":""},{"location":"architecture/#core-coreopenpkpdcore","title":"Core (<code>core/OpenPKPDCore/</code>)","text":"<pre><code>src/\n\u251c\u2500\u2500 OpenPKPDCore.jl          # Module definition, exports\n\u251c\u2500\u2500 specs/\n\u2502   \u251c\u2500\u2500 specs.jl             # Core type definitions\n\u2502   \u251c\u2500\u2500 sensitivity.jl       # Perturbation types\n\u2502   \u2514\u2500\u2500 time_covariates.jl   # Time-varying covariate types\n\u251c\u2500\u2500 models/\n\u2502   \u251c\u2500\u2500 onecomp_iv_bolus.jl      # IV bolus model\n\u2502   \u251c\u2500\u2500 onecomp_oral_first_order.jl  # Oral model\n\u2502   \u2514\u2500\u2500 pk_interface.jl          # Common PK interface\n\u251c\u2500\u2500 pd/\n\u2502   \u251c\u2500\u2500 direct_emax.jl           # Direct Emax PD\n\u2502   \u2514\u2500\u2500 indirect_response_turnover.jl  # Indirect response PD\n\u251c\u2500\u2500 engine/\n\u2502   \u251c\u2500\u2500 events.jl            # Dose normalization\n\u2502   \u251c\u2500\u2500 callbacks.jl         # ODE callbacks\n\u2502   \u251c\u2500\u2500 solve.jl             # Main simulation\n\u2502   \u251c\u2500\u2500 pkpd.jl              # Sequential PKPD\n\u2502   \u251c\u2500\u2500 pkpd_coupled.jl      # Coupled PKPD\n\u2502   \u251c\u2500\u2500 population.jl        # Population simulation\n\u2502   \u251c\u2500\u2500 iov.jl               # Inter-occasion variability\n\u2502   \u251c\u2500\u2500 covariates.jl        # Covariate application\n\u2502   \u251c\u2500\u2500 time_covariates.jl   # Time-varying evaluation\n\u2502   \u251c\u2500\u2500 segment_sim.jl       # Segmented PK simulation\n\u2502   \u251c\u2500\u2500 segment_sim_pkpd.jl  # Segmented PKPD simulation\n\u2502   \u251c\u2500\u2500 sensitivity.jl       # Single sensitivity\n\u2502   \u251c\u2500\u2500 sensitivity_population.jl  # Population sensitivity\n\u2502   \u251c\u2500\u2500 sensitivity_metrics.jl     # Metric computation\n\u2502   \u251c\u2500\u2500 perturb.jl           # Perturbation application\n\u2502   \u251c\u2500\u2500 semantics.jl         # Event semantics\n\u2502   \u251c\u2500\u2500 solver_semantics.jl  # Solver semantics\n\u2502   \u2514\u2500\u2500 semantics_fingerprint.jl  # Version fingerprinting\n\u251c\u2500\u2500 serialization/\n\u2502   \u251c\u2500\u2500 schema.jl            # Schema version\n\u2502   \u251c\u2500\u2500 serialize.jl         # Single serialization\n\u2502   \u251c\u2500\u2500 deserialize.jl       # Single deserialization\n\u2502   \u251c\u2500\u2500 serialize_population.jl    # Population serialization\n\u2502   \u251c\u2500\u2500 deserialize_population.jl  # Population deserialization\n\u2502   \u251c\u2500\u2500 serialize_sensitivity.jl   # Sensitivity serialization\n\u2502   \u2514\u2500\u2500 deserialize_sensitivity.jl # Sensitivity deserialization\n\u2514\u2500\u2500 analysis/\n    \u2514\u2500\u2500 exposure.jl          # Cmax, AUC\n</code></pre>"},{"location":"architecture/#cli-cliopenpkpdcli","title":"CLI (<code>cli/OpenPKPDCLI/</code>)","text":"<pre><code>src/\n\u2514\u2500\u2500 OpenPKPDCLI.jl           # CLI commands\n</code></pre>"},{"location":"architecture/#python-pythonopenpkpd","title":"Python (<code>python/openpkpd/</code>)","text":"<pre><code>openpkpd/\n\u251c\u2500\u2500 __init__.py              # Package exports\n\u2514\u2500\u2500 bridge.py                # Julia-Python bridge\n</code></pre>"},{"location":"architecture/#data-flow","title":"Data Flow","text":""},{"location":"architecture/#single-simulation","title":"Single Simulation","text":"<pre><code>ModelSpec + SimGrid + SolverSpec\n            \u2502\n            \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502   validate   \u2502  Parameter constraints\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502\n            \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502 normalize_   \u2502  Dose preprocessing\n     \u2502 doses_for_   \u2502  (t0 doses \u2192 u0)\n     \u2502 sim          \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502\n            \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502  callbacks   \u2502  Dose callbacks for (t0,t1]\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502\n            \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502   solve      \u2502  DifferentialEquations.jl\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502\n            \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502  extract     \u2502  States \u2192 Observations\n     \u2502  results     \u2502  Output grid alignment\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502\n            \u25bc\n        SimResult\n</code></pre>"},{"location":"architecture/#population-simulation","title":"Population Simulation","text":"<pre><code>PopulationSpec + SimGrid + SolverSpec\n            \u2502\n            \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502  sample_iiv  \u2502  Generate \u03b7 per individual\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502\n            \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502 apply_covs   \u2502  Static covariate effects\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502\n            \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502 derive_occ   \u2502  Occasion boundaries\n     \u2502 (if IOV)     \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502\n            \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502  For each individual:            \u2502\n     \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n     \u2502  \u2502 sample_iov (if IOV)        \u2502  \u2502\n     \u2502  \u2502 segment_boundaries         \u2502  \u2502\n     \u2502  \u2502 simulate_segmented_pk/pkpd \u2502  \u2502\n     \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2502\n                    \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502  compute_    \u2502  Mean, median, quantiles\n     \u2502  summary     \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n            \u2502\n            \u25bc\n     PopulationResult\n</code></pre>"},{"location":"architecture/#type-hierarchy","title":"Type Hierarchy","text":""},{"location":"architecture/#model-kinds","title":"Model Kinds","text":"<pre><code>ModelKind (abstract)\n\u251c\u2500\u2500 OneCompIVBolus\n\u2514\u2500\u2500 OneCompOralFirstOrder\n\nPDModelKind (abstract)\n\u251c\u2500\u2500 DirectEmax\n\u2514\u2500\u2500 IndirectResponseTurnover\n</code></pre>"},{"location":"architecture/#random-effect-kinds","title":"Random Effect Kinds","text":"<pre><code>RandomEffectKind (abstract)\n\u2514\u2500\u2500 LogNormalIIV\n</code></pre>"},{"location":"architecture/#covariate-effect-kinds","title":"Covariate Effect Kinds","text":"<pre><code>CovariateEffectKind (abstract)\n\u251c\u2500\u2500 LinearCovariate\n\u251c\u2500\u2500 PowerCovariate\n\u2514\u2500\u2500 ExpCovariate\n</code></pre>"},{"location":"architecture/#time-covariate-kinds","title":"Time Covariate Kinds","text":"<pre><code>TimeCovariateKind (abstract)\n\u251c\u2500\u2500 StepTimeCovariate\n\u2514\u2500\u2500 LinearTimeCovariate\n</code></pre>"},{"location":"architecture/#perturbation-kinds","title":"Perturbation Kinds","text":"<pre><code>PerturbationKind (abstract)\n\u251c\u2500\u2500 RelativePerturbation\n\u2514\u2500\u2500 AbsolutePerturbation\n</code></pre>"},{"location":"architecture/#extension-points","title":"Extension Points","text":""},{"location":"architecture/#adding-a-new-pk-model","title":"Adding a New PK Model","text":"<ol> <li>Create <code>src/models/newmodel.jl</code></li> <li>Define <code>NewModel &lt;: ModelKind</code></li> <li>Define <code>NewModelParams</code> struct</li> <li>Implement required interface:</li> <li><code>pk_validate(spec::ModelSpec{NewModel})</code></li> <li><code>pk_param_tuple(spec::ModelSpec{NewModel})</code></li> <li><code>pk_state_symbols(::NewModel)</code></li> <li><code>pk_u0(spec::ModelSpec{NewModel}, grid)</code></li> <li><code>pk_ode!(du, u, p, t, ::NewModel)</code></li> <li><code>pk_conc(u, p, ::NewModel)</code></li> <li><code>pk_dose_target_index(::NewModel)</code></li> <li>Add exports to <code>OpenPKPDCore.jl</code></li> <li>Add serialization support</li> <li>Add tests and golden artifacts</li> </ol>"},{"location":"architecture/#adding-a-new-pd-model","title":"Adding a New PD Model","text":"<ol> <li>Create <code>src/pd/newpd.jl</code></li> <li>Define <code>NewPD &lt;: PDModelKind</code></li> <li>Define <code>NewPDParams</code> struct</li> <li>Implement <code>validate(spec::PDSpec{NewPD})</code></li> <li>For direct models: implement <code>evaluate(spec, input_series)</code></li> <li>For dynamic models: implement ODE interface</li> <li>Add serialization support</li> </ol>"},{"location":"architecture/#adding-a-new-covariate-effect","title":"Adding a New Covariate Effect","text":"<ol> <li>Define <code>NewEffect &lt;: CovariateEffectKind</code></li> <li>Add dispatch in <code>apply_covariates</code></li> <li>Add serialization support</li> </ol>"},{"location":"architecture/#validation-strategy","title":"Validation Strategy","text":""},{"location":"architecture/#unit-tests","title":"Unit Tests","text":"<pre><code># test/models/test_onecomp_iv_bolus.jl\n@test simulate(...) produces expected analytical solution\n</code></pre>"},{"location":"architecture/#golden-artifacts","title":"Golden Artifacts","text":"<pre><code>validation/golden/\n\u251c\u2500\u2500 pk_iv_bolus.json\n\u251c\u2500\u2500 pk_oral_first_order.json\n\u251c\u2500\u2500 population_iv_bolus.json\n\u251c\u2500\u2500 pkpd_direct_emax.json\n\u2514\u2500\u2500 sensitivity_single.json\n</code></pre>"},{"location":"architecture/#replay-validation","title":"Replay Validation","text":"<pre><code>artifact = read_execution_json(\"golden.json\")\nresult = replay_execution(artifact)\n@test result matches stored_result\n</code></pre>"},{"location":"architecture/#ci-pipeline","title":"CI Pipeline","text":"<ol> <li>Run unit tests</li> <li>Generate fresh artifacts</li> <li>Replay all golden artifacts</li> <li>Compare against stored results</li> <li>Fail if any mismatch</li> </ol>"},{"location":"architecture/#performance-considerations","title":"Performance Considerations","text":""},{"location":"architecture/#ode-solver","title":"ODE Solver","text":"<ul> <li>Uses DifferentialEquations.jl for production-quality solvers</li> <li>Default Tsit5 (5th order Runge-Kutta) for non-stiff problems</li> <li>Rosenbrock23 available for stiff problems</li> </ul>"},{"location":"architecture/#population-simulation_1","title":"Population Simulation","text":"<ul> <li>Sequential individual simulation (not parallel by default)</li> <li>Segmented simulation adds overhead for IOV/time-varying covariates</li> <li>Consider reducing population size for exploratory work</li> </ul>"},{"location":"architecture/#memory","title":"Memory","text":"<ul> <li>Each individual result stored separately</li> <li>Large populations with fine grids can consume significant memory</li> <li>Use sparse <code>saveat</code> grids when possible</li> </ul>"},{"location":"architecture/#thread-safety","title":"Thread Safety","text":"<ul> <li>All simulation functions are thread-safe</li> <li>No global mutable state</li> <li>Safe to run parallel simulations from different threads</li> </ul>"},{"location":"architecture/#dependencies","title":"Dependencies","text":""},{"location":"architecture/#julia","title":"Julia","text":"Package Purpose DifferentialEquations.jl ODE solving SciMLBase Scientific ML interface JSON Serialization ArgParse CLI parsing"},{"location":"architecture/#python","title":"Python","text":"Package Purpose juliacall Julia-Python bridge juliapkg Julia environment management"},{"location":"cli/","title":"CLI Reference","text":"<p>OpenPKPD provides a comprehensive command-line interface for PK/PD simulations, estimation, VPC, NCA, trial simulation, and model import.</p>"},{"location":"cli/#installation","title":"Installation","text":"<p>The CLI is located in <code>packages/cli/bin/openpkpd</code> and requires Julia with the OpenPKPDCore and OpenPKPDCLI packages.</p> <pre><code># Install dependencies\njulia --project=packages/core -e 'using Pkg; Pkg.instantiate()'\njulia --project=packages/cli -e 'using Pkg; Pkg.instantiate()'\n\n# Make executable\nchmod +x packages/cli/bin/openpkpd\n\n# Run CLI\n./packages/cli/bin/openpkpd &lt;command&gt; [options]\n</code></pre>"},{"location":"cli/#commands","title":"Commands","text":""},{"location":"cli/#version","title":"version","text":"<p>Display version information for all OpenPKPD components.</p> <pre><code>./packages/cli/bin/openpkpd version\n</code></pre> <p>Output:</p> <pre><code>OpenPKPD 0.1.0\nEvent semantics: 1.0.0\nSolver semantics: 1.0.0\nArtifact schema: 1.0.0\n</code></pre>"},{"location":"cli/#simulate","title":"simulate","text":"<p>Run a PK/PD simulation from a JSON specification.</p> <pre><code>./packages/cli/bin/openpkpd simulate --spec &lt;path&gt; [--out &lt;output_path&gt;]\n</code></pre> <p>Options:</p> Option Required Description <code>--spec</code> Yes Path to simulation specification JSON <code>--out</code> No Output path for result artifact <p>Example:</p> <pre><code>./packages/cli/bin/openpkpd simulate --spec simulation.json --out result.json\n</code></pre>"},{"location":"cli/#population","title":"population","text":"<p>Run a population simulation with IIV/IOV.</p> <pre><code>./packages/cli/bin/openpkpd population --spec &lt;path&gt; [--out &lt;output_path&gt;]\n</code></pre>"},{"location":"cli/#estimate","title":"estimate","text":"<p>Run NLME parameter estimation (FOCE-I, SAEM, or Laplacian).</p> <pre><code>./packages/cli/bin/openpkpd estimate --spec &lt;path&gt; [--out &lt;output_path&gt;]\n</code></pre> <p>Specification includes: observed data, model, estimation method, initial values, bounds.</p> <p>See Parameter Estimation for specification format.</p>"},{"location":"cli/#nca","title":"nca","text":"<p>Run non-compartmental analysis.</p> <pre><code>./packages/cli/bin/openpkpd nca --spec &lt;path&gt; [--out &lt;output_path&gt;]\n</code></pre> <p>See NCA for specification format.</p>"},{"location":"cli/#vpc","title":"vpc","text":"<p>Compute Visual Predictive Check.</p> <pre><code>./packages/cli/bin/openpkpd vpc --spec &lt;path&gt; [--out &lt;output_path&gt;]\n</code></pre> <p>See VPC for specification format.</p>"},{"location":"cli/#trial","title":"trial","text":"<p>Run clinical trial simulation.</p> <pre><code>./packages/cli/bin/openpkpd trial --spec &lt;path&gt; [--out &lt;output_path&gt;]\n</code></pre> <p>Supports parallel, crossover, dose-escalation, and bioequivalence designs.</p> <p>See Trial Simulation for specification format.</p>"},{"location":"cli/#import","title":"import","text":"<p>Import models from NONMEM or Monolix.</p> <pre><code>./packages/cli/bin/openpkpd import --input &lt;path&gt; --format &lt;format&gt; [--out &lt;output_path&gt;]\n</code></pre> <p>Options:</p> Option Required Description <code>--input</code> Yes Path to model file (.ctl or .mlxtran) <code>--format</code> Yes Format: <code>nonmem</code> or <code>monolix</code> <code>--out</code> No Output path for converted model <p>Examples:</p> <pre><code># Import NONMEM control file\n./packages/cli/bin/openpkpd import --input run001.ctl --format nonmem --out model.json\n\n# Import Monolix project\n./packages/cli/bin/openpkpd import --input project.mlxtran --format monolix --out model.json\n</code></pre> <p>See Model Import for details.</p>"},{"location":"cli/#sensitivity","title":"sensitivity","text":"<p>Run parameter sensitivity analysis.</p> <pre><code>./packages/cli/bin/openpkpd sensitivity --spec &lt;path&gt; [--out &lt;output_path&gt;]\n</code></pre>"},{"location":"cli/#metrics","title":"metrics","text":"<p>Compute PK/PD metrics from simulation results.</p> <pre><code>./packages/cli/bin/openpkpd metrics --artifact &lt;path&gt; --metrics &lt;list&gt;\n</code></pre> <p>Examples:</p> <pre><code>./packages/cli/bin/openpkpd metrics --artifact result.json --metrics cmax,tmax,auc\n</code></pre>"},{"location":"cli/#replay","title":"replay","text":"<p>Replay an execution artifact to verify reproducibility.</p> <pre><code>./packages/cli/bin/openpkpd replay --artifact &lt;path&gt; [--out &lt;output_path&gt;]\n</code></pre> <p>Options:</p> Option Required Description <code>--artifact</code> Yes Path to artifact JSON file <code>--out</code> No Path to write replayed artifact <p>Supported Artifact Types:</p> <ul> <li>Single execution (<code>artifact_type: \"single\"</code> or missing)</li> <li>Population execution (<code>artifact_type: \"population\"</code>)</li> <li>Single sensitivity (<code>artifact_type: \"sensitivity_single\"</code>)</li> <li>Population sensitivity (<code>artifact_type: \"sensitivity_population\"</code>)</li> <li>Estimation results (<code>artifact_type: \"estimation\"</code>)</li> </ul> <p>Examples:</p> <pre><code># Replay and verify\n./packages/cli/bin/openpkpd replay --artifact validation/golden/pk_iv_bolus.json\n\n# Replay and save output\n./packages/cli/bin/openpkpd replay --artifact my_simulation.json --out replayed.json\n\n# Replay population artifact\n./packages/cli/bin/openpkpd replay --artifact validation/golden/population_iv_bolus.json\n</code></pre>"},{"location":"cli/#validate-golden","title":"validate-golden","text":"<p>Run the full golden artifact validation suite.</p> <pre><code>./packages/cli/bin/openpkpd validate-golden\n</code></pre> <p>What It Does:</p> <ol> <li>Finds all golden artifacts in <code>validation/golden/</code></li> <li>Replays each artifact</li> <li>Compares replayed results to stored results</li> <li>Reports any discrepancies</li> </ol> <p>Output:</p> <pre><code>Validating golden artifacts...\n  pk_iv_bolus.json: PASS\n  pk_oral_first_order.json: PASS\n  population_iv_bolus.json: PASS\n  pkpd_direct_emax.json: PASS\n  sensitivity_single.json: PASS\n  ...\nAll golden artifacts validated successfully.\n</code></pre> <p>Exit Codes:</p> Code Meaning 0 All validations passed 1 One or more validations failed"},{"location":"cli/#help","title":"help","text":"<p>Display help for any command.</p> <pre><code>./packages/cli/bin/openpkpd help\n./packages/cli/bin/openpkpd help simulate\n./packages/cli/bin/openpkpd help estimate\n</code></pre>"},{"location":"cli/#artifact-format","title":"Artifact Format","text":"<p>All OpenPKPD artifacts are JSON files with a consistent structure.</p>"},{"location":"cli/#common-fields","title":"Common Fields","text":"<pre><code>{\n  \"artifact_schema_version\": \"1.0.0\",\n  \"semantics_fingerprint\": {\n    \"artifact_schema_version\": \"1.0.0\",\n    \"event_semantics_version\": \"1.0.0\",\n    \"solver_semantics_version\": \"1.0.0\"\n  }\n}\n</code></pre>"},{"location":"cli/#single-execution-artifact","title":"Single Execution Artifact","text":"<pre><code>{\n  \"artifact_schema_version\": \"1.0.0\",\n  \"execution_mode\": \"pk\",\n  \"model_spec\": {\n    \"kind\": \"OneCompIVBolus\",\n    \"name\": \"example\",\n    \"params\": {\"CL\": 5.0, \"V\": 50.0},\n    \"doses\": [{\"time\": 0.0, \"amount\": 100.0}]\n  },\n  \"grid\": {\n    \"t0\": 0.0,\n    \"t1\": 24.0,\n    \"saveat\": [0.0, 1.0, 2.0, ...]\n  },\n  \"solver\": {\n    \"alg\": \"Tsit5\",\n    \"reltol\": 1e-10,\n    \"abstol\": 1e-12,\n    \"maxiters\": 10000000\n  },\n  \"result\": {\n    \"t\": [0.0, 1.0, 2.0, ...],\n    \"states\": {\"A_central\": [...]},\n    \"observations\": {\"conc\": [...]},\n    \"metadata\": {...}\n  }\n}\n</code></pre>"},{"location":"cli/#population-artifact","title":"Population Artifact","text":"<pre><code>{\n  \"artifact_type\": \"population\",\n  \"population_spec\": {\n    \"base_model_spec\": {...},\n    \"iiv\": {\n      \"kind\": \"LogNormalIIV\",\n      \"omegas\": {\"CL\": 0.3, \"V\": 0.2},\n      \"seed\": 12345,\n      \"n\": 100\n    },\n    \"iov\": null,\n    \"covariate_model\": null,\n    \"covariates\": []\n  },\n  \"result\": {\n    \"individuals\": [...],\n    \"params\": [...],\n    \"summaries\": {\n      \"conc\": {\n        \"observation\": \"conc\",\n        \"probs\": [0.05, 0.95],\n        \"mean\": [...],\n        \"median\": [...],\n        \"quantiles\": {...}\n      }\n    },\n    \"metadata\": {...}\n  }\n}\n</code></pre>"},{"location":"cli/#integration-examples","title":"Integration Examples","text":""},{"location":"cli/#cicd-pipeline","title":"CI/CD Pipeline","text":"<pre><code># .github/workflows/validate.yml\nname: Golden Validation\non: [push, pull_request]\njobs:\n  validate:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: julia-actions/setup-julia@v1\n      - run: julia --project=core/OpenPKPDCore -e 'using Pkg; Pkg.instantiate()'\n      - run: ./bin/openpkpd validate-golden\n</code></pre>"},{"location":"cli/#batch-replay","title":"Batch Replay","text":"<pre><code>#!/bin/bash\n# replay_all.sh - Replay all artifacts in a directory\n\nfor artifact in artifacts/*.json; do\n    echo \"Replaying: $artifact\"\n    ./bin/openpkpd replay --artifact \"$artifact\" --out \"replayed/$(basename $artifact)\"\ndone\n</code></pre>"},{"location":"cli/#compare-artifacts","title":"Compare Artifacts","text":"<pre><code># Generate new artifact\njulia --project=core/OpenPKPDCore my_simulation.jl\n\n# Compare with golden\ndiff &lt;(jq -S . validation/golden/pk_iv_bolus.json) &lt;(jq -S . my_artifact.json)\n</code></pre>"},{"location":"cli/#troubleshooting","title":"Troubleshooting","text":""},{"location":"cli/#julia-not-found","title":"Julia Not Found","text":"<pre><code>Error: julia: command not found\n</code></pre> <p>Solution: Ensure Julia is installed and in your PATH.</p>"},{"location":"cli/#package-not-installed","title":"Package Not Installed","text":"<pre><code>Error: ArgumentError: Package OpenPKPDCore not found\n</code></pre> <p>Solution: Install dependencies:</p> <pre><code>julia --project=core/OpenPKPDCore -e 'using Pkg; Pkg.instantiate()'\njulia --project=cli/OpenPKPDCLI -e 'using Pkg; Pkg.instantiate()'\n</code></pre>"},{"location":"cli/#artifact-schema-mismatch","title":"Artifact Schema Mismatch","text":"<pre><code>Warning: Artifact schema version mismatch\n</code></pre> <p>Cause: Artifact was created with a different version of OpenPKPD.</p> <p>Solution: Re-generate the artifact or update your OpenPKPD installation.</p>"},{"location":"cli/#environment-variables","title":"Environment Variables","text":"Variable Description Default <code>JULIA_PROJECT</code> Julia project path Auto-detected <code>OPENPKPD_ROOT</code> Repository root Auto-detected"},{"location":"cli/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success 1 General error 2 Invalid arguments 3 File not found 4 Validation failure"},{"location":"data/","title":"Data Import","text":"<p>OpenPKPD supports importing clinical pharmacokinetic data from CDISC/SDTM format, enabling analysis of real-world study data.</p>"},{"location":"data/#cdiscsdtm-format","title":"CDISC/SDTM Format","text":"<p>CDISC (Clinical Data Interchange Standards Consortium) defines standard formats for clinical trial data. OpenPKPD reads the following domains:</p> Domain Description Key Variables PC Pharmacokinetic Concentrations USUBJID, PCTESTCD, PCSTRESN, PCTPTNUM EX Exposure (Dosing) USUBJID, EXDOSE, EXROUTE, EXSTDTC, EXDUR DM Demographics USUBJID, AGE, SEX, RACE, WEIGHT PP PK Parameters (optional) USUBJID, PPTESTCD, PPSTRESN"},{"location":"data/#reading-cdisc-data","title":"Reading CDISC Data","text":""},{"location":"data/#csv-format","title":"CSV Format","text":"<pre><code>using OpenPKPDCore\n\n# Read CDISC domains from CSV files\ndataset = read_cdisc_csv(\n    \"pc.csv\",   # Concentrations\n    \"ex.csv\",   # Dosing\n    \"dm.csv\"    # Demographics (optional)\n)\n</code></pre> <pre><code>from openpkpd.data import read_cdisc_csv\n\ndataset = read_cdisc_csv(\"pc.csv\", \"ex.csv\", \"dm.csv\")\n</code></pre>"},{"location":"data/#sas-transport-xpt-format","title":"SAS Transport (XPT) Format","text":"<pre><code># Read SAS transport files\ndataset = read_cdisc_xpt(\n    \"pc.xpt\",\n    \"ex.xpt\",\n    \"dm.xpt\"\n)\n</code></pre> <pre><code>from openpkpd.data import read_cdisc_xpt\n\ndataset = read_cdisc_xpt(\"pc.xpt\", \"ex.xpt\", \"dm.xpt\")\n</code></pre>"},{"location":"data/#data-validation","title":"Data Validation","text":"<p>Validate your CDISC data against standards:</p> <pre><code>warnings = validate_cdisc_dataset(dataset)\n\nfor w in warnings\n    println(\"Warning: \", w)\nend\n</code></pre> <pre><code>from openpkpd.data import validate_cdisc_dataset\n\nwarnings = validate_cdisc_dataset(dataset)\nfor w in warnings:\n    print(f\"Warning: {w}\")\n</code></pre>"},{"location":"data/#validation-checks","title":"Validation Checks","text":"Check Description Required variables Ensures mandatory fields are present Data types Validates numeric/string field types Subject consistency Cross-checks USUBJID across domains Time ordering Verifies chronological order Dose-observation matching Ensures subjects with PK have dosing"},{"location":"data/#converting-to-openpkpd-format","title":"Converting to OpenPKPD Format","text":"<p>Convert CDISC data to OpenPKPD's internal format:</p> <pre><code># Convert to PopulationSpec and ObservedData\npop_spec, observed = cdisc_to_population(\n    dataset,\n    model_spec;\n    covariate_mapping=Dict(\n        :WT =&gt; :WEIGHT,\n        :CRCL =&gt; :CREATININE_CL\n    )\n)\n</code></pre> <pre><code>from openpkpd.data import cdisc_to_population\n\npop_spec, observed = cdisc_to_population(\n    dataset,\n    model_spec,\n    covariate_mapping={\"WT\": \"WEIGHT\", \"CRCL\": \"CREATININE_CL\"}\n)\n</code></pre>"},{"location":"data/#observeddata-structure","title":"ObservedData Structure","text":"Field Description <code>subject_ids</code> Unique subject identifiers <code>times</code> Observation times <code>observations</code> Observed concentration values <code>dvid</code> Dependent variable ID (for multiple endpoints) <code>doses</code> Dose events extracted from EX domain <code>covariates</code> Subject-level covariates from DM"},{"location":"data/#handling-infusions","title":"Handling Infusions","text":"<p>The EX domain supports infusion duration via the EXDUR field (ISO 8601 duration):</p> <pre><code>USUBJID,EXDOSE,EXROUTE,EXSTDTC,EXDUR\n001,100,IV,2024-01-01T08:00,PT1H\n002,100,IV,2024-01-01T08:00,PT30M\n</code></pre> <p>Duration codes: - <code>PT1H</code> = 1 hour - <code>PT30M</code> = 30 minutes - <code>PT2H30M</code> = 2.5 hours</p> <p>OpenPKPD automatically parses these into DoseEvent duration fields.</p>"},{"location":"data/#pc-domain-format","title":"PC Domain Format","text":"<p>Example PC domain CSV:</p> <pre><code>USUBJID,PCTESTCD,PCTEST,PCSTRESN,PCSTRESU,PCTPTNUM,PCTPT,PCSPEC\n001,DRUG,Drug Concentration,2.5,ng/mL,1,1 hour post-dose,PLASMA\n001,DRUG,Drug Concentration,1.8,ng/mL,2,2 hours post-dose,PLASMA\n001,DRUG,Drug Concentration,1.2,ng/mL,4,4 hours post-dose,PLASMA\n</code></pre> <p>Key variables: - <code>PCSTRESN</code>: Numeric result (concentration) - <code>PCTPTNUM</code>: Numeric time point - <code>PCSPEC</code>: Specimen type (PLASMA, SERUM, etc.)</p>"},{"location":"data/#ex-domain-format","title":"EX Domain Format","text":"<p>Example EX domain CSV:</p> <pre><code>USUBJID,EXDOSE,EXDOSU,EXROUTE,EXSTDTC,EXENDTC,EXDUR\n001,100,mg,IV,2024-01-01T08:00,2024-01-01T09:00,PT1H\n002,100,mg,ORAL,2024-01-01T08:00,,\n</code></pre> <p>Key variables: - <code>EXDOSE</code>: Dose amount - <code>EXROUTE</code>: Route of administration - <code>EXDUR</code>: Duration for infusions (ISO 8601)</p>"},{"location":"data/#dm-domain-format","title":"DM Domain Format","text":"<p>Example DM domain CSV:</p> <pre><code>USUBJID,AGE,AGEU,SEX,RACE,WEIGHT,WEIGHTU,HEIGHT,HEIGHTU\n001,45,YEARS,M,WHITE,80,kg,175,cm\n002,52,YEARS,F,ASIAN,65,kg,162,cm\n</code></pre>"},{"location":"data/#blq-handling","title":"BLQ Handling","text":"<p>Handle below-limit-of-quantification (BLQ) data:</p> <pre><code>from openpkpd.data import read_cdisc_csv\n\ndataset = read_cdisc_csv(\n    \"pc.csv\", \"ex.csv\", \"dm.csv\",\n    blq_handling=\"lloq_half\"  # Replace BLQ with LLOQ/2\n)\n</code></pre> <p>BLQ handling options: - <code>\"zero\"</code>: Set BLQ values to 0 - <code>\"missing\"</code>: Exclude BLQ observations - <code>\"lloq_half\"</code>: Set BLQ to LLOQ/2 - <code>\"m3\"</code>: Use M3 method (likelihood-based)</p>"},{"location":"data/#multiple-analytes","title":"Multiple Analytes","text":"<p>Handle studies with multiple analytes (parent + metabolite):</p> <pre><code># Filter by analyte\nparent_data = dataset.filter_analyte(\"DRUG\")\nmetabolite_data = dataset.filter_analyte(\"METAB\")\n\n# Or use DVID for multiple endpoints\npop_spec, observed = cdisc_to_population(\n    dataset,\n    model_spec,\n    dvid_mapping={1: \"conc_parent\", 2: \"conc_metabolite\"}\n)\n</code></pre>"},{"location":"data/#cli-usage","title":"CLI Usage","text":"<pre><code># Read CDISC data and convert to OpenPKPD format\n./packages/cli/bin/openpkpd data --format cdisc \\\n    --pc pc.csv --ex ex.csv --dm dm.csv \\\n    --out dataset.json\n</code></pre>"},{"location":"data/#example-workflow","title":"Example Workflow","text":""},{"location":"data/#from-cdisc-to-estimation","title":"From CDISC to Estimation","text":"<pre><code>from openpkpd.data import read_cdisc_csv, cdisc_to_population\nfrom openpkpd.estimation import estimate, EstimationConfig, FOCEIMethod\n\n# 1. Read CDISC data\ndataset = read_cdisc_csv(\"pc.csv\", \"ex.csv\", \"dm.csv\")\n\n# 2. Validate\nwarnings = validate_cdisc_dataset(dataset)\nprint(f\"Validation warnings: {len(warnings)}\")\n\n# 3. Convert to OpenPKPD format\nmodel_spec = create_model_spec(\"OneCompOralFirstOrder\", initial_params)\npop_spec, observed = cdisc_to_population(dataset, model_spec)\n\n# 4. Run estimation\nconfig = EstimationConfig(\n    method=FOCEIMethod(),\n    theta_init=[1.0, 5.0, 50.0],\n    # ... other settings\n)\nresult = estimate(observed, model_spec, config)\n</code></pre>"},{"location":"data/#from-cdisc-to-vpc","title":"From CDISC to VPC","text":"<pre><code>from openpkpd.data import read_cdisc_csv, cdisc_to_population\nfrom openpkpd.analysis import compute_vpc\n\n# 1. Read and convert data\ndataset = read_cdisc_csv(\"pc.csv\", \"ex.csv\", \"dm.csv\")\npop_spec, observed = cdisc_to_population(dataset, model_spec)\n\n# 2. Compute VPC\nvpc_result = compute_vpc(observed, pop_spec, grid, solver)\n</code></pre>"},{"location":"data/#see-also","title":"See Also","text":"<ul> <li>Model Import - Importing NONMEM/Monolix models</li> <li>Parameter Estimation - Fitting models to data</li> <li>VPC - Visual Predictive Checks</li> </ul>"},{"location":"estimation/","title":"Parameter Estimation (NLME)","text":"<p>OpenPKPD provides nonlinear mixed-effects (NLME) parameter estimation for population pharmacokinetic/pharmacodynamic modeling. Three estimation methods are available: FOCE-I, SAEM, and Laplacian approximation.</p>"},{"location":"estimation/#overview","title":"Overview","text":"<p>Parameter estimation fits model parameters to observed data while accounting for: - Fixed effects (theta): Population typical values (e.g., CL, V) - Random effects (eta): Individual deviations from population means - Variance components (omega): Between-subject variability - Residual error (sigma): Unexplained variability</p>"},{"location":"estimation/#estimation-methods","title":"Estimation Methods","text":""},{"location":"estimation/#foce-i-first-order-conditional-estimation-with-interaction","title":"FOCE-I (First-Order Conditional Estimation with Interaction)","text":"<p>The gold standard for NLME estimation, used by NONMEM and other tools.</p> <p>Algorithm: 1. For each individual, find the mode of the conditional distribution (eta) 2. Linearize the model around the conditional mode 3. Optimize population parameters using the linearized likelihood 4. Iterate until convergence</p> <p>Advantages: - Well-established with decades of validation - Handles interaction between eta and epsilon - Good balance of speed and accuracy</p> <p>Julia: <pre><code>config = EstimationConfig(\n    FOCEIMethod(\n        max_inner_iter=100,  # Max iterations for eta optimization\n        inner_tol=1e-6,       # Tolerance for eta convergence\n        centered=false        # Use uncentered parameterization\n    ),\n    theta_init=[5.0, 50.0],\n    theta_lower=[0.1, 1.0],\n    theta_upper=[100.0, 500.0],\n    omega_init=diagm([0.09, 0.04]),\n    omega_structure=:diagonal,\n    sigma_init=ResidualErrorSpec(ProportionalError(), (sigma=0.1,), :conc, UInt64(0)),\n    max_iter=500,\n    compute_se=true\n)\n\nresult = estimate(observed_data, model_spec, config; grid=grid, solver=solver)\n</code></pre></p> <p>Python: <pre><code>from openpkpd.estimation import estimate, EstimationConfig, FOCEIMethod\n\nconfig = EstimationConfig(\n    method=FOCEIMethod(max_inner_iter=100, inner_tol=1e-6),\n    theta_init=[5.0, 50.0],\n    theta_lower=[0.1, 1.0],\n    theta_upper=[100.0, 500.0],\n    omega_init=[[0.09, 0], [0, 0.04]],\n    sigma_init={\"kind\": \"proportional\", \"value\": 0.1},\n    max_iter=500,\n    compute_se=True\n)\n\nresult = estimate(observed_data, model_spec, config)\n</code></pre></p>"},{"location":"estimation/#saem-stochastic-approximation-em","title":"SAEM (Stochastic Approximation EM)","text":"<p>A Monte Carlo-based method that can handle complex models.</p> <p>Algorithm: 1. E-step: Sample from the conditional distribution of eta using MCMC 2. M-step: Update population parameters using sufficient statistics 3. Use stochastic approximation to smooth updates 4. Continue until convergence</p> <p>Advantages: - Robust for complex models - Handles multiple modes in the likelihood - Used by Monolix</p> <p>Julia: <pre><code>config = EstimationConfig(\n    SAEMMethod(\n        n_burn=200,    # Burn-in iterations\n        n_iter=300,    # Main iterations\n        n_chains=3     # MCMC chains per subject\n    ),\n    theta_init=[5.0, 50.0],\n    # ... same as FOCE-I\n)\n</code></pre></p> <p>Python: <pre><code>from openpkpd.estimation import SAEMMethod\n\nconfig = EstimationConfig(\n    method=SAEMMethod(n_burn=200, n_iter=300, n_chains=3),\n    # ... same as FOCE-I\n)\n</code></pre></p>"},{"location":"estimation/#laplacian-approximation","title":"Laplacian Approximation","text":"<p>A simpler approximation that works well for sparse data.</p> <p>Algorithm: 1. Approximate the marginal likelihood using Laplace's method 2. Find the mode of the joint density 3. Use the Hessian at the mode for the approximation</p> <p>Advantages: - Fast computation - Good baseline for comparison - Works well with sparse data</p> <p>Julia: <pre><code>config = EstimationConfig(\n    LaplacianMethod(),\n    theta_init=[5.0, 50.0],\n    # ... same as FOCE-I\n)\n</code></pre></p>"},{"location":"estimation/#residual-error-models","title":"Residual Error Models","text":"<p>OpenPKPD supports four residual error models:</p>"},{"location":"estimation/#additive-error","title":"Additive Error","text":"\\[Y = F + \\epsilon, \\quad \\epsilon \\sim N(0, \\sigma^2)\\] <pre><code>error_spec = ResidualErrorSpec(AdditiveError(), (sigma=0.5,), :conc, seed)\n</code></pre>"},{"location":"estimation/#proportional-error","title":"Proportional Error","text":"\\[Y = F \\cdot (1 + \\epsilon), \\quad \\epsilon \\sim N(0, \\sigma^2)\\] <pre><code>error_spec = ResidualErrorSpec(ProportionalError(), (sigma=0.1,), :conc, seed)\n</code></pre>"},{"location":"estimation/#combined-error","title":"Combined Error","text":"\\[Y = F + F \\cdot \\epsilon_1 + \\epsilon_2\\] <pre><code>error_spec = ResidualErrorSpec(CombinedError(), (sigma_add=0.5, sigma_prop=0.1), :conc, seed)\n</code></pre>"},{"location":"estimation/#exponential-error","title":"Exponential Error","text":"\\[Y = F \\cdot e^{\\epsilon}, \\quad \\epsilon \\sim N(0, \\sigma^2)\\] <pre><code>error_spec = ResidualErrorSpec(ExponentialError(), (sigma=0.1,), :conc, seed)\n</code></pre>"},{"location":"estimation/#estimation-results","title":"Estimation Results","text":"<p>The <code>EstimationResult</code> contains:</p> Field Description <code>theta</code> Final population parameter estimates <code>theta_se</code> Standard errors for theta <code>omega</code> Final variance-covariance matrix <code>omega_se</code> Standard errors for omega elements <code>sigma</code> Final residual error parameters <code>sigma_se</code> Standard errors for sigma <code>ofv</code> Objective function value (-2LL) <code>aic</code> Akaike Information Criterion <code>bic</code> Bayesian Information Criterion <code>individuals</code> Per-subject estimates and diagnostics <code>convergence</code> Whether estimation converged <code>n_iterations</code> Number of iterations"},{"location":"estimation/#individual-estimates","title":"Individual Estimates","text":"<p>Each individual result contains:</p> Field Description <code>subject_id</code> Subject identifier <code>eta</code> Individual random effects <code>ipred</code> Individual predictions <code>cwres</code> Conditional weighted residuals <code>ofv_contribution</code> Individual contribution to OFV"},{"location":"estimation/#diagnostics","title":"Diagnostics","text":""},{"location":"estimation/#goodness-of-fit-plots","title":"Goodness-of-Fit Plots","text":"<p>Python: <pre><code>from openpkpd import viz\n\n# Observed vs Population Predicted\nviz.plot_goodness_of_fit(result, plot_type=\"obs_vs_pred\")\n\n# Observed vs Individual Predicted\nviz.plot_goodness_of_fit(result, plot_type=\"obs_vs_ipred\")\n\n# CWRES vs Time\nviz.plot_goodness_of_fit(result, plot_type=\"cwres_vs_time\")\n\n# CWRES vs PRED\nviz.plot_goodness_of_fit(result, plot_type=\"cwres_vs_pred\")\n\n# CWRES QQ Plot\nviz.plot_goodness_of_fit(result, plot_type=\"cwres_qq\")\n\n# ETA Distribution\nviz.plot_goodness_of_fit(result, plot_type=\"eta_dist\")\n\n# 4-Panel Summary\nviz.plot_estimation_summary(result)\n</code></pre></p>"},{"location":"estimation/#model-comparison","title":"Model Comparison","text":"<pre><code># Compare models using AIC/BIC\nprint(f\"Model 1 AIC: {result1.aic:.2f}, BIC: {result1.bic:.2f}\")\nprint(f\"Model 2 AIC: {result2.aic:.2f}, BIC: {result2.bic:.2f}\")\n\n# Likelihood ratio test (nested models)\ndelta_ofv = result1.ofv - result2.ofv\ndf = n_params2 - n_params1\nfrom scipy.stats import chi2\np_value = 1 - chi2.cdf(delta_ofv, df)\n</code></pre>"},{"location":"estimation/#configuration-options","title":"Configuration Options","text":""},{"location":"estimation/#theta-fixed-effects","title":"Theta (Fixed Effects)","text":"Parameter Description <code>theta_init</code> Initial parameter values <code>theta_lower</code> Lower bounds <code>theta_upper</code> Upper bounds"},{"location":"estimation/#omega-between-subject-variability","title":"Omega (Between-Subject Variability)","text":"Parameter Description <code>omega_init</code> Initial variance-covariance matrix <code>omega_structure</code> <code>:diagonal</code> or <code>:block</code>"},{"location":"estimation/#optimization","title":"Optimization","text":"Parameter Description <code>max_iter</code> Maximum outer iterations <code>compute_se</code> Whether to compute standard errors"},{"location":"estimation/#cli-usage","title":"CLI Usage","text":"<pre><code>./packages/cli/bin/openpkpd estimate --spec estimate_spec.json --out fit.json\n</code></pre> <p>Specification Format: <pre><code>{\n  \"data\": \"observed.csv\",\n  \"model\": {\n    \"kind\": \"OneCompOralFirstOrder\",\n    \"params\": {\"Ka\": 1.0, \"CL\": 5.0, \"V\": 50.0}\n  },\n  \"estimation\": {\n    \"method\": \"FOCE-I\",\n    \"theta_init\": [1.0, 5.0, 50.0],\n    \"theta_lower\": [0.1, 0.1, 1.0],\n    \"theta_upper\": [10.0, 100.0, 500.0],\n    \"omega_init\": [[0.09, 0, 0], [0, 0.09, 0], [0, 0, 0.04]],\n    \"omega_structure\": \"diagonal\",\n    \"sigma\": {\"kind\": \"proportional\", \"value\": 0.1},\n    \"max_iter\": 500,\n    \"compute_se\": true\n  },\n  \"grid\": {\"t0\": 0.0, \"t1\": 24.0},\n  \"solver\": {\"alg\": \"Tsit5\", \"reltol\": 1e-8, \"abstol\": 1e-10}\n}\n</code></pre></p>"},{"location":"estimation/#tips-and-best-practices","title":"Tips and Best Practices","text":"<ol> <li> <p>Initial Values: Start with reasonable initial values based on prior knowledge or NCA results</p> </li> <li> <p>Bounds: Set physiologically plausible bounds to prevent estimation from exploring unrealistic parameter space</p> </li> <li> <p>Convergence: Check that OFV is stable and standard errors are reasonable</p> </li> <li> <p>Residual Error: Choose the error model that matches your data (proportional for concentrations that span orders of magnitude)</p> </li> <li> <p>Omega Structure: Start with diagonal omega; add correlations only if supported by data</p> </li> <li> <p>Validation: Use VPC to validate the final model</p> </li> </ol>"},{"location":"estimation/#see-also","title":"See Also","text":"<ul> <li>Models - Available PK/PD models</li> <li>Population - Population simulation</li> <li>VPC - Visual Predictive Checks</li> <li>Data Import - Loading observed data</li> </ul>"},{"location":"import/","title":"Model Import","text":"<p>OpenPKPD can import model definitions from NONMEM control files (.ctl) and Monolix project files (.mlxtran), enabling migration of existing models to OpenPKPD.</p>"},{"location":"import/#nonmem-import","title":"NONMEM Import","text":""},{"location":"import/#supported-features","title":"Supported Features","text":"Feature Support ADVAN 1-4, 11 Full TRANS 1, 2, 4 Full $THETA Full $OMEGA (DIAGONAL) Full $OMEGA (BLOCK) Full $SIGMA Full IIV (exponential) Full Simple covariates Partial $PK user code Limited $ERROR user code Limited"},{"location":"import/#basic-usage","title":"Basic Usage","text":"<pre><code>using OpenPKPDCore\n\n# Parse NONMEM control file\nnmctl = parse_nonmem_control(\"run001.ctl\")\n\n# Convert to OpenPKPD format\nmodel_spec, pop_spec, mapping = convert_nonmem_to_openpkpd(nmctl)\n\n# Use for simulation\nresult = simulate(model_spec, grid, solver)\n</code></pre> <pre><code>from openpkpd.import_ import parse_nonmem, convert_to_openpkpd\n\n# Parse and convert\nnmctl = parse_nonmem(\"run001.ctl\")\nmodel_spec, pop_spec, mapping = convert_to_openpkpd(nmctl)\n</code></pre>"},{"location":"import/#advantrans-mapping","title":"ADVAN/TRANS Mapping","text":"ADVAN TRANS OpenPKPD Model Parameters 1 2 OneCompIVBolus CL, V 2 2 OneCompOralFirstOrder Ka, CL, V 3 4 TwoCompIVBolus CL, V1, Q, V2 4 4 TwoCompOral Ka, CL, V1, Q, V2 11 4 ThreeCompIVBolus CL, V1, Q2, V2, Q3, V3"},{"location":"import/#example-nonmem-control-file","title":"Example NONMEM Control File","text":"<pre><code>$PROBLEM One-Compartment PK Model\n\n$DATA data.csv IGNORE=@\n$INPUT ID TIME DV AMT EVID MDV WT\n\n$SUBROUTINES ADVAN2 TRANS2\n\n$PK\nTVCL = THETA(1)\nTVV  = THETA(2)\nTVKA = THETA(3)\n\nCL = TVCL * EXP(ETA(1))\nV  = TVV  * EXP(ETA(2))\nKA = TVKA * EXP(ETA(3))\n\n$ERROR\nIPRED = F\nY = F * (1 + ERR(1))\n\n$THETA\n(0, 5, 100)    ; CL\n(0, 50, 500)   ; V\n(0, 1.5, 10)   ; KA\n\n$OMEGA DIAGONAL\n0.09  ; IIV CL\n0.04  ; IIV V\n0.16  ; IIV KA\n\n$SIGMA\n0.01  ; Proportional error\n\n$EST METHOD=1 INTER MAXEVAL=9999\n</code></pre>"},{"location":"import/#parsed-structure","title":"Parsed Structure","text":"<pre><code>nmctl = parse_nonmem_control(\"run001.ctl\")\n\n# Access parsed components\nprintln(nmctl.problem)        # \"One-Compartment PK Model\"\nprintln(nmctl.advan)          # 2\nprintln(nmctl.trans)          # 2\nprintln(nmctl.theta)          # Vector of THETASpec\nprintln(nmctl.omega)          # OMEGABlock\nprintln(nmctl.sigma)          # SIGMABlock\n</code></pre>"},{"location":"import/#parameter-mapping","title":"Parameter Mapping","text":"<p>The conversion returns a mapping dictionary:</p> <pre><code>model_spec, pop_spec, mapping = convert_nonmem_to_openpkpd(nmctl)\n\n# mapping contains:\n# {\n#   :THETA1 =&gt; :CL,\n#   :THETA2 =&gt; :V,\n#   :THETA3 =&gt; :Ka,\n#   :ETA1 =&gt; :CL,\n#   :ETA2 =&gt; :V,\n#   :ETA3 =&gt; :Ka\n# }\n</code></pre>"},{"location":"import/#monolix-import","title":"Monolix Import","text":""},{"location":"import/#supported-features_1","title":"Supported Features","text":"Feature Support pk= macros Full compartmental_model Full parameter blocks Full [INDIVIDUAL] Full omega (diagonal) Full omega (block) Partial Covariates Partial Custom models Limited"},{"location":"import/#basic-usage_1","title":"Basic Usage","text":"<pre><code>using OpenPKPDCore\n\n# Parse Monolix project\nmlx = parse_monolix_project(\"project.mlxtran\")\n\n# Convert to OpenPKPD format\nmodel_spec, pop_spec, mapping = convert_monolix_to_openpkpd(mlx)\n</code></pre> <pre><code>from openpkpd.import_ import parse_monolix, convert_to_openpkpd\n\nmlx = parse_monolix(\"project.mlxtran\")\nmodel_spec, pop_spec, mapping = convert_to_openpkpd(mlx)\n</code></pre>"},{"location":"import/#example-monolix-project","title":"Example Monolix Project","text":"<pre><code>&lt;DATAFILE&gt;\n[FILEINFO]\nfile = 'data.csv'\ndelimiter = comma\nheader = {ID, TIME, DV, AMT, EVID, MDV, WT}\n\n[CONTENT]\nID = {use=identifier}\nTIME = {use=time}\nDV = {use=observation, name=Y, type=continuous}\nAMT = {use=amount}\nEVID = {use=eventidentifier}\n\n&lt;MODEL&gt;\n[LONGITUDINAL]\ninput = {Cl, V, ka}\n\npk=compartmental_model(\n  model_type = 1-cpt,\n  admin = oral,\n  distribution = one-compartment,\n  elimination = linear,\n  p_ka = ka,\n  p_Cl = Cl,\n  p_V = V\n)\n\nDEFINITION:\nY = {distribution=normal, prediction=Cc, errorModel=proportional1}\n\n&lt;PARAMETER&gt;\nCl = {value=5, method=MLE}\nV = {value=50, method=MLE}\nka = {value=1.5, method=MLE}\n\n&lt;MONOLIX&gt;\n[TASKS]\nglobalSettings={}\nestimatePopulationParameters( method = SAEM )\n\n[SETTINGS]\nGLOBAL:\nseed = 12345\n</code></pre>"},{"location":"import/#pk-macro-mapping","title":"pk= Macro Mapping","text":"Monolix Macro OpenPKPD Model <code>model_type=1-cpt, admin=iv</code> OneCompIVBolus <code>model_type=1-cpt, admin=oral</code> OneCompOralFirstOrder <code>model_type=2-cpt, admin=iv</code> TwoCompIVBolus <code>model_type=2-cpt, admin=oral</code> TwoCompOral <code>elimination=Michaelis-Menten</code> MichaelisMentenElimination"},{"location":"import/#cli-usage","title":"CLI Usage","text":""},{"location":"import/#import-nonmem-model","title":"Import NONMEM Model","text":"<pre><code>./packages/cli/bin/openpkpd import \\\n    --input run001.ctl \\\n    --format nonmem \\\n    --out model.json\n</code></pre>"},{"location":"import/#import-monolix-model","title":"Import Monolix Model","text":"<pre><code>./packages/cli/bin/openpkpd import \\\n    --input project.mlxtran \\\n    --format monolix \\\n    --out model.json\n</code></pre>"},{"location":"import/#output-format","title":"Output Format","text":"<p>The output JSON contains the converted model specification:</p> <pre><code>{\n  \"model_spec\": {\n    \"kind\": \"OneCompOralFirstOrder\",\n    \"params\": {\n      \"Ka\": 1.5,\n      \"CL\": 5.0,\n      \"V\": 50.0\n    },\n    \"doses\": []\n  },\n  \"population_spec\": {\n    \"iiv\": {\n      \"kind\": \"LogNormalIIV\",\n      \"omegas\": {\n        \"Ka\": 0.4,\n        \"CL\": 0.3,\n        \"V\": 0.2\n      }\n    },\n    \"error_spec\": {\n      \"kind\": \"proportional\",\n      \"sigma\": 0.1\n    }\n  },\n  \"mapping\": {\n    \"THETA1\": \"CL\",\n    \"THETA2\": \"V\",\n    \"THETA3\": \"Ka\"\n  },\n  \"source\": {\n    \"format\": \"nonmem\",\n    \"file\": \"run001.ctl\"\n  }\n}\n</code></pre>"},{"location":"import/#workflow-examples","title":"Workflow Examples","text":""},{"location":"import/#nonmem-to-openpkpd-estimation","title":"NONMEM to OpenPKPD Estimation","text":"<pre><code>from openpkpd.import_ import parse_nonmem\nfrom openpkpd.data import read_cdisc_csv, cdisc_to_population\nfrom openpkpd.estimation import estimate\n\n# 1. Import NONMEM model\nnmctl = parse_nonmem(\"run001.ctl\")\nmodel_spec, _, mapping = convert_to_openpkpd(nmctl)\n\n# 2. Read data\ndataset = read_cdisc_csv(\"pc.csv\", \"ex.csv\", \"dm.csv\")\npop_spec, observed = cdisc_to_population(dataset, model_spec)\n\n# 3. Re-estimate in OpenPKPD\nresult = estimate(observed, model_spec, config)\n\n# 4. Compare parameters\nprint(\"NONMEM THETA:\", nmctl.theta)\nprint(\"OpenPKPD Theta:\", result.theta)\n</code></pre>"},{"location":"import/#model-translation-validation","title":"Model Translation Validation","text":"<pre><code># Run simulation with both tools and compare\nimport numpy as np\n\n# OpenPKPD simulation\nopenpkpd_result = simulate(model_spec, grid, solver)\n\n# Compare to NONMEM output\nnonmem_pred = np.loadtxt(\"nonmem_pred.csv\")\nopenpkpd_pred = np.array(openpkpd_result[\"observations\"][\"conc\"])\n\n# Check agreement\nmax_diff = np.max(np.abs(nonmem_pred - openpkpd_pred))\nprint(f\"Max difference: {max_diff:.6f}\")\n</code></pre>"},{"location":"import/#limitations","title":"Limitations","text":""},{"location":"import/#nonmem","title":"NONMEM","text":"Feature Status Complex $PK code Manual translation needed TIME-VARYING covariates in $PK Limited support $DES (custom ODEs) Not supported PREDPP subroutines ADVAN 1-4, 11 only $MIX (mixture models) Not supported"},{"location":"import/#monolix","title":"Monolix","text":"Feature Status Custom structural models Manual translation needed Complex covariate models Limited support Occasion effects (IOV) Partial support Mixture models Not supported"},{"location":"import/#troubleshooting","title":"Troubleshooting","text":""},{"location":"import/#unsupported-advan","title":"Unsupported ADVAN","text":"<pre><code>Error: ADVAN 6 not supported\n</code></pre> <p>ADVAN 6 uses custom ODEs ($DES). You'll need to implement the model manually in OpenPKPD.</p>"},{"location":"import/#parameter-mismatch","title":"Parameter Mismatch","text":"<pre><code>Warning: Could not map THETA(4)\n</code></pre> <p>Some parameters in complex $PK blocks may not map directly. Check the mapping dictionary and manually adjust if needed.</p>"},{"location":"import/#covariate-model","title":"Covariate Model","text":"<pre><code>Warning: Covariate model not fully translated\n</code></pre> <p>Complex covariate relationships (e.g., piecewise, categorical) may need manual implementation.</p>"},{"location":"import/#see-also","title":"See Also","text":"<ul> <li>Data Import - CDISC data format</li> <li>Parameter Estimation - Re-estimating imported models</li> <li>Models - Available OpenPKPD models</li> </ul>"},{"location":"models/","title":"PK/PD Models Reference","text":"<p>OpenPKPD provides a comprehensive library of validated pharmacokinetic (PK) and pharmacodynamic (PD) models for drug concentration and effect simulation.</p>"},{"location":"models/#model-summary","title":"Model Summary","text":""},{"location":"models/#pharmacokinetic-models","title":"Pharmacokinetic Models","text":"Model Compartments Parameters Route Use Case <code>OneCompIVBolus</code> 1 CL, V IV bolus Simple IV drugs <code>OneCompOralFirstOrder</code> 2 Ka, CL, V Oral Simple oral drugs <code>TwoCompIVBolus</code> 2 CL, V1, Q, V2 IV bolus Distribution kinetics <code>TwoCompOral</code> 3 Ka, CL, V1, Q, V2 Oral Oral with distribution <code>ThreeCompIVBolus</code> 3 CL, V1, Q2, V2, Q3, V3 IV bolus Deep tissue distribution <code>TransitAbsorption</code> N+1 N, Ktr, Ka, CL, V Oral Delayed absorption <code>MichaelisMentenElimination</code> 1 Vmax, Km, V IV bolus Saturable elimination"},{"location":"models/#pharmacodynamic-models","title":"Pharmacodynamic Models","text":"Model Type Parameters Mechanism <code>DirectEmax</code> Direct E0, Emax, EC50 Hyperbolic response <code>SigmoidEmax</code> Direct E0, Emax, EC50, gamma Hill equation <code>IndirectResponseTurnover</code> Indirect Kin, Kout, R0, Imax, IC50 Inhibition of output <code>BiophaseEquilibration</code> Effect compartment ke0, E0, Emax, EC50 PK-PD hysteresis"},{"location":"models/#pharmacokinetic-models_1","title":"Pharmacokinetic Models","text":""},{"location":"models/#one-compartment-iv-bolus","title":"One-Compartment IV Bolus","text":"<p>The simplest PK model representing instantaneous drug administration into a single well-mixed compartment.</p> <p>Model Kind: <code>OneCompIVBolus</code></p> <p>Parameters: <code>OneCompIVBolusParams</code></p> Parameter Symbol Units Description Constraints <code>CL</code> CL L/h Clearance CL &gt; 0 <code>V</code> V L Volume of distribution V &gt; 0 <p>State Variables:</p> State Symbol Description <code>A_central</code> A Amount in central compartment <p>Differential Equation:</p> \\[\\frac{dA}{dt} = -\\frac{CL}{V} \\cdot A\\] <p>Observation: \\(C = \\frac{A}{V}\\)</p> <p>Half-life: \\(t_{1/2} = \\frac{0.693 \\cdot V}{CL}\\)</p> <p>Example (Julia):</p> <pre><code>using OpenPKPDCore\n\nparams = OneCompIVBolusParams(5.0, 50.0)  # CL=5 L/h, V=50 L\ndoses = [DoseEvent(0.0, 100.0)]\nspec = ModelSpec(OneCompIVBolus(), \"iv_bolus\", params, doses)\n\ngrid = SimGrid(0.0, 24.0, collect(0.0:0.5:24.0))\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\nresult = simulate(spec, grid, solver)\n</code></pre> <p>Example (Python):</p> <pre><code>import openpkpd\n\nopenpkpd.init_julia()\n\nresult = openpkpd.simulate_pk_iv_bolus(\n    cl=5.0,\n    v=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0,\n    t1=24.0,\n    saveat=[float(t) for t in range(25)]\n)\n</code></pre>"},{"location":"models/#one-compartment-oral-first-order","title":"One-Compartment Oral First-Order","text":"<p>One-compartment model with first-order absorption from a depot (gut) compartment.</p> <p>Model Kind: <code>OneCompOralFirstOrder</code></p> <p>Parameters: <code>OneCompOralFirstOrderParams</code></p> Parameter Symbol Units Description Constraints <code>Ka</code> Ka 1/h Absorption rate constant Ka &gt; 0 <code>CL</code> CL L/h Clearance CL &gt; 0 <code>V</code> V L Volume of distribution V &gt; 0 <p>State Variables:</p> State Symbol Description <code>A_gut</code> A_gut Amount in absorption depot <code>A_central</code> A_central Amount in central compartment <p>Differential Equations:</p> \\[\\frac{dA_{gut}}{dt} = -K_a \\cdot A_{gut}\\] \\[\\frac{dA_{central}}{dt} = K_a \\cdot A_{gut} - \\frac{CL}{V} \\cdot A_{central}\\] <p>Observation: \\(C = \\frac{A_{central}}{V}\\)</p> <p>Dose Target: Gut compartment</p> <p>Tmax (approximate): \\(t_{max} \\approx \\frac{\\ln(K_a) - \\ln(k_{el})}{K_a - k_{el}}\\) where \\(k_{el} = CL/V\\)</p> <p>Example (Julia):</p> <pre><code>params = OneCompOralFirstOrderParams(1.5, 5.0, 50.0)  # Ka=1.5/h, CL=5, V=50\ndoses = [DoseEvent(0.0, 200.0)]\nspec = ModelSpec(OneCompOralFirstOrder(), \"oral\", params, doses)\nresult = simulate(spec, grid, solver)\n</code></pre> <p>Example (Python):</p> <pre><code>result = openpkpd.simulate_pk_oral_first_order(\n    ka=1.5,\n    cl=5.0,\n    v=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 200.0}],\n    t0=0.0,\n    t1=24.0\n)\n</code></pre>"},{"location":"models/#two-compartment-iv-bolus","title":"Two-Compartment IV Bolus","text":"<p>Two-compartment model with central and peripheral compartments, exhibiting bi-exponential decline.</p> <p>Model Kind: <code>TwoCompIVBolus</code></p> <p>Parameters: <code>TwoCompIVBolusParams</code></p> Parameter Symbol Units Description Constraints <code>CL</code> CL L/h Clearance from central CL &gt; 0 <code>V1</code> V1 L Central volume V1 &gt; 0 <code>Q</code> Q L/h Inter-compartmental clearance Q &gt; 0 <code>V2</code> V2 L Peripheral volume V2 &gt; 0 <p>Micro-rate Constants:</p> <ul> <li>\\(k_{10} = CL/V_1\\) (elimination)</li> <li>\\(k_{12} = Q/V_1\\) (central to peripheral)</li> <li>\\(k_{21} = Q/V_2\\) (peripheral to central)</li> </ul> <p>State Variables:</p> State Symbol Description <code>A_central</code> A1 Amount in central compartment <code>A_peripheral</code> A2 Amount in peripheral compartment <p>Differential Equations:</p> \\[\\frac{dA_1}{dt} = -k_{10} \\cdot A_1 - k_{12} \\cdot A_1 + k_{21} \\cdot A_2\\] \\[\\frac{dA_2}{dt} = k_{12} \\cdot A_1 - k_{21} \\cdot A_2\\] <p>Observation: \\(C = \\frac{A_1}{V_1}\\)</p> <p>Bi-exponential Profile:</p> \\[C(t) = A \\cdot e^{-\\alpha t} + B \\cdot e^{-\\beta t}\\] <p>Where \\(\\alpha\\) (distribution) &gt; \\(\\beta\\) (elimination)</p> <p>Example (Julia):</p> <pre><code>params = TwoCompIVBolusParams(10.0, 20.0, 15.0, 50.0)\n# CL=10 L/h, V1=20 L, Q=15 L/h, V2=50 L\ndoses = [DoseEvent(0.0, 500.0)]\nspec = ModelSpec(TwoCompIVBolus(), \"twocomp_iv\", params, doses)\nresult = simulate(spec, grid, solver)\n</code></pre> <p>Example (Python):</p> <pre><code>result = openpkpd.simulate_pk_twocomp_iv_bolus(\n    cl=10.0,\n    v1=20.0,\n    q=15.0,\n    v2=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 500.0}],\n    t0=0.0,\n    t1=48.0\n)\n</code></pre>"},{"location":"models/#two-compartment-oral","title":"Two-Compartment Oral","text":"<p>Two-compartment model with first-order oral absorption.</p> <p>Model Kind: <code>TwoCompOral</code></p> <p>Parameters: <code>TwoCompOralParams</code></p> Parameter Symbol Units Description Constraints <code>Ka</code> Ka 1/h Absorption rate constant Ka &gt; 0 <code>CL</code> CL L/h Clearance from central CL &gt; 0 <code>V1</code> V1 L Central volume V1 &gt; 0 <code>Q</code> Q L/h Inter-compartmental clearance Q &gt; 0 <code>V2</code> V2 L Peripheral volume V2 &gt; 0 <p>State Variables:</p> State Symbol Description <code>A_gut</code> A_gut Amount in gut compartment <code>A_central</code> A1 Amount in central compartment <code>A_peripheral</code> A2 Amount in peripheral compartment <p>Differential Equations:</p> \\[\\frac{dA_{gut}}{dt} = -K_a \\cdot A_{gut}\\] \\[\\frac{dA_1}{dt} = K_a \\cdot A_{gut} - \\frac{CL}{V_1} \\cdot A_1 - \\frac{Q}{V_1} \\cdot A_1 + \\frac{Q}{V_2} \\cdot A_2\\] \\[\\frac{dA_2}{dt} = \\frac{Q}{V_1} \\cdot A_1 - \\frac{Q}{V_2} \\cdot A_2\\] <p>Example (Python):</p> <pre><code>result = openpkpd.simulate_pk_twocomp_oral(\n    ka=1.2,\n    cl=8.0,\n    v1=25.0,\n    q=12.0,\n    v2=60.0,\n    doses=[{\"time\": 0.0, \"amount\": 400.0}],\n    t0=0.0,\n    t1=72.0\n)\n</code></pre>"},{"location":"models/#three-compartment-iv-bolus","title":"Three-Compartment IV Bolus","text":"<p>Three-compartment mammillary model with central, shallow peripheral, and deep peripheral compartments.</p> <p>Model Kind: <code>ThreeCompIVBolus</code></p> <p>Parameters: <code>ThreeCompIVBolusParams</code></p> Parameter Symbol Units Description Constraints <code>CL</code> CL L/h Clearance from central CL &gt; 0 <code>V1</code> V1 L Central volume V1 &gt; 0 <code>Q2</code> Q2 L/h Clearance to shallow peripheral Q2 &gt; 0 <code>V2</code> V2 L Shallow peripheral volume V2 &gt; 0 <code>Q3</code> Q3 L/h Clearance to deep peripheral Q3 &gt; 0 <code>V3</code> V3 L Deep peripheral volume V3 &gt; 0 <p>State Variables:</p> State Symbol Description <code>A_central</code> A1 Central compartment <code>A_periph1</code> A2 Shallow peripheral (rapid equilibration) <code>A_periph2</code> A3 Deep peripheral (slow equilibration) <p>Micro-rate Constants:</p> <ul> <li>\\(k_{10} = CL/V_1\\)</li> <li>\\(k_{12} = Q_2/V_1\\), \\(k_{21} = Q_2/V_2\\)</li> <li>\\(k_{13} = Q_3/V_1\\), \\(k_{31} = Q_3/V_3\\)</li> </ul> <p>Tri-exponential Profile:</p> \\[C(t) = A \\cdot e^{-\\alpha t} + B \\cdot e^{-\\beta t} + C \\cdot e^{-\\gamma t}\\] <p>Where \\(\\alpha\\) &gt; \\(\\beta\\) &gt; \\(\\gamma\\)</p> <p>Use Cases: Lipophilic drugs, anesthetics, drugs with deep tissue binding</p> <p>Example (Python):</p> <pre><code>result = openpkpd.simulate_pk_threecomp_iv_bolus(\n    cl=5.0,\n    v1=10.0,\n    q2=20.0,\n    v2=30.0,\n    q3=5.0,\n    v3=100.0,\n    doses=[{\"time\": 0.0, \"amount\": 1000.0}],\n    t0=0.0,\n    t1=168.0\n)\n</code></pre>"},{"location":"models/#transit-absorption","title":"Transit Absorption","text":"<p>Models delayed and complex oral absorption using a chain of transit compartments.</p> <p>Model Kind: <code>TransitAbsorption</code></p> <p>Parameters: <code>TransitAbsorptionParams</code></p> Parameter Symbol Units Description Constraints <code>N</code> N - Number of transit compartments 1 \u2264 N \u2264 20 <code>Ktr</code> Ktr 1/h Transit rate constant Ktr &gt; 0 <code>Ka</code> Ka 1/h Absorption rate from last transit Ka &gt; 0 <code>CL</code> CL L/h Clearance CL &gt; 0 <code>V</code> V L Volume of distribution V &gt; 0 <p>State Variables: N+1 total</p> <ul> <li>Transit_1 through Transit_N</li> <li>A_central</li> </ul> <p>Differential Equations:</p> <p>$\\(\\frac{dTransit_1}{dt} = -K_{tr} \\cdot Transit_1\\)$ (receives dose)</p> <p>$\\(\\frac{dTransit_i}{dt} = K_{tr} \\cdot Transit_{i-1} - K_{tr} \\cdot Transit_i\\)$ (i &gt; 1)</p> \\[\\frac{dA_{central}}{dt} = K_a \\cdot Transit_N - \\frac{CL}{V} \\cdot A_{central}\\] <p>Mean Transit Time (MTT): \\((N + 1) / K_{tr}\\)</p> <p>Absorption Profile: Gamma-like distribution (delayed peak, allows for lag time)</p> <p>Use Cases: - Controlled-release formulations - Enteric-coated tablets - Drugs with complex GI transit - When simple lag time is insufficient</p> <p>Example (Python):</p> <pre><code>result = openpkpd.simulate_pk_transit_absorption(\n    n_transit=5,\n    ktr=0.5,\n    ka=2.0,\n    cl=10.0,\n    v=70.0,\n    doses=[{\"time\": 0.0, \"amount\": 300.0}],\n    t0=0.0,\n    t1=24.0\n)\n</code></pre>"},{"location":"models/#michaelis-menten-elimination","title":"Michaelis-Menten Elimination","text":"<p>Models saturable (capacity-limited) elimination kinetics.</p> <p>Model Kind: <code>MichaelisMentenElimination</code></p> <p>Parameters: <code>MichaelisMentenEliminationParams</code></p> Parameter Symbol Units Description Constraints <code>Vmax</code> Vmax mg/h Maximum elimination rate Vmax &gt; 0 <code>Km</code> Km mg/L Concentration at half Vmax Km &gt; 0 <code>V</code> V L Volume of distribution V &gt; 0 <p>Differential Equation:</p> \\[\\frac{dA}{dt} = -\\frac{V_{max} \\cdot A}{K_m \\cdot V + A}\\] <p>Or in terms of concentration:</p> \\[\\frac{dC}{dt} = -\\frac{V_{max} \\cdot C}{K_m + C}\\] <p>Kinetic Behavior:</p> Condition Kinetics Effective CL C &lt;&lt; Km First-order (linear) CL \u2248 Vmax/Km C &gt;&gt; Km Zero-order (saturable) Rate \u2248 Vmax C \u2248 Km Mixed-order Nonlinear <p>Characteristics: - Dose-dependent half-life (increases with dose) - Disproportionate increase in AUC with dose - Time to steady state depends on dose</p> <p>Clinical Examples: Phenytoin, ethanol, high-dose aspirin, some biologics</p> <p>Example (Python):</p> <pre><code>result = openpkpd.simulate_pk_michaelis_menten(\n    vmax=500.0,    # mg/h\n    km=10.0,       # mg/L\n    v=50.0,        # L\n    doses=[{\"time\": 0.0, \"amount\": 1000.0}],\n    t0=0.0,\n    t1=48.0\n)\n</code></pre>"},{"location":"models/#pharmacodynamic-models_1","title":"Pharmacodynamic Models","text":""},{"location":"models/#direct-emax-model","title":"Direct Emax Model","text":"<p>A direct effect model where drug effect is an instantaneous function of concentration.</p> <p>Model Kind: <code>DirectEmax</code></p> <p>Parameters: <code>DirectEmaxParams</code></p> Parameter Symbol Units Description Constraints <code>E0</code> E0 effect units Baseline effect Any real <code>Emax</code> Emax effect units Maximum effect Emax &gt; 0 <code>EC50</code> EC50 mg/L Concentration at 50% Emax EC50 &gt; 0 <p>Effect Equation:</p> \\[E(C) = E_0 + \\frac{E_{max} \\cdot C}{EC_{50} + C}\\] <p>Properties: - At C = 0: E = E0 - At C = EC50: E = E0 + Emax/2 - As C \u2192 \u221e: E \u2192 E0 + Emax</p> <p>Use Cases: Rapid equilibrium effects, receptor binding without delays</p> <p>Example (Python):</p> <pre><code>result = openpkpd.simulate_pkpd_direct_emax(\n    # PK parameters\n    cl=5.0, v=50.0,\n    # PD parameters\n    e0=0.0, emax=100.0, ec50=2.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0, t1=24.0\n)\n</code></pre>"},{"location":"models/#sigmoid-emax-hill-equation","title":"Sigmoid Emax (Hill Equation)","text":"<p>Extension of Emax model with Hill coefficient for steepness control.</p> <p>Model Kind: <code>SigmoidEmax</code></p> <p>Parameters: <code>SigmoidEmaxParams</code></p> Parameter Symbol Units Description Constraints <code>E0</code> E0 effect units Baseline effect Any real <code>Emax</code> Emax effect units Maximum effect Any (negative for inhibition) <code>EC50</code> EC50 mg/L Concentration at 50% Emax EC50 &gt; 0 <code>gamma</code> \u03b3 - Hill coefficient (steepness) \u03b3 &gt; 0 <p>Effect Equation:</p> \\[E(C) = E_0 + \\frac{E_{max} \\cdot C^{\\gamma}}{EC_{50}^{\\gamma} + C^{\\gamma}}\\] <p>Hill Coefficient Interpretation:</p> \u03b3 Value Response Shape Example \u03b3 = 1 Hyperbolic (standard Emax) Many drugs \u03b3 &lt; 1 Gradual, shallow curve Some enzymes \u03b3 &gt; 1 Steep, switch-like Neuromuscular blockers \u03b3 = 2-4 Moderate steepness Ion channels \u03b3 &gt; 4 Near all-or-none Cooperative binding <p>Example (Python):</p> <pre><code>result = openpkpd.simulate_pkpd_sigmoid_emax(\n    cl=5.0, v=50.0,\n    e0=10.0, emax=90.0, ec50=1.5, gamma=2.5,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0, t1=24.0\n)\n</code></pre>"},{"location":"models/#indirect-response-turnover-model","title":"Indirect Response Turnover Model","text":"<p>Models drug effects on turnover of endogenous substances.</p> <p>Model Kind: <code>IndirectResponseTurnover</code></p> <p>Parameters: <code>IndirectResponseTurnoverParams</code></p> Parameter Symbol Units Description Constraints <code>Kin</code> Kin units/h Zero-order input rate Kin &gt; 0 <code>Kout</code> Kout 1/h First-order output rate Kout &gt; 0 <code>R0</code> R0 units Baseline response R0 &gt; 0 <code>Imax</code> Imax - Maximum inhibition 0 \u2264 Imax \u2264 1 <code>IC50</code> IC50 mg/L Concentration at 50% Imax IC50 &gt; 0 <p>Note: At baseline, R0 = Kin/Kout</p> <p>Inhibition Function:</p> \\[I(C) = \\frac{I_{max} \\cdot C}{IC_{50} + C}\\] <p>Differential Equation (Type IV - inhibition of Kout):</p> \\[\\frac{dR}{dt} = K_{in} - K_{out} \\cdot (1 - I(C)) \\cdot R\\] <p>Indirect Response Types:</p> Type Mechanism Drug Effect I Inhibit Kin Decreases R (e.g., warfarin on clotting factors) II Inhibit Kout Increases R (e.g., corticosteroids on cortisol) III Stimulate Kin Increases R (e.g., EPO on RBCs) IV Stimulate Kout Decreases R <p>Characteristics: - Delayed response relative to concentration - Counter-clockwise hysteresis in effect-concentration plots - Time to maximum effect often occurs after Cmax</p> <p>Example (Python):</p> <pre><code>result = openpkpd.simulate_pkpd_indirect_response(\n    cl=5.0, v=50.0,\n    kin=10.0, kout=0.5, r0=20.0, imax=0.8, ic50=1.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0, t1=72.0\n)\n</code></pre>"},{"location":"models/#biophase-equilibration-effect-compartment","title":"Biophase Equilibration (Effect Compartment)","text":"<p>Models temporal delay between plasma and effect site concentrations.</p> <p>Model Kind: <code>BiophaseEquilibration</code></p> <p>Parameters: <code>BiophaseEquilibrationParams</code></p> Parameter Symbol Units Description Constraints <code>ke0</code> ke0 1/h Effect site equilibration rate ke0 &gt; 0 <code>E0</code> E0 effect units Baseline effect Any real <code>Emax</code> Emax effect units Maximum effect Emax &gt; 0 <code>EC50</code> EC50 mg/L Effect site conc at 50% Emax EC50 &gt; 0 <p>Effect Compartment ODE:</p> \\[\\frac{dC_e}{dt} = k_{e0} \\cdot (C_p - C_e)\\] <p>Where \\(C_p\\) = plasma concentration, \\(C_e\\) = effect site concentration</p> <p>Effect Equation (based on Ce):</p> \\[E(C_e) = E_0 + \\frac{E_{max} \\cdot C_e}{EC_{50} + C_e}\\] <p>Equilibration Kinetics: - Half-life of equilibration: \\(t_{1/2,ke0} = \\ln(2) / k_{e0}\\) - Time to 90% equilibration: \\(t_{90} \\approx 2.3 / k_{e0}\\)</p> <p>Use Cases: - CNS-active drugs (anesthetics, sedatives) - Drugs with hysteresis in effect-concentration plots - Neuromuscular blocking agents</p> <p>Example (Python):</p> <pre><code>result = openpkpd.simulate_pkpd_biophase_equilibration(\n    cl=5.0, v=50.0,\n    ke0=0.5,  # Equilibration half-life ~1.4 hours\n    e0=0.0, emax=100.0, ec50=2.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0, t1=24.0\n)\n</code></pre>"},{"location":"models/#dose-events","title":"Dose Events","text":"<p>Doses are specified using the <code>DoseEvent</code> struct.</p> <p>Structure:</p> <pre><code>DoseEvent(time::Float64, amount::Float64, duration::Float64=0.0)\n</code></pre> Field Description <code>time</code> Time of dose administration <code>amount</code> Dose amount (mass units) <code>duration</code> Infusion duration (0.0 = bolus, &gt;0 = infusion) <p>Python format:</p> <pre><code># IV Bolus (instantaneous)\ndoses = [\n    {\"time\": 0.0, \"amount\": 100.0},\n    {\"time\": 24.0, \"amount\": 100.0},\n]\n\n# IV Infusion (zero-order input over duration)\ndoses = [\n    {\"time\": 0.0, \"amount\": 100.0, \"duration\": 1.0},  # 100 mg over 1 hour\n    {\"time\": 24.0, \"amount\": 100.0, \"duration\": 0.5}, # 100 mg over 30 min\n]\n</code></pre>"},{"location":"models/#iv-infusion-support","title":"IV Infusion Support","text":"<p>OpenPKPD supports zero-order (constant rate) IV infusions for all IV models:</p> <p>Infusion Rate Calculation: $\\(R = \\frac{Amount}{Duration}\\)$</p> <p>Modified ODE (during infusion): $\\(\\frac{dA}{dt} = R - k \\cdot A\\)$</p> <p>Example - 1-hour infusion (Julia):</p> <pre><code>doses = [DoseEvent(0.0, 100.0, 1.0)]  # 100 mg over 1 hour\nspec = ModelSpec(OneCompIVBolus(), \"infusion\", params, doses)\nresult = simulate(spec, grid, solver)\n</code></pre> <p>Example - 1-hour infusion (Python):</p> <pre><code>result = openpkpd.simulate_pk_iv_bolus(\n    cl=5.0, v=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0, \"duration\": 1.0}],\n    t0=0.0, t1=24.0,\n    saveat=[0.0, 0.5, 1.0, 2.0, 4.0, 8.0, 12.0, 24.0]\n)\n</code></pre> <p>Overlapping Infusions:</p> <p>Multiple infusions can overlap. OpenPKPD correctly handles the combined infusion rate:</p> <pre><code>doses = [\n    {\"time\": 0.0, \"amount\": 100.0, \"duration\": 2.0},   # 50 mg/h for 2 hours\n    {\"time\": 1.0, \"amount\": 50.0, \"duration\": 1.0},    # 50 mg/h for 1 hour (overlaps)\n]\n# Combined rate from t=1 to t=2: 50 + 50 = 100 mg/h\n</code></pre> <p>Dose Handling Rules:</p> <ul> <li>Doses at <code>t0</code> are added to the initial condition (bolus only)</li> <li>Doses in <code>(t0, t1]</code> are handled via callbacks</li> <li>Multiple doses at the same time are summed</li> <li>Doses outside <code>[t0, t1]</code> are ignored</li> <li>Infusion start/stop events are handled automatically</li> </ul>"},{"location":"models/#simulation-grid","title":"Simulation Grid","text":"<p>The <code>SimGrid</code> struct defines the time domain for simulation.</p> <p>Structure:</p> <pre><code>SimGrid(t0::Float64, t1::Float64, saveat::Vector{Float64})\n</code></pre> Field Description Constraints <code>t0</code> Start time - <code>t1</code> End time t1 &gt; t0 <code>saveat</code> Output time points Sorted, within [t0, t1] <p>Examples:</p> <pre><code># Hourly output\ngrid = SimGrid(0.0, 24.0, collect(0.0:1.0:24.0))\n\n# Fine resolution\ngrid = SimGrid(0.0, 24.0, collect(0.0:0.1:24.0))\n\n# Sparse PK sampling\ngrid = SimGrid(0.0, 168.0, [0.0, 0.5, 1.0, 2.0, 4.0, 8.0, 12.0, 24.0, 48.0, 72.0, 168.0])\n</code></pre>"},{"location":"models/#solver-specification","title":"Solver Specification","text":"<p>The <code>SolverSpec</code> struct configures the ODE solver.</p> <p>Structure:</p> <pre><code>SolverSpec(alg::Symbol, reltol::Float64, abstol::Float64, maxiters::Int)\n</code></pre> Field Description Recommended Values <code>alg</code> Solver algorithm <code>:Tsit5</code> (non-stiff), <code>:Rosenbrock23</code> (stiff) <code>reltol</code> Relative tolerance 1e-6 to 1e-10 <code>abstol</code> Absolute tolerance 1e-9 to 1e-12 <code>maxiters</code> Maximum iterations 10000 to 10000000 <p>Golden Standard Settings (for reproducibility):</p> <pre><code>solver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n</code></pre>"},{"location":"models/#see-also","title":"See Also","text":"<ul> <li>Population Simulation - IIV, IOV, and covariate modeling</li> <li>NCA Reference - Non-compartmental analysis</li> <li>Trial Simulation - Clinical trial simulation</li> <li>Python Bindings - Complete Python API reference</li> </ul>"},{"location":"nca/","title":"Non-Compartmental Analysis (NCA) Reference","text":"<p>OpenPKPD provides comprehensive Non-Compartmental Analysis (NCA) functionality for pharmacokinetic analysis. The NCA module is FDA/EMA compliant and supports both single-dose and multiple-dose studies.</p>"},{"location":"nca/#overview","title":"Overview","text":"<p>Non-Compartmental Analysis is a model-independent approach for calculating pharmacokinetic parameters from concentration-time data. OpenPKPD's NCA module provides:</p> <ul> <li>Exposure Metrics: Cmax, Tmax, Cmin, Clast, Tlast, Cavg</li> <li>AUC Calculations: AUC0-t, AUC0-inf, AUC0-tau (multiple dose)</li> <li>Lambda-z Estimation: Terminal slope with R\u00b2 quality assessment</li> <li>Secondary Parameters: t\u00bd, MRT, CL/F, Vz/F, Vss</li> <li>Multiple Dose Metrics: Accumulation index, PTF, Swing</li> <li>Bioequivalence: 90% CI, TOST, GMR analysis</li> </ul>"},{"location":"nca/#python-api","title":"Python API","text":""},{"location":"nca/#quick-start","title":"Quick Start","text":"<pre><code>import openpkpd\nfrom openpkpd.nca import run_nca, NCAConfig\n\n# Initialize Julia\nopenpkpd.init_julia()\n\n# Sample concentration-time data\ntimes = [0.0, 0.5, 1.0, 2.0, 4.0, 6.0, 8.0, 12.0, 24.0]\nconc = [0.0, 0.82, 1.44, 1.62, 1.28, 0.94, 0.68, 0.36, 0.08]\ndose = 100.0\n\n# Run full NCA\nresult = run_nca(times, conc, dose)\n\nprint(f\"Cmax: {result.cmax:.2f}\")\nprint(f\"Tmax: {result.tmax:.1f} h\")\nprint(f\"AUC0-t: {result.auc_0_t:.2f} h*mg/L\")\nprint(f\"t\u00bd: {result.t_half:.2f} h\")\n</code></pre>"},{"location":"nca/#exposure-metrics","title":"Exposure Metrics","text":""},{"location":"nca/#primary-metrics","title":"Primary Metrics","text":""},{"location":"nca/#cmax-maximum-concentration","title":"Cmax - Maximum Concentration","text":"<pre><code>from openpkpd.nca import nca_cmax\n\ncmax = nca_cmax(conc)\n# Returns: 1.62 (maximum value in concentration vector)\n</code></pre>"},{"location":"nca/#tmax-time-to-maximum-concentration","title":"Tmax - Time to Maximum Concentration","text":"<pre><code>from openpkpd.nca import nca_tmax\n\ntmax = nca_tmax(times, conc)\n# Returns: 2.0 (time at which Cmax occurs)\n</code></pre>"},{"location":"nca/#cmin-minimum-concentration","title":"Cmin - Minimum Concentration","text":"<p>Used for multiple-dose studies at steady state.</p> <pre><code>from openpkpd.nca import nca_cmin\n\n# Steady-state profile\nss_conc = [2.5, 4.2, 3.8, 3.0, 2.8, 2.6, 2.5, 2.5]\ncmin = nca_cmin(ss_conc)\n# Returns: 2.5\n</code></pre>"},{"location":"nca/#clast-and-tlast-last-quantifiable-concentration","title":"Clast and Tlast - Last Quantifiable Concentration","text":"<pre><code>from openpkpd.nca import nca_clast, nca_tlast\n\nclast = nca_clast(times, conc)\ntlast = nca_tlast(times, conc)\n\n# With LLOQ\nclast = nca_clast(times, conc, lloq=0.1)  # Excludes values below 0.1\ntlast = nca_tlast(times, conc, lloq=0.1)\n</code></pre>"},{"location":"nca/#auc-calculations","title":"AUC Calculations","text":""},{"location":"nca/#auc0-t-auc-from-zero-to-last-observation","title":"AUC0-t (AUC from Zero to Last Observation)","text":"<pre><code>from openpkpd.nca import auc_0_t\n\n# Linear trapezoidal method\nauc = auc_0_t(times, conc, method=\"linear\")\n\n# Log-linear trapezoidal method\nauc = auc_0_t(times, conc, method=\"log_linear\")\n\n# Lin-log mixed (linear ascending, log-linear descending)\nauc = auc_0_t(times, conc, method=\"lin_log_mixed\")\n</code></pre> <p>Method Selection Guidelines:</p> Method When to Use FDA Guidance <code>linear</code> Simple estimation, IV bolus Acceptable <code>log_linear</code> Monoexponential decline Preferred for elimination phase <code>lin_log_mixed</code> Standard oral PK Recommended for absorption + elimination"},{"location":"nca/#auc-extrapolation-to-infinity","title":"AUC Extrapolation to Infinity","text":"<p>Automatically calculated when lambda-z can be estimated:</p> <pre><code>result = run_nca(times, conc, dose)\n\nprint(f\"AUC0-inf: {result.auc_0_inf}\")\nprint(f\"Extrapolation %: {result.auc_extra_pct}%\")\n\n# FDA requires extrapolation &lt; 20% for reliable AUC0-inf\nif result.auc_extra_pct &lt; 20:\n    print(\"Acceptable extrapolation\")\n</code></pre>"},{"location":"nca/#auc0-tau-multiple-dose","title":"AUC0-tau (Multiple Dose)","text":"<p>For steady-state studies with defined dosing interval:</p> <pre><code>ss_times = [0.0, 1.0, 2.0, 4.0, 6.0, 8.0, 10.0, 12.0]\nss_conc = [2.5, 4.2, 3.8, 3.0, 2.8, 2.6, 2.5, 2.5]\ntau = 12.0  # Dosing interval\n\nresult = run_nca(ss_times, ss_conc, dose, dosing_type=\"multiple\", tau=tau)\nprint(f\"AUC0-tau: {result.auc_0_tau}\")\nprint(f\"Cavg: {result.cavg}\")  # AUC0-tau / tau\n</code></pre>"},{"location":"nca/#terminal-phase-analysis","title":"Terminal Phase Analysis","text":""},{"location":"nca/#lambda-z-estimation","title":"Lambda-z Estimation","text":"<p>The terminal elimination rate constant is estimated by log-linear regression of the terminal phase.</p> <pre><code>from openpkpd.nca import estimate_lambda_z\n\nresult = estimate_lambda_z(times, conc)\n\nprint(f\"Lambda-z: {result['lambda_z']:.4f} /h\")\nprint(f\"t\u00bd: {result['t_half']:.2f} h\")\nprint(f\"R\u00b2: {result['r_squared']:.4f}\")\nprint(f\"Points used: {result['n_points']}\")\nprint(f\"Quality: {result['quality_flag']}\")\n</code></pre> <p>Quality Flags:</p> Flag Meaning R\u00b2 Threshold <code>good</code> Reliable estimate R\u00b2 \u2265 0.95 <code>warning</code> Use with caution 0.90 \u2264 R\u00b2 &lt; 0.95 <code>insufficient</code> Not reliable R\u00b2 &lt; 0.90 or &lt; 3 points"},{"location":"nca/#half-life","title":"Half-Life","text":"<pre><code>from openpkpd.nca import nca_half_life\nimport math\n\nlambda_z = 0.1  # /h\nt_half = nca_half_life(lambda_z)\n# t\u00bd = ln(2) / \u03bbz = 0.693 / 0.1 = 6.93 h\n</code></pre>"},{"location":"nca/#secondary-pk-parameters","title":"Secondary PK Parameters","text":""},{"location":"nca/#mean-residence-time-mrt","title":"Mean Residence Time (MRT)","text":"<pre><code>from openpkpd.nca import nca_mrt\n\n# For extravascular administration\nmrt = nca_mrt(aumc, auc)  # AUMC / AUC\n\n# For IV infusion (adjusted for infusion time)\nmrt = nca_mrt(aumc, auc, route=\"iv_infusion\", t_inf=1.0)\n</code></pre>"},{"location":"nca/#clearance-and-volume","title":"Clearance and Volume","text":"<pre><code>from openpkpd.nca import nca_cl_f, nca_vz_f\n\ndose = 100.0\nauc = 20.0\nlambda_z = 0.1\n\n# Apparent clearance: CL/F = Dose / AUC\ncl_f = nca_cl_f(dose, auc)\n# Returns: 5.0 L/h\n\n# Apparent volume: Vz/F = CL/F / \u03bbz\nvz_f = nca_vz_f(dose, lambda_z, auc)\n# Returns: 50.0 L\n</code></pre>"},{"location":"nca/#multiple-dose-metrics","title":"Multiple Dose Metrics","text":""},{"location":"nca/#accumulation-index","title":"Accumulation Index","text":"<pre><code>from openpkpd.nca import nca_accumulation_index\n\nauc_ss = 25.0   # Steady-state AUC\nauc_sd = 20.0   # Single-dose AUC\n\nrac = nca_accumulation_index(auc_ss, auc_sd)\n# Returns: 1.25 (25% accumulation)\n</code></pre>"},{"location":"nca/#peak-trough-fluctuation-ptf","title":"Peak-Trough Fluctuation (PTF)","text":"<pre><code>from openpkpd.nca import nca_ptf\n\ncmax = 4.2\ncmin = 2.5\ncavg = 3.0\n\nptf = nca_ptf(cmax, cmin, cavg)\n# Returns: 100 * (Cmax - Cmin) / Cavg = 56.7%\n</code></pre>"},{"location":"nca/#swing","title":"Swing","text":"<pre><code>from openpkpd.nca import nca_swing\n\nswing = nca_swing(cmax, cmin)\n# Returns: 100 * (Cmax - Cmin) / Cmin = 68.0%\n</code></pre>"},{"location":"nca/#bioequivalence-analysis","title":"Bioequivalence Analysis","text":"<p>OpenPKPD provides comprehensive bioequivalence analysis tools for regulatory submissions.</p>"},{"location":"nca/#geometric-mean-ratio-gmr","title":"Geometric Mean Ratio (GMR)","text":"<pre><code>from openpkpd.nca import geometric_mean_ratio, geometric_mean\n\ntest_values = [20.0, 22.0, 18.0, 25.0, 21.0, 19.0, 23.0, 20.0]\nref_values = [19.0, 21.0, 17.0, 24.0, 20.0, 18.0, 22.0, 19.0]\n\ngmr = geometric_mean_ratio(test_values, ref_values)\nprint(f\"GMR: {gmr:.4f}\")  # ~1.05\n</code></pre>"},{"location":"nca/#90-confidence-interval","title":"90% Confidence Interval","text":"<pre><code>from openpkpd.nca import bioequivalence_90ci\n\nresult = bioequivalence_90ci(test_values, ref_values)\n\nprint(f\"GMR: {result['gmr']:.4f}\")\nprint(f\"90% CI: [{result['ci_lower']:.4f}, {result['ci_upper']:.4f}]\")\nprint(f\"Intra-subject CV: {result['cv_intra']:.1f}%\")\n</code></pre>"},{"location":"nca/#tost-analysis","title":"TOST Analysis","text":"<p>Two One-Sided Tests for bioequivalence:</p> <pre><code>from openpkpd.nca import tost_analysis\n\nresult = tost_analysis(test_values, ref_values)\n\nprint(f\"Conclusion: {result['conclusion']}\")\n# Returns: \"bioequivalent\" or \"not_bioequivalent\"\n</code></pre>"},{"location":"nca/#be-conclusion-helper","title":"BE Conclusion Helper","text":"<pre><code>from openpkpd.nca import be_conclusion\n\n# Standard limits (80-125%)\nconclusion = be_conclusion(ci_lower=0.85, ci_upper=1.20)\n# Returns: \"bioequivalent\"\n\n# Highly variable drugs (EMA)\nconclusion = be_conclusion(ci_lower=0.72, ci_upper=1.35,\n                          lower_limit=0.6984, upper_limit=1.4319)\n</code></pre>"},{"location":"nca/#nca-configuration","title":"NCA Configuration","text":"<p>Customize NCA calculations with <code>NCAConfig</code>:</p> <pre><code>from openpkpd.nca import run_nca, NCAConfig\n\nconfig = NCAConfig(\n    method=\"lin_log_mixed\",       # AUC calculation method\n    lambda_z_min_points=3,        # Minimum points for \u03bbz\n    lambda_z_r2_threshold=0.90,   # R\u00b2 threshold for quality\n    extrapolation_max_pct=20.0,   # Maximum acceptable extrapolation\n    blq_handling=\"zero\",          # Handle below LLOQ: \"zero\", \"missing\", \"lloq_half\"\n)\n\nresult = run_nca(times, conc, dose, config=config)\n</code></pre>"},{"location":"nca/#full-nca-workflow","title":"Full NCA Workflow","text":""},{"location":"nca/#single-dose-study","title":"Single-Dose Study","text":"<pre><code>import openpkpd\nfrom openpkpd.nca import run_nca\n\nopenpkpd.init_julia()\n\n# PK data from oral administration\ntimes = [0, 0.25, 0.5, 1, 1.5, 2, 3, 4, 6, 8, 12, 16, 24]\nconc = [0, 0.5, 1.2, 2.1, 2.4, 2.5, 2.2, 1.9, 1.4, 1.0, 0.5, 0.25, 0.06]\ndose = 100.0  # mg\n\nresult = run_nca(times, conc, dose, route=\"oral\")\n\n# Print NCA report\nprint(\"=\" * 50)\nprint(\"NON-COMPARTMENTAL ANALYSIS REPORT\")\nprint(\"=\" * 50)\nprint(f\"\\n{'Parameter':&lt;20} {'Value':&lt;15} {'Unit':&lt;10}\")\nprint(\"-\" * 50)\nprint(f\"{'Cmax':&lt;20} {result.cmax:&lt;15.3f} {'mg/L':&lt;10}\")\nprint(f\"{'Tmax':&lt;20} {result.tmax:&lt;15.1f} {'h':&lt;10}\")\nprint(f\"{'Clast':&lt;20} {result.clast:&lt;15.3f} {'mg/L':&lt;10}\")\nprint(f\"{'Tlast':&lt;20} {result.tlast:&lt;15.1f} {'h':&lt;10}\")\nprint(f\"{'AUC0-t':&lt;20} {result.auc_0_t:&lt;15.3f} {'h*mg/L':&lt;10}\")\nif result.auc_0_inf:\n    print(f\"{'AUC0-inf':&lt;20} {result.auc_0_inf:&lt;15.3f} {'h*mg/L':&lt;10}\")\n    print(f\"{'AUC extrap %':&lt;20} {result.auc_extra_pct:&lt;15.1f} {'%':&lt;10}\")\nif result.t_half:\n    print(f\"{'t\u00bd':&lt;20} {result.t_half:&lt;15.2f} {'h':&lt;10}\")\nif result.cl_f:\n    print(f\"{'CL/F':&lt;20} {result.cl_f:&lt;15.2f} {'L/h':&lt;10}\")\nif result.vz_f:\n    print(f\"{'Vz/F':&lt;20} {result.vz_f:&lt;15.1f} {'L':&lt;10}\")\n\n# Quality assessment\nprint(f\"\\nQuality Flags: {result.quality_flags}\")\nif result.warnings:\n    print(f\"Warnings: {result.warnings}\")\n</code></pre>"},{"location":"nca/#multiple-dose-steady-state-study","title":"Multiple-Dose Steady-State Study","text":"<pre><code># Steady-state data (tau = 12 hours)\nss_times = [0, 0.5, 1, 2, 4, 6, 8, 10, 12]\nss_conc = [2.0, 3.5, 4.0, 3.6, 3.0, 2.6, 2.3, 2.1, 2.0]\ndose = 50.0  # mg\ntau = 12.0   # hours\n\nresult = run_nca(\n    ss_times, ss_conc, dose,\n    dosing_type=\"multiple\",\n    tau=tau,\n    route=\"oral\"\n)\n\nprint(f\"Cmax,ss: {result.cmax}\")\nprint(f\"Cmin,ss: {result.cmin}\")\nprint(f\"Cavg,ss: {result.cavg}\")\nprint(f\"AUC0-tau: {result.auc_0_tau}\")\nprint(f\"PTF: {result.ptf}%\")\nprint(f\"Swing: {result.swing}%\")\n</code></pre>"},{"location":"nca/#julia-api","title":"Julia API","text":""},{"location":"nca/#basic-nca","title":"Basic NCA","text":"<pre><code>using OpenPKPDCore\n\n# Run full NCA\nt = [0.0, 0.5, 1.0, 2.0, 4.0, 6.0, 8.0, 12.0, 24.0]\nc = [0.0, 0.82, 1.44, 1.62, 1.28, 0.94, 0.68, 0.36, 0.08]\ndose = 100.0\n\nresult = run_nca(t, c, dose)\n\nprintln(\"Cmax: \", result.cmax)\nprintln(\"AUC0-t: \", result.auc_0_t)\n</code></pre>"},{"location":"nca/#nca-with-configuration","title":"NCA with Configuration","text":"<pre><code>config = NCAConfig(\n    method = :lin_log_mixed,\n    lambda_z_min_points = 4,\n    lambda_z_r2_threshold = 0.90\n)\n\nresult = run_nca(t, c, dose; config = config)\n</code></pre>"},{"location":"nca/#regulatory-compliance","title":"Regulatory Compliance","text":""},{"location":"nca/#fda-guidance","title":"FDA Guidance","text":"<p>OpenPKPD's NCA module follows FDA guidance for:</p> <ul> <li>Bioequivalence Studies: Log-transformation, 90% CI calculation</li> <li>Lambda-z Estimation: Minimum 3 points in terminal phase</li> <li>AUC Extrapolation: Warning if &gt; 20% of AUC0-inf</li> <li>Method Selection: Lin-log mixed for oral absorption profiles</li> </ul>"},{"location":"nca/#ema-guidance","title":"EMA Guidance","text":"<p>Support for EMA-specific requirements:</p> <ul> <li>Highly Variable Drugs: Scaled average BE approach</li> <li>Narrow Therapeutic Index: Tightened limits (90.00-111.11%)</li> <li>Reference-Scaled Average Bioequivalence: When CVintra &gt; 30%</li> </ul>"},{"location":"nca/#quality-control","title":"Quality Control","text":""},{"location":"nca/#result-validation","title":"Result Validation","text":"<pre><code>result = run_nca(times, conc, dose)\n\n# Check quality flags\nif 'insufficient_terminal_phase' in result.quality_flags:\n    print(\"Warning: Lambda-z estimation may be unreliable\")\n\nif result.auc_extra_pct and result.auc_extra_pct &gt; 20:\n    print(\"Warning: High AUC extrapolation - interpret AUC0-inf with caution\")\n\n# Check warnings\nfor warning in result.warnings:\n    print(f\"Warning: {warning}\")\n</code></pre>"},{"location":"nca/#export-to-dictionary","title":"Export to Dictionary","text":"<pre><code>result_dict = result.to_dict()\n\n# Contains all parameters with metadata\nimport json\nprint(json.dumps(result_dict, indent=2))\n</code></pre>"},{"location":"nca/#common-issues-and-solutions","title":"Common Issues and Solutions","text":"Issue Cause Solution Lambda-z not calculated &lt; 3 points in terminal phase Extend sampling time Poor R\u00b2 for terminal phase Multi-exponential decline Use only terminal points High AUC extrapolation Sampling stopped too early Sample to 4-5 half-lives Negative lambda-z Rising concentrations Check for enterohepatic recirculation"},{"location":"nca/#see-also","title":"See Also","text":"<ul> <li>Models Reference - PK model documentation</li> <li>Visualization - NCA plots</li> <li>Trial Simulation - Using NCA in trial simulations</li> </ul>"},{"location":"population/","title":"Population Simulation","text":"<p>OpenPKPD supports population pharmacokinetic/pharmacodynamic simulations with multiple sources of variability.</p>"},{"location":"population/#overview","title":"Overview","text":"<p>Population simulations model drug behavior across multiple individuals, accounting for:</p> <ul> <li>Inter-Individual Variability (IIV): Differences between individuals</li> <li>Inter-Occasion Variability (IOV): Differences within an individual across occasions</li> <li>Covariate Effects: Patient characteristics affecting parameters</li> <li>Time-Varying Covariates: Dynamic patient characteristics</li> </ul>"},{"location":"population/#population-specification","title":"Population Specification","text":"<p>The <code>PopulationSpec</code> struct defines a population simulation.</p> <pre><code>struct PopulationSpec{MS}\n    base_model_spec::MS         # Typical value model\n    iiv::Union{Nothing, IIVSpec}           # Inter-individual variability\n    iov::Union{Nothing, IOVSpec}           # Inter-occasion variability\n    covariate_model::Union{Nothing, CovariateModel}  # Covariate model\n    covariates::Vector{IndividualCovariates}         # Per-individual covariates\nend\n</code></pre>"},{"location":"population/#inter-individual-variability-iiv","title":"Inter-Individual Variability (IIV)","text":"<p>IIV represents random differences in PK/PD parameters between individuals.</p>"},{"location":"population/#log-normal-distribution","title":"Log-Normal Distribution","text":"<p>OpenPKPD implements log-normal IIV, the standard in pharmacometrics:</p> \\[\\theta_i = \\theta_{pop} \\cdot e^{\\eta_i}\\] <p>where \\(\\eta_i \\sim N(0, \\omega^2)\\)</p>"},{"location":"population/#iiv-specification","title":"IIV Specification","text":"<pre><code>struct IIVSpec{K&lt;:RandomEffectKind}\n    kind::K                      # LogNormalIIV()\n    omegas::Dict{Symbol, Float64}  # Parameter-specific omegas\n    seed::UInt64                 # RNG seed for reproducibility\n    n::Int                       # Number of individuals\nend\n</code></pre> Field Description <code>kind</code> Distribution type (<code>LogNormalIIV()</code>) <code>omegas</code> Standard deviations for each parameter <code>seed</code> Deterministic random seed <code>n</code> Population size"},{"location":"population/#example-basic-iiv","title":"Example: Basic IIV","text":"JuliaPython <pre><code>using OpenPKPDCore\n\n# Base model (typical values)\nbase_params = OneCompIVBolusParams(5.0, 50.0)  # CL=5, V=50\nbase_spec = ModelSpec(\n    OneCompIVBolus(),\n    \"pop_iv\",\n    base_params,\n    [DoseEvent(0.0, 100.0)]\n)\n\n# IIV specification: 30% CV on CL, 20% CV on V\n# omega = sqrt(ln(1 + CV^2)) \u2248 CV for small CV\niiv = IIVSpec(\n    LogNormalIIV(),\n    Dict(:CL =&gt; 0.3, :V =&gt; 0.2),  # omegas\n    UInt64(12345),                 # seed\n    100                            # n individuals\n)\n\n# Population specification (no IOV, no covariates)\npop = PopulationSpec(base_spec, iiv, nothing, nothing, [])\n\n# Run simulation\ngrid = SimGrid(0.0, 24.0, collect(0.0:0.5:24.0))\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\nresult = simulate_population(pop, grid, solver)\n\n# Access results\nprintln(\"Number of individuals: \", length(result.individuals))\nprintln(\"First individual CL: \", result.params[1][:CL])\nprintln(\"Mean concentration at t=0: \", result.summaries[:conc].mean[1])\n</code></pre> <pre><code>import openpkpd\n\nopenpkpd.init_julia()\n\n# Run population simulation with IIV\nresult = openpkpd.simulate_population_iv_bolus(\n    cl=5.0,              # Typical CL\n    v=50.0,              # Typical V\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0,\n    t1=24.0,\n    saveat=[t * 0.5 for t in range(49)],\n    n=100,               # Number of individuals\n    seed=12345,          # RNG seed for reproducibility\n    omegas={             # IIV standard deviations (30% on CL, 20% on V)\n        \"CL\": 0.3,\n        \"V\": 0.2\n    }\n)\n\n# Access results\nprint(\"Number of individuals:\", len(result[\"individuals\"]))\nprint(\"First individual CL:\", result[\"params\"][0][\"CL\"])\nprint(\"Mean concentration at t=0:\", result[\"summaries\"][\"conc\"][\"mean\"][0])\n</code></pre>"},{"location":"population/#population-results","title":"Population Results","text":"<p>The <code>PopulationResult</code> struct contains:</p> <pre><code>struct PopulationResult\n    individuals::Vector{SimResult}              # Per-individual results\n    params::Vector{Dict{Symbol, Float64}}       # Realized parameters\n    summaries::Dict{Symbol, PopulationSummary}  # Summary statistics\n    metadata::Dict{String, Any}                 # Metadata\nend\n</code></pre>"},{"location":"population/#population-summary","title":"Population Summary","text":"<pre><code>struct PopulationSummary\n    observation::Symbol                        # Which observation\n    probs::Vector{Float64}                     # Quantile probabilities\n    mean::Vector{Float64}                      # Mean at each time\n    median::Vector{Float64}                    # Median at each time\n    quantiles::Dict{Float64, Vector{Float64}}  # Quantiles at each time\nend\n</code></pre> <p>Example - Accessing Summaries:</p> <pre><code>summary = result.summaries[:conc]\n\nprintln(\"Mean concentrations: \", summary.mean)\nprintln(\"Median concentrations: \", summary.median)\nprintln(\"5th percentile: \", summary.quantiles[0.05])\nprintln(\"95th percentile: \", summary.quantiles[0.95])\n</code></pre>"},{"location":"population/#inter-occasion-variability-iov","title":"Inter-Occasion Variability (IOV)","text":"<p>IOV represents random differences in parameters between dosing occasions within an individual.</p>"},{"location":"population/#iov-transform","title":"IOV Transform","text":"\\[\\theta_{occasion} = \\theta_{base} \\cdot e^{\\kappa}\\] <p>where \\(\\kappa \\sim N(0, \\pi^2)\\)</p>"},{"location":"population/#occasion-definition","title":"Occasion Definition","text":"<p>Occasions are automatically derived from dose times:</p> <ul> <li><code>t0</code> starts Occasion 1</li> <li>Each unique dose time after <code>t0</code> starts a new occasion</li> </ul> <pre><code>struct OccasionDefinition\n    mode::Symbol  # Currently only :dose_times\nend\n</code></pre>"},{"location":"population/#iov-specification","title":"IOV Specification","text":"<pre><code>struct IOVSpec{K&lt;:RandomEffectKind}\n    kind::K                       # LogNormalIIV()\n    pis::Dict{Symbol, Float64}    # Parameter-specific standard deviations\n    seed::UInt64                  # IOV RNG seed (separate from IIV)\n    occasion_def::OccasionDefinition\nend\n</code></pre>"},{"location":"population/#example-iiv-iov","title":"Example: IIV + IOV","text":"<pre><code>using OpenPKPDCore\n\n# Base model with multiple doses (defining occasions)\nbase_params = OneCompIVBolusParams(5.0, 50.0)\ndoses = [\n    DoseEvent(0.0, 100.0),   # Occasion 1\n    DoseEvent(24.0, 100.0),  # Occasion 2\n    DoseEvent(48.0, 100.0)   # Occasion 3\n]\nbase_spec = ModelSpec(OneCompIVBolus(), \"iov_example\", base_params, doses)\n\n# IIV: 30% on CL\niiv = IIVSpec(\n    LogNormalIIV(),\n    Dict(:CL =&gt; 0.3),\n    UInt64(12345),\n    50\n)\n\n# IOV: 15% on CL between occasions\niov = IOVSpec(\n    LogNormalIIV(),\n    Dict(:CL =&gt; 0.15),\n    UInt64(67890),  # Different seed than IIV\n    OccasionDefinition(:dose_times)\n)\n\n# Population with both IIV and IOV\npop = PopulationSpec(base_spec, iiv, iov, nothing, [])\n\ngrid = SimGrid(0.0, 72.0, collect(0.0:1.0:72.0))\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\nresult = simulate_population(pop, grid, solver)\n</code></pre>"},{"location":"population/#iov-implementation-details","title":"IOV Implementation Details","text":"<ul> <li>IOV uses segmented simulation: separate ODE solves per occasion</li> <li>State continuity is maintained at occasion boundaries</li> <li>Parameters are re-sampled at each occasion start</li> <li>IOV seed is separate from IIV seed for independent sampling</li> </ul>"},{"location":"population/#covariate-effects","title":"Covariate Effects","text":"<p>Covariates model the influence of patient characteristics on PK/PD parameters.</p>"},{"location":"population/#covariate-effect-types","title":"Covariate Effect Types","text":""},{"location":"population/#linear-covariate","title":"Linear Covariate","text":"\\[\\theta_i = \\theta_{pop} \\cdot (1 + \\beta \\cdot (cov - ref))\\] <pre><code>LinearCovariate()\n</code></pre>"},{"location":"population/#power-covariate","title":"Power Covariate","text":"\\[\\theta_i = \\theta_{pop} \\cdot \\left(\\frac{cov}{ref}\\right)^\\beta\\] <pre><code>PowerCovariate()\n</code></pre>"},{"location":"population/#exponential-covariate","title":"Exponential Covariate","text":"\\[\\theta_i = \\theta_{pop} \\cdot e^{\\beta \\cdot (cov - ref)}\\] <pre><code>ExpCovariate()\n</code></pre>"},{"location":"population/#covariate-effect-structure","title":"Covariate Effect Structure","text":"<pre><code>struct CovariateEffect{K&lt;:CovariateEffectKind}\n    kind::K           # LinearCovariate, PowerCovariate, or ExpCovariate\n    param::Symbol     # Parameter being modified\n    covariate::Symbol # Covariate variable\n    beta::Float64     # Effect coefficient\n    ref::Float64      # Reference covariate value\nend\n</code></pre>"},{"location":"population/#covariate-model","title":"Covariate Model","text":"<pre><code>struct CovariateModel\n    name::String\n    effects::Vector{CovariateEffect}  # Applied in order\nend\n</code></pre>"},{"location":"population/#individual-covariates","title":"Individual Covariates","text":"<pre><code>struct IndividualCovariates\n    values::Dict{Symbol, Float64}                    # Static covariates\n    time_varying::Union{Nothing, TimeVaryingCovariates}  # Dynamic covariates\nend\n</code></pre>"},{"location":"population/#example-weight-based-covariate","title":"Example: Weight-Based Covariate","text":"<pre><code>using OpenPKPDCore\n\n# Base model\nbase_params = OneCompIVBolusParams(5.0, 50.0)\nbase_spec = ModelSpec(\n    OneCompIVBolus(),\n    \"cov_example\",\n    base_params,\n    [DoseEvent(0.0, 100.0)]\n)\n\n# Covariate model: CL scales with weight^0.75 (allometric)\ncov_model = CovariateModel(\n    \"weight_model\",\n    [\n        CovariateEffect(PowerCovariate(), :CL, :WT, 0.75, 70.0),  # CL ~ (WT/70)^0.75\n        CovariateEffect(LinearCovariate(), :V, :WT, 0.01, 70.0)   # V ~ 1 + 0.01*(WT-70)\n    ]\n)\n\n# Individual covariates (3 patients with different weights)\ncovariates = [\n    IndividualCovariates(Dict(:WT =&gt; 50.0), nothing),\n    IndividualCovariates(Dict(:WT =&gt; 70.0), nothing),\n    IndividualCovariates(Dict(:WT =&gt; 100.0), nothing)\n]\n\n# Population without IIV (covariate effects only)\npop = PopulationSpec(base_spec, nothing, nothing, cov_model, covariates)\n\ngrid = SimGrid(0.0, 24.0, collect(0.0:0.5:24.0))\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\nresult = simulate_population(pop, grid, solver)\n\n# Each individual has different parameters based on weight\nfor (i, p) in enumerate(result.params)\n    println(\"Individual $i: CL=$(p[:CL]), V=$(p[:V])\")\nend\n</code></pre>"},{"location":"population/#example-combined-iiv-covariates","title":"Example: Combined IIV + Covariates","text":"<pre><code># IIV specification\niiv = IIVSpec(\n    LogNormalIIV(),\n    Dict(:CL =&gt; 0.3, :V =&gt; 0.2),\n    UInt64(12345),\n    100\n)\n\n# Covariate model\ncov_model = CovariateModel(\n    \"full_model\",\n    [\n        CovariateEffect(PowerCovariate(), :CL, :WT, 0.75, 70.0),\n        CovariateEffect(LinearCovariate(), :CL, :AGE, -0.01, 40.0)\n    ]\n)\n\n# Generate random covariates for 100 individuals\nusing Random\nRandom.seed!(999)\ncovariates = [\n    IndividualCovariates(\n        Dict(:WT =&gt; 50.0 + 40.0 * rand(), :AGE =&gt; 20.0 + 60.0 * rand()),\n        nothing\n    )\n    for _ in 1:100\n]\n\n# Population with IIV and covariates\npop = PopulationSpec(base_spec, iiv, nothing, cov_model, covariates)\nresult = simulate_population(pop, grid, solver)\n</code></pre>"},{"location":"population/#time-varying-covariates","title":"Time-Varying Covariates","text":"<p>Time-varying covariates represent dynamic patient characteristics that change during the simulation.</p>"},{"location":"population/#time-covariate-types","title":"Time Covariate Types","text":""},{"location":"population/#step-time-covariate","title":"Step Time Covariate","text":"<p>Value held constant until the next knot point.</p> <pre><code>StepTimeCovariate()\n</code></pre>"},{"location":"population/#linear-time-covariate","title":"Linear Time Covariate","text":"<p>Linear interpolation between knot points.</p> <pre><code>LinearTimeCovariate()\n</code></pre>"},{"location":"population/#time-covariate-series","title":"Time Covariate Series","text":"<pre><code>struct TimeCovariateSeries{K&lt;:TimeCovariateKind}\n    kind::K                    # StepTimeCovariate or LinearTimeCovariate\n    times::Vector{Float64}     # Sorted, unique time points\n    values::Vector{Float64}    # Values at each time point\nend\n</code></pre>"},{"location":"population/#time-varying-covariates-container","title":"Time-Varying Covariates Container","text":"<pre><code>struct TimeVaryingCovariates\n    series::Dict{Symbol, Any}  # Symbol =&gt; TimeCovariateSeries\nend\n</code></pre>"},{"location":"population/#example-enzyme-induction","title":"Example: Enzyme Induction","text":"<pre><code>using OpenPKPDCore\n\n# Base model\nbase_params = OneCompIVBolusParams(5.0, 50.0)\ndoses = [DoseEvent(0.0, 100.0), DoseEvent(24.0, 100.0), DoseEvent(48.0, 100.0)]\nbase_spec = ModelSpec(OneCompIVBolus(), \"enzyme_induction\", base_params, doses)\n\n# Covariate model: CL modified by enzyme activity\ncov_model = CovariateModel(\n    \"enzyme_model\",\n    [CovariateEffect(LinearCovariate(), :CL, :ENZYME, 1.0, 1.0)]\n)\n\n# Time-varying enzyme activity (increases over time due to induction)\nenzyme_series = TimeCovariateSeries(\n    LinearTimeCovariate(),\n    [0.0, 24.0, 48.0, 72.0],  # Times\n    [1.0, 1.2, 1.5, 1.8]      # Enzyme activity (increasing)\n)\n\ntvc = TimeVaryingCovariates(Dict(:ENZYME =&gt; enzyme_series))\n\n# Individual with time-varying covariate\ncovariates = [IndividualCovariates(Dict{Symbol,Float64}(), tvc)]\n\n# Population (single individual with time-varying covariate)\npop = PopulationSpec(base_spec, nothing, nothing, cov_model, covariates)\n\ngrid = SimGrid(0.0, 72.0, collect(0.0:1.0:72.0))\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\nresult = simulate_population(pop, grid, solver)\n</code></pre>"},{"location":"population/#time-varying-implementation-details","title":"Time-Varying Implementation Details","text":"<ul> <li>Simulation is segmented at covariate boundary times</li> <li>Parameters are updated at each segment start</li> <li>State continuity is maintained across segments</li> <li>Both step and linear interpolation supported</li> </ul>"},{"location":"population/#population-pkpd-simulation","title":"Population PKPD Simulation","text":"<p>Population simulations can include PD models.</p>"},{"location":"population/#example-population-pkpd-with-iiv","title":"Example: Population PKPD with IIV","text":"<pre><code>using OpenPKPDCore\n\n# Base PK model\npk_params = OneCompIVBolusParams(5.0, 50.0)\npk_spec = ModelSpec(OneCompIVBolus(), \"pop_pkpd\", pk_params, [DoseEvent(0.0, 100.0)])\n\n# PD model\npd_params = IndirectResponseTurnoverParams(10.0, 0.5, 20.0, 0.8, 1.0)\npd_spec = PDSpec(IndirectResponseTurnover(), \"indirect\", pd_params, :conc, :response)\n\n# IIV on PK parameters only\niiv = IIVSpec(\n    LogNormalIIV(),\n    Dict(:CL =&gt; 0.3, :V =&gt; 0.2),\n    UInt64(12345),\n    100\n)\n\npop = PopulationSpec(pk_spec, iiv, nothing, nothing, [])\n\ngrid = SimGrid(0.0, 72.0, collect(0.0:1.0:72.0))\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\n# Include pd_spec in population simulation\nresult = simulate_population(pop, grid, solver; pd_spec=pd_spec)\n\n# Summaries available for both PK and PD\nprintln(\"Conc summary: \", result.summaries[:conc].mean)\nprintln(\"Response summary: \", result.summaries[:response].mean)\n</code></pre>"},{"location":"population/#segmented-simulation","title":"Segmented Simulation","text":"<p>For IOV and time-varying covariates, OpenPKPD uses segmented simulation.</p>"},{"location":"population/#how-it-works","title":"How It Works","text":"<ol> <li>Identify segment boundaries (occasion starts, covariate change times)</li> <li>Run separate ODE solve for each segment</li> <li>Use end state of segment N as initial state for segment N+1</li> <li>Update parameters at segment boundaries</li> <li>Merge results into single output aligned with <code>saveat</code> grid</li> </ol>"},{"location":"population/#direct-segmented-api","title":"Direct Segmented API","text":"<pre><code># Manual segmented simulation (advanced use)\nsegment_starts = [0.0, 24.0, 48.0]\nparams_per_segment = [\n    OneCompIVBolusParams(5.0, 50.0),   # Segment 1\n    OneCompIVBolusParams(6.0, 50.0),   # Segment 2 (higher CL)\n    OneCompIVBolusParams(7.0, 50.0)    # Segment 3 (even higher CL)\n]\n\nresult = simulate_segmented_pk(\n    base_spec,\n    grid,\n    solver,\n    segment_starts,\n    params_per_segment\n)\n</code></pre>"},{"location":"population/#complete-example","title":"Complete Example","text":"<pre><code>using OpenPKPDCore\n\n# 1. Define base model\nbase_params = OneCompIVBolusParams(5.0, 50.0)\ndoses = [\n    DoseEvent(0.0, 100.0),\n    DoseEvent(24.0, 100.0),\n    DoseEvent(48.0, 100.0)\n]\nbase_spec = ModelSpec(OneCompIVBolus(), \"complete_example\", base_params, doses)\n\n# 2. Define IIV\niiv = IIVSpec(\n    LogNormalIIV(),\n    Dict(:CL =&gt; 0.3, :V =&gt; 0.2),\n    UInt64(12345),\n    100\n)\n\n# 3. Define IOV\niov = IOVSpec(\n    LogNormalIIV(),\n    Dict(:CL =&gt; 0.15),\n    UInt64(67890),\n    OccasionDefinition(:dose_times)\n)\n\n# 4. Define covariate model\ncov_model = CovariateModel(\n    \"full_cov_model\",\n    [\n        CovariateEffect(PowerCovariate(), :CL, :WT, 0.75, 70.0),\n        CovariateEffect(PowerCovariate(), :V, :WT, 1.0, 70.0)\n    ]\n)\n\n# 5. Generate individual covariates\nusing Random\nRandom.seed!(999)\ncovariates = [\n    IndividualCovariates(Dict(:WT =&gt; 50.0 + 50.0 * rand()), nothing)\n    for _ in 1:100\n]\n\n# 6. Create population spec\npop = PopulationSpec(base_spec, iiv, iov, cov_model, covariates)\n\n# 7. Run simulation\ngrid = SimGrid(0.0, 72.0, collect(0.0:1.0:72.0))\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\nresult = simulate_population(pop, grid, solver)\n\n# 8. Analyze results\nsummary = result.summaries[:conc]\nprintln(\"Population mean Cmax: \", maximum(summary.mean))\nprintln(\"Population 90% CI: \",\n    minimum(summary.quantiles[0.05]), \" - \",\n    maximum(summary.quantiles[0.95]))\n</code></pre>"},{"location":"python/","title":"Python Bindings","text":"<p>OpenPKPD provides comprehensive Python bindings through the <code>openpkpd</code> package, enabling seamless integration with Python data science workflows.</p>"},{"location":"python/#installation","title":"Installation","text":"<pre><code>cd python\npython3 -m venv .venv\nsource .venv/bin/activate\npip install -e .\n\n# With visualization support\npip install -e \".[viz]\"\n\n# With all optional dependencies\npip install -e \".[all]\"\n</code></pre> <p>Requirements:</p> <ul> <li>Python 3.10+</li> <li>Julia 1.10+ (installed and in PATH)</li> <li>juliacall package (installed automatically)</li> </ul>"},{"location":"python/#quick-start","title":"Quick Start","text":"<pre><code>import openpkpd\n\n# Initialize Julia (required once per session)\nopenpkpd.init_julia()\n\n# Check version\nprint(openpkpd.version())\n\n# Run a simple simulation\nresult = openpkpd.simulate_pk_iv_bolus(\n    cl=5.0,\n    v=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0,\n    t1=24.0,\n    saveat=[float(t) for t in range(25)]\n)\n\nprint(\"Times:\", result[\"t\"])\nprint(\"Concentrations:\", result[\"observations\"][\"conc\"])\n</code></pre>"},{"location":"python/#module-overview","title":"Module Overview","text":"Module Description <code>openpkpd</code> Core simulation functions <code>openpkpd.nca</code> Non-compartmental analysis <code>openpkpd.trial</code> Clinical trial simulation <code>openpkpd.viz</code> Visualization (matplotlib/plotly)"},{"location":"python/#core-simulation-functions","title":"Core Simulation Functions","text":""},{"location":"python/#initialization","title":"Initialization","text":""},{"location":"python/#init_juliarepo_rootnone","title":"<code>init_julia(repo_root=None)</code>","text":"<p>Initialize the Julia runtime and load OpenPKPDCore.</p> <pre><code>import openpkpd\n\n# Auto-detect repository root\nopenpkpd.init_julia()\n\n# Or specify explicitly\nopenpkpd.init_julia(\"/path/to/openpkpd\")\n</code></pre> <p>Notes:</p> <ul> <li>Safe to call multiple times (no-op after first call)</li> <li>Must be called before any simulation functions</li> <li>Automatically activates the OpenPKPDCore Julia project</li> </ul>"},{"location":"python/#version","title":"<code>version()</code>","text":"<p>Get the OpenPKPD version string.</p> <pre><code>print(openpkpd.version())  # \"0.1.0\"\n</code></pre>"},{"location":"python/#one-compartment-pk-models","title":"One-Compartment PK Models","text":""},{"location":"python/#simulate_pk_iv_bolus","title":"<code>simulate_pk_iv_bolus(...)</code>","text":"<p>One-compartment IV bolus simulation.</p> <pre><code>result = openpkpd.simulate_pk_iv_bolus(\n    cl=5.0,              # Clearance (L/h)\n    v=50.0,              # Volume of distribution (L)\n    doses=[              # List of dose events\n        {\"time\": 0.0, \"amount\": 100.0},\n        {\"time\": 12.0, \"amount\": 50.0}\n    ],\n    t0=0.0,              # Start time\n    t1=24.0,             # End time\n    saveat=[0.0, 1.0, 2.0, 4.0, 8.0, 12.0, 24.0]\n)\n</code></pre> Parameter Type Required Description <code>cl</code> float Yes Clearance (L/h) <code>v</code> float Yes Volume of distribution (L) <code>doses</code> list[dict] Yes Dose events with <code>time</code> and <code>amount</code> <code>t0</code> float Yes Start time <code>t1</code> float Yes End time <code>saveat</code> list[float] Yes Output time points"},{"location":"python/#simulate_pk_oral_first_order","title":"<code>simulate_pk_oral_first_order(...)</code>","text":"<p>One-compartment oral first-order absorption.</p> <pre><code>result = openpkpd.simulate_pk_oral_first_order(\n    ka=1.5,              # Absorption rate constant (1/h)\n    cl=5.0,              # Clearance (L/h)\n    v=50.0,              # Volume of distribution (L)\n    doses=[{\"time\": 0.0, \"amount\": 200.0}],\n    t0=0.0,\n    t1=24.0,\n    saveat=[float(t) for t in range(25)]\n)\n</code></pre>"},{"location":"python/#two-compartment-pk-models","title":"Two-Compartment PK Models","text":""},{"location":"python/#simulate_pk_twocomp_iv_bolus","title":"<code>simulate_pk_twocomp_iv_bolus(...)</code>","text":"<p>Two-compartment IV bolus simulation.</p> <pre><code>result = openpkpd.simulate_pk_twocomp_iv_bolus(\n    cl=5.0,              # Clearance (L/h)\n    v1=50.0,             # Central volume (L)\n    q=2.0,               # Inter-compartmental clearance (L/h)\n    v2=100.0,            # Peripheral volume (L)\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0,\n    t1=24.0,\n    saveat=[0.0, 0.5, 1.0, 2.0, 4.0, 8.0, 12.0, 24.0]\n)\n</code></pre> Parameter Type Required Description <code>cl</code> float Yes Clearance (L/h) <code>v1</code> float Yes Central volume (L) <code>q</code> float Yes Inter-compartmental clearance (L/h) <code>v2</code> float Yes Peripheral volume (L)"},{"location":"python/#simulate_pk_twocomp_oral","title":"<code>simulate_pk_twocomp_oral(...)</code>","text":"<p>Two-compartment oral absorption.</p> <pre><code>result = openpkpd.simulate_pk_twocomp_oral(\n    ka=1.5,              # Absorption rate constant (1/h)\n    cl=5.0,              # Clearance (L/h)\n    v1=50.0,             # Central volume (L)\n    q=2.0,               # Inter-compartmental clearance (L/h)\n    v2=100.0,            # Peripheral volume (L)\n    doses=[{\"time\": 0.0, \"amount\": 200.0}],\n    t0=0.0,\n    t1=24.0,\n    saveat=[float(t) for t in range(25)]\n)\n</code></pre>"},{"location":"python/#three-compartment-pk-model","title":"Three-Compartment PK Model","text":""},{"location":"python/#simulate_pk_threecomp_iv_bolus","title":"<code>simulate_pk_threecomp_iv_bolus(...)</code>","text":"<p>Three-compartment IV bolus simulation.</p> <pre><code>result = openpkpd.simulate_pk_threecomp_iv_bolus(\n    cl=5.0,              # Clearance (L/h)\n    v1=10.0,             # Central volume (L)\n    q2=20.0,             # Clearance to shallow peripheral (L/h)\n    v2=50.0,             # Shallow peripheral volume (L)\n    q3=2.0,              # Clearance to deep peripheral (L/h)\n    v3=200.0,            # Deep peripheral volume (L)\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0,\n    t1=72.0,\n    saveat=[0.0, 0.5, 1.0, 2.0, 4.0, 8.0, 12.0, 24.0, 48.0, 72.0]\n)\n</code></pre> Parameter Type Required Description <code>cl</code> float Yes Clearance (L/h) <code>v1</code> float Yes Central volume (L) <code>q2</code> float Yes Clearance to shallow peripheral (L/h) <code>v2</code> float Yes Shallow peripheral volume (L) <code>q3</code> float Yes Clearance to deep peripheral (L/h) <code>v3</code> float Yes Deep peripheral volume (L)"},{"location":"python/#advanced-pk-models","title":"Advanced PK Models","text":""},{"location":"python/#simulate_pk_transit_absorption","title":"<code>simulate_pk_transit_absorption(...)</code>","text":"<p>Transit compartment absorption model for complex oral absorption.</p> <pre><code>result = openpkpd.simulate_pk_transit_absorption(\n    ktr=2.0,             # Transit rate constant (1/h)\n    n_transit=3,         # Number of transit compartments\n    cl=5.0,              # Clearance (L/h)\n    v=50.0,              # Volume of distribution (L)\n    doses=[{\"time\": 0.0, \"amount\": 200.0}],\n    t0=0.0,\n    t1=24.0,\n    saveat=[float(t) for t in range(25)]\n)\n</code></pre> Parameter Type Required Description <code>ktr</code> float Yes Transit rate constant (1/h) <code>n_transit</code> int Yes Number of transit compartments <code>cl</code> float Yes Clearance (L/h) <code>v</code> float Yes Volume of distribution (L)"},{"location":"python/#simulate_pk_michaelis_menten","title":"<code>simulate_pk_michaelis_menten(...)</code>","text":"<p>Michaelis-Menten (saturable) elimination model.</p> <pre><code>result = openpkpd.simulate_pk_michaelis_menten(\n    vmax=10.0,           # Maximum elimination rate (mg/h)\n    km=2.0,              # Michaelis constant (mg/L)\n    v=50.0,              # Volume of distribution (L)\n    doses=[{\"time\": 0.0, \"amount\": 500.0}],\n    t0=0.0,\n    t1=48.0,\n    saveat=[0.0, 1.0, 2.0, 4.0, 8.0, 12.0, 24.0, 36.0, 48.0]\n)\n</code></pre> Parameter Type Required Description <code>vmax</code> float Yes Maximum elimination rate (mg/h) <code>km</code> float Yes Michaelis constant (mg/L) <code>v</code> float Yes Volume of distribution (L)"},{"location":"python/#pk-pd-models","title":"PK-PD Models","text":""},{"location":"python/#simulate_pkpd_direct_emax","title":"<code>simulate_pkpd_direct_emax(...)</code>","text":"<p>Direct Emax PD model coupled with one-compartment PK.</p> <pre><code>result = openpkpd.simulate_pkpd_direct_emax(\n    # PK parameters\n    cl=5.0, v=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    # PD parameters\n    e0=0.0,              # Baseline effect\n    emax=100.0,          # Maximum effect\n    ec50=2.0,            # Concentration at 50% effect\n    # Simulation grid\n    t0=0.0, t1=24.0,\n    saveat=[float(t) for t in range(25)]\n)\n\n# Access PD output\nprint(\"Effect:\", result[\"observations\"][\"effect\"])\n</code></pre>"},{"location":"python/#simulate_pkpd_sigmoid_emax","title":"<code>simulate_pkpd_sigmoid_emax(...)</code>","text":"<p>Sigmoid Emax (Hill equation) PD model.</p> <pre><code>result = openpkpd.simulate_pkpd_sigmoid_emax(\n    # PK parameters\n    cl=5.0, v=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    # PD parameters\n    e0=10.0,             # Baseline effect\n    emax=40.0,           # Maximum effect\n    ec50=0.8,            # EC50 (mg/L)\n    gamma=2.0,           # Hill coefficient\n    # Simulation grid\n    t0=0.0, t1=24.0,\n    saveat=[0.0, 1.0, 4.0, 8.0, 12.0, 24.0]\n)\n</code></pre> Parameter Type Required Description <code>e0</code> float Yes Baseline effect <code>emax</code> float Yes Maximum effect <code>ec50</code> float Yes Concentration at 50% effect <code>gamma</code> float Yes Hill coefficient (steepness)"},{"location":"python/#simulate_pkpd_biophase_equilibration","title":"<code>simulate_pkpd_biophase_equilibration(...)</code>","text":"<p>Effect compartment (biophase) model for delayed effects.</p> <pre><code>result = openpkpd.simulate_pkpd_biophase_equilibration(\n    # PK parameters\n    cl=5.0, v=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    # PD parameters\n    ke0=0.5,             # Equilibration rate constant (1/h)\n    e0=0.0,              # Baseline effect\n    emax=100.0,          # Maximum effect\n    ec50=1.0,            # EC50 (mg/L)\n    # Simulation grid\n    t0=0.0, t1=24.0,\n    saveat=[float(t) for t in range(25)]\n)\n\n# Access effect compartment concentration\nprint(\"Ce:\", result[\"states\"][\"A_effect\"])\n</code></pre>"},{"location":"python/#simulate_pkpd_indirect_response","title":"<code>simulate_pkpd_indirect_response(...)</code>","text":"<p>Indirect response turnover model.</p> <pre><code>result = openpkpd.simulate_pkpd_indirect_response(\n    # PK parameters\n    cl=5.0, v=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    # PD parameters\n    kin=10.0,            # Zero-order production rate\n    kout=0.5,            # First-order elimination rate\n    ic50=2.0,            # IC50 for inhibition\n    imax=0.9,            # Maximum inhibition fraction\n    baseline=None,       # Baseline (defaults to kin/kout)\n    # Simulation grid\n    t0=0.0, t1=72.0,\n    saveat=[float(t) for t in range(73)]\n)\n\n# Access response\nprint(\"Response:\", result[\"observations\"][\"response\"])\n</code></pre> Parameter Type Required Description <code>kin</code> float Yes Zero-order production rate <code>kout</code> float Yes First-order elimination rate <code>ic50</code> float Yes Concentration for 50% inhibition <code>imax</code> float Yes Maximum inhibition (0-1) <code>baseline</code> float No Baseline response (default: kin/kout)"},{"location":"python/#population-simulation","title":"Population Simulation","text":""},{"location":"python/#simulate_population_iv_bolus","title":"<code>simulate_population_iv_bolus(...)</code>","text":"<p>Population IV bolus simulation with inter-individual variability.</p> <pre><code>result = openpkpd.simulate_population_iv_bolus(\n    cl=5.0,              # Typical CL\n    v=50.0,              # Typical V\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0,\n    t1=24.0,\n    saveat=[float(t) for t in range(25)],\n    n=100,               # Number of individuals\n    seed=12345,          # RNG seed for reproducibility\n    omegas={             # IIV standard deviations\n        \"CL\": 0.3,\n        \"V\": 0.2\n    }\n)\n</code></pre> <p>Returns: <code>dict</code> with keys:</p> <ul> <li><code>individuals</code>: List of individual SimResult dicts</li> <li><code>params</code>: List of realized parameter dicts</li> <li><code>summaries</code>: Dict of PopulationSummary dicts</li> <li><code>metadata</code>: Dict of population metadata</li> </ul> <p>Example - Accessing Population Results:</p> <pre><code># Individual results\nfor i, individual in enumerate(result[\"individuals\"][:5]):\n    print(f\"Individual {i}: Cmax = {max(individual['observations']['conc']):.2f}\")\n\n# Realized parameters\nfor i, params in enumerate(result[\"params\"][:5]):\n    print(f\"Individual {i}: CL={params['CL']:.2f}, V={params['V']:.2f}\")\n\n# Population summary\nsummary = result[\"summaries\"][\"conc\"]\nprint(\"Mean concentrations:\", summary[\"mean\"])\nprint(\"5th percentile:\", summary[\"quantiles\"][\"0.05\"])\nprint(\"95th percentile:\", summary[\"quantiles\"][\"0.95\"])\n</code></pre>"},{"location":"python/#simulate_population_oral","title":"<code>simulate_population_oral(...)</code>","text":"<p>Population oral absorption simulation.</p> <pre><code>result = openpkpd.simulate_population_oral(\n    ka=1.5,              # Typical Ka\n    cl=5.0,              # Typical CL\n    v=50.0,              # Typical V\n    doses=[{\"time\": 0.0, \"amount\": 200.0}],\n    t0=0.0,\n    t1=24.0,\n    saveat=[float(t) for t in range(25)],\n    n=100,\n    seed=12345,\n    omegas={\"KA\": 0.4, \"CL\": 0.3, \"V\": 0.2}\n)\n</code></pre>"},{"location":"python/#sensitivity-analysis","title":"Sensitivity Analysis","text":""},{"location":"python/#run_sensitivity","title":"<code>run_sensitivity(...)</code>","text":"<p>Parameter sensitivity analysis for single or population simulations.</p> <pre><code># Single-subject sensitivity\nresult = openpkpd.run_sensitivity(\n    model_kind=\"OneCompIVBolus\",\n    params={\"CL\": 5.0, \"V\": 50.0},\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0,\n    t1=24.0,\n    saveat=[float(t) for t in range(25)],\n    sensitivity_param=\"CL\",\n    perturbation=0.1,  # 10% perturbation\n    observation=\"conc\"\n)\n\nprint(\"AUC ratio:\", result.metrics.auc_ratio)\nprint(\"Cmax ratio:\", result.metrics.cmax_ratio)\n</code></pre>"},{"location":"python/#pkpd-metrics","title":"PK/PD Metrics","text":"<pre><code>import openpkpd\n\nresult = openpkpd.simulate_pk_iv_bolus(...)\n\n# Exposure metrics\ncmax = openpkpd.cmax(result)\nt_max = openpkpd.tmax(result)\nauc = openpkpd.auc_trapezoid(result)\n\n# Half-life calculation\nt_half = openpkpd.half_life(cl=5.0, v=50.0)\n\n# PD metrics (for PKPD results)\ne_min = openpkpd.emin(pkpd_result)\ntime_below = openpkpd.time_below(result, threshold=0.5)\nauc_above = openpkpd.auc_above_baseline(result, baseline=0.0)\n</code></pre>"},{"location":"python/#nca-module","title":"NCA Module","text":"<p>FDA/EMA-compliant non-compartmental analysis.</p>"},{"location":"python/#basic-nca","title":"Basic NCA","text":"<pre><code>from openpkpd.nca import run_nca, NCAConfig\n\n# Run NCA on concentration-time data\nresult = run_nca(\n    times=[0, 0.5, 1, 2, 4, 8, 12, 24],\n    conc=[0, 1.8, 2.0, 1.5, 1.0, 0.5, 0.25, 0.06],\n    dose=100.0,\n    config=NCAConfig(method=\"log_linear\")\n)\n\nprint(f\"Cmax: {result.cmax:.2f}\")\nprint(f\"Tmax: {result.tmax:.2f}\")\nprint(f\"AUC0-t: {result.auc_0_t:.2f}\")\nprint(f\"AUC0-inf: {result.auc_0_inf:.2f}\")\nprint(f\"t\u00bd: {result.t_half:.2f}\")\nprint(f\"CL/F: {result.cl_f:.2f}\")\n</code></pre>"},{"location":"python/#ncaconfig-options","title":"NCAConfig Options","text":"<pre><code>from openpkpd.nca import NCAConfig\n\nconfig = NCAConfig(\n    method=\"lin_log_mixed\",          # \"linear\", \"log_linear\", \"lin_log_mixed\"\n    lambda_z_min_points=3,           # Minimum points for lambda_z\n    lambda_z_r2_threshold=0.9,       # R\u00b2 threshold for quality\n    extrapolation_max_pct=20.0,      # Max % extrapolation warning\n    blq_handling=\"zero\"              # \"zero\", \"missing\", \"lloq_half\"\n)\n</code></pre>"},{"location":"python/#individual-nca-functions","title":"Individual NCA Functions","text":"<pre><code>from openpkpd import nca\n\n# Exposure metrics\ncmax = nca.nca_cmax(times, conc)\ntmax = nca.nca_tmax(times, conc)\n\n# AUC calculations\nauc_0_t = nca.auc_0_t(times, conc, method=\"log_linear\")\nauc_0_inf, extra_pct = nca.auc_0_inf(times, conc, lambda_z)\n\n# Terminal phase\nlambda_z, t_half, r_squared = nca.estimate_lambda_z(times, conc)\n</code></pre>"},{"location":"python/#population-nca","title":"Population NCA","text":"<pre><code>from openpkpd.nca import run_population_nca, summarize_population_nca\n\n# Run NCA for population\npop_results = run_population_nca(\n    population_result,\n    dose=100.0,\n    config=NCAConfig()\n)\n\n# Summarize across population\nsummary = summarize_population_nca(pop_results)\nprint(f\"Cmax: {summary['cmax']['mean']:.2f} (CV: {summary['cmax']['cv']:.1f}%)\")\nprint(f\"AUC: {summary['auc_0_inf']['mean']:.2f} (CV: {summary['auc_0_inf']['cv']:.1f}%)\")\n</code></pre>"},{"location":"python/#bioequivalence-analysis","title":"Bioequivalence Analysis","text":"<pre><code>from openpkpd.nca import bioequivalence_90ci, tost_analysis, be_conclusion\n\n# 90% confidence interval for ratio\nlower, upper = bioequivalence_90ci(test_values, reference_values)\nprint(f\"90% CI: ({lower:.2f}, {upper:.2f})\")\n\n# TOST analysis\nresult = tost_analysis(\n    test_values,\n    reference_values,\n    theta_lower=0.80,\n    theta_upper=1.25\n)\n\n# BE conclusion\nconclusion = be_conclusion(lower, upper, theta_lower=0.80, theta_upper=1.25)\nprint(f\"Bioequivalent: {conclusion}\")\n</code></pre>"},{"location":"python/#trial-module","title":"Trial Module","text":"<p>Clinical trial simulation for pharmacometrics.</p>"},{"location":"python/#study-designs","title":"Study Designs","text":"<pre><code>from openpkpd import trial\n\n# Parallel design (2 arms: treatment vs placebo)\ndesign = trial.parallel_design(n_arms=2, randomization_ratio=[1, 1])\n\n# 2x2 crossover\ndesign = trial.crossover_2x2(washout_duration=14.0)\n\n# 3-period Williams design\ndesign = trial.williams_design(washout_duration=7.0)\n\n# 3+3 dose escalation\ndesign = trial.dose_escalation_3plus3(\n    starting_dose=10.0,\n    dose_levels=[10, 25, 50, 100, 200]\n)\n\n# Bioequivalence design\ndesign = trial.bioequivalence_design(\n    n_periods=2,\n    washout_duration=14.0,\n    reference_formulation=\"tablet\",\n    test_formulation=\"capsule\"\n)\n\n# Adaptive design with interim analyses\ndesign = trial.adaptive_design(\n    n_stages=3,\n    interim_looks=[0.33, 0.67, 1.0],\n    adaptation_rules=[\"sample_size\", \"dose_selection\"]\n)\n</code></pre>"},{"location":"python/#dosing-regimens","title":"Dosing Regimens","text":"<pre><code>from openpkpd import trial\n\n# Once daily\nregimen = trial.dosing_qd(dose=100.0, duration_days=28)\n\n# Twice daily\nregimen = trial.dosing_bid(dose=50.0, duration_days=14)\n\n# Three times daily\nregimen = trial.dosing_tid(dose=25.0, duration_days=7)\n\n# Four times daily\nregimen = trial.dosing_qid(dose=25.0, duration_days=7)\n\n# Custom schedule\nregimen = trial.dosing_custom(\n    dose=100.0,\n    times_per_day=[0.0, 8.0, 16.0],  # Specific times\n    duration_days=14\n)\n\n# Titration regimen\nregimen = trial.titration_regimen(\n    start_dose=25.0,\n    target_dose=100.0,\n    steps=[25, 50, 75, 100],\n    days_per_step=7\n)\n</code></pre>"},{"location":"python/#virtual-population-generation","title":"Virtual Population Generation","text":"<pre><code>from openpkpd import trial\n\n# Default healthy volunteer population\npop = trial.generate_virtual_population(\n    n=100,\n    spec=trial.healthy_volunteer_spec(),\n    seed=42\n)\n\n# Custom demographics\nspec = trial.DemographicSpec(\n    age_mean=55.0,\n    age_sd=12.0,\n    age_min=18.0,\n    age_max=80.0,\n    weight_mean=85.0,\n    weight_sd=18.0,\n    weight_min=50.0,\n    weight_max=150.0,\n    female_fraction=0.45,\n    race_distribution={\"white\": 0.6, \"black\": 0.2, \"asian\": 0.15, \"other\": 0.05}\n)\n\npop = trial.generate_virtual_population(n=200, spec=spec, seed=42)\n\n# Summarize population\nsummary = trial.summarize_population(pop)\nprint(f\"Age: {summary['age']['mean']:.1f} ({summary['age']['min']}-{summary['age']['max']})\")\n</code></pre>"},{"location":"python/#trial-simulation","title":"Trial Simulation","text":"<pre><code>from openpkpd import trial\n\n# Define trial specification\nspec = trial.TrialSpec(\n    name=\"Phase 2 Dose Finding\",\n    design=trial.parallel_design(3),\n    arms=[\n        trial.TreatmentArm(\"Placebo\", regimen=trial.dosing_qd(0.0, 28)),\n        trial.TreatmentArm(\"Low Dose\", regimen=trial.dosing_qd(50.0, 28)),\n        trial.TreatmentArm(\"High Dose\", regimen=trial.dosing_qd(100.0, 28)),\n    ],\n    population=trial.generate_virtual_population(150, seed=42),\n    dropout=trial.DropoutSpec(rate=0.05, pattern=\"exponential\"),\n    compliance=trial.ComplianceSpec(mean=0.90, sd=0.10)\n)\n\n# Run trial simulation\nresult = trial.simulate_trial(spec, seed=12345)\n\n# Access results\nfor arm_name, arm_result in result.arms.items():\n    print(f\"{arm_name}: n={arm_result.n_completed}\")\n</code></pre>"},{"location":"python/#power-analysis","title":"Power Analysis","text":"<pre><code>from openpkpd import trial\n\n# Analytical power calculation\npower = trial.estimate_power_analytical(\n    n_per_arm=50,\n    effect_size=0.5,      # Cohen's d\n    sd=1.0,\n    alpha=0.05\n)\nprint(f\"Power: {power.power:.1%}\")\n\n# Sample size estimation\nresult = trial.estimate_sample_size(\n    target_power=0.80,\n    effect_size=0.5,\n    sd=1.0,\n    alpha=0.05\n)\nprint(f\"Required n per arm: {result.n_per_arm}\")\n\n# Alpha spending for interim analyses\nalpha = trial.alpha_spending_function(\n    information_fraction=0.5,\n    total_alpha=0.05,\n    method=\"obrien_fleming\"\n)\n</code></pre>"},{"location":"python/#arm-comparison","title":"Arm Comparison","text":"<pre><code>from openpkpd import trial\n\n# Compare treatment arms\ncomparison = trial.compare_arms(\n    treatment_values=[1.2, 1.5, 1.1, 1.8, 1.4],\n    control_values=[0.9, 1.0, 0.8, 1.1, 0.95],\n    test=\"ttest\"\n)\n\nprint(f\"Treatment effect: {comparison.difference:.2f}\")\nprint(f\"95% CI: ({comparison.ci_lower:.2f}, {comparison.ci_upper:.2f})\")\nprint(f\"p-value: {comparison.p_value:.4f}\")\n\n# Responder analysis\nresult = trial.responder_analysis(\n    values=[1.2, 0.8, 1.5, 0.6, 1.1, 2.0],\n    threshold=1.0\n)\nprint(f\"Responder rate: {result.rate:.1%}\")\n</code></pre>"},{"location":"python/#visualization-module","title":"Visualization Module","text":"<p>Professional visualization with matplotlib and plotly backends.</p>"},{"location":"python/#backend-selection","title":"Backend Selection","text":"<pre><code>from openpkpd import viz\n\n# Set backend\nviz.set_backend(\"matplotlib\")  # or \"plotly\"\n\n# Check available backends\nprint(viz.available_backends())\n\n# Get current backend\nprint(viz.get_backend())\n</code></pre>"},{"location":"python/#pk-plots","title":"PK Plots","text":"<pre><code>from openpkpd import viz\nimport openpkpd\n\nresult = openpkpd.simulate_pk_iv_bolus(...)\n\n# Concentration-time plot\nfig = viz.plot_conc_time(result, log_scale=False)\nfig.show()\n\n# Multiple simulations\nresults = [sim1, sim2, sim3]\nfig = viz.plot_multi_conc_time(results, labels=[\"Low\", \"Medium\", \"High\"])\n\n# Population spaghetti plot\npop_result = openpkpd.simulate_population_iv_bolus(...)\nfig = viz.plot_spaghetti(pop_result, n_subjects=50, alpha=0.3)\n\n# Mean with confidence ribbon\nfig = viz.plot_mean_ribbon(pop_result, ci_levels=[0.05, 0.95], show_median=True)\n\n# Individual fits (grid of subjects)\nfig = viz.plot_individual_fits(pop_result, n_cols=4)\n</code></pre>"},{"location":"python/#nca-plots","title":"NCA Plots","text":"<pre><code>from openpkpd import viz\nfrom openpkpd.nca import run_nca\n\nnca_result = run_nca(times, conc, dose=100.0)\n\n# Lambda-z fit visualization\nfig = viz.plot_lambda_z_fit(nca_result, times, conc, show_excluded=True)\n\n# AUC visualization\nfig = viz.plot_auc_visualization(times, conc, nca_result, show_extrapolation=True)\n\n# Dose proportionality\nresults = [nca_25mg, nca_50mg, nca_100mg]\ndoses = [25, 50, 100]\nfig = viz.plot_dose_proportionality(results, doses, metric=\"auc\")\n</code></pre>"},{"location":"python/#pkpd-plots","title":"PKPD Plots","text":"<pre><code>from openpkpd import viz\n\npkpd_result = openpkpd.simulate_pkpd_direct_emax(...)\n\n# Effect-concentration plot\nfig = viz.plot_effect_conc(pkpd_result, color_by_time=True)\n\n# Hysteresis plot (counterclockwise loop)\nfig = viz.plot_hysteresis(pkpd_result, arrow_frequency=5)\n\n# Dose-response curve\ndose_results = [result_10mg, result_25mg, result_50mg, result_100mg]\ndoses = [10, 25, 50, 100]\nfig = viz.plot_dose_response(dose_results, doses, fit_model=\"emax\")\n</code></pre>"},{"location":"python/#population-plots","title":"Population Plots","text":"<pre><code>from openpkpd import viz\n\n# Visual Predictive Check (VPC)\nfig = viz.plot_vpc(\n    pop_result,\n    observed_data=observed_df,\n    prediction_intervals=[0.05, 0.50, 0.95]\n)\n\n# Parameter distributions\nfig = viz.plot_parameter_distributions(\n    pop_result,\n    parameters=[\"CL\", \"V\"],\n    plot_type=\"histogram\"  # or \"kde\", \"boxplot\"\n)\n\n# Forest plot for subgroup analysis\neffects = [\n    {\"label\": \"Overall\", \"estimate\": 0.5, \"ci_lower\": 0.2, \"ci_upper\": 0.8},\n    {\"label\": \"Age &lt; 65\", \"estimate\": 0.6, \"ci_lower\": 0.25, \"ci_upper\": 0.95},\n    {\"label\": \"Age &gt;= 65\", \"estimate\": 0.4, \"ci_lower\": 0.1, \"ci_upper\": 0.7},\n]\nfig = viz.plot_forest(effects, reference_line=0.0)\n\n# Boxplot comparison\nfig = viz.plot_boxplot(pop_result, groups=[\"Treatment\", \"Control\"], metric=\"cmax\")\n</code></pre>"},{"location":"python/#trial-plots","title":"Trial Plots","text":"<pre><code>from openpkpd import viz\nfrom openpkpd import trial\n\n# Power curve\npower_results = [\n    {\"n\": 20, \"power\": 0.45},\n    {\"n\": 40, \"power\": 0.70},\n    {\"n\": 60, \"power\": 0.85},\n    {\"n\": 80, \"power\": 0.92},\n]\nfig = viz.plot_power_curve(power_results, target_power=0.80)\n\n# Tornado plot (sensitivity)\nsensitivity = [\n    {\"parameter\": \"CL\", \"low\": -0.3, \"high\": 0.25},\n    {\"parameter\": \"V\", \"low\": -0.15, \"high\": 0.18},\n    {\"parameter\": \"Ka\", \"low\": -0.4, \"high\": 0.35},\n]\nfig = viz.plot_tornado(sensitivity, baseline_value=0.0)\n\n# Kaplan-Meier survival\nfig = viz.plot_kaplan_meier(\n    time_to_event=[10, 15, 20, 25, 30],\n    event_occurred=[1, 1, 0, 1, 0],\n    groups=[\"Treatment\", \"Treatment\", \"Control\", \"Control\", \"Treatment\"]\n)\n\n# Endpoint distribution by arm\nfig = viz.plot_endpoint_distribution(trial_result, endpoint=\"response\", by_arm=True)\n</code></pre>"},{"location":"python/#themes","title":"Themes","text":"<pre><code>from openpkpd import viz\n\n# Set theme\nviz.set_theme(\"publication\")  # or \"presentation\", \"default\"\n\n# Available themes\nprint(viz.available_themes())\n\n# Access color palette\ncolors = viz.OPENPKPD_COLORS\nprint(colors[\"primary\"])\n</code></pre>"},{"location":"python/#artifact-operations","title":"Artifact Operations","text":""},{"location":"python/#writing-artifacts","title":"Writing Artifacts","text":"<pre><code>openpkpd.write_single_artifact(\n    \"simulation.json\",\n    model={\n        \"kind\": \"TwoCompIVBolus\",\n        \"params\": {\"CL\": 5.0, \"V1\": 50.0, \"Q\": 2.0, \"V2\": 100.0},\n        \"doses\": [{\"time\": 0.0, \"amount\": 100.0}]\n    },\n    grid={\"t0\": 0.0, \"t1\": 24.0, \"saveat\": list(range(25))},\n    solver={\"alg\": \"Tsit5\", \"reltol\": 1e-10, \"abstol\": 1e-12}\n)\n</code></pre> <p>Supported Model Kinds:</p> <ul> <li><code>\"OneCompIVBolus\"</code>, <code>\"OneCompOralFirstOrder\"</code></li> <li><code>\"TwoCompIVBolus\"</code>, <code>\"TwoCompOral\"</code></li> <li><code>\"ThreeCompIVBolus\"</code></li> <li><code>\"TransitAbsorption\"</code>, <code>\"MichaelisMentenElimination\"</code></li> </ul>"},{"location":"python/#replaying-artifacts","title":"Replaying Artifacts","text":"<pre><code># Replay any artifact type\nresult = openpkpd.replay_artifact(\"validation/golden/pk_iv_bolus.json\")\nprint(\"Concentrations:\", result[\"observations\"][\"conc\"])\n\n# Population artifact\nresult = openpkpd.replay_artifact(\"validation/golden/population_iv_bolus.json\")\nprint(\"Number of individuals:\", len(result[\"individuals\"]))\n\n# Sensitivity artifact\nresult = openpkpd.replay_artifact(\"validation/golden/sensitivity_single.json\")\nprint(\"Metrics:\", result[\"metrics\"])\n</code></pre>"},{"location":"python/#integration-examples","title":"Integration Examples","text":""},{"location":"python/#with-numpy","title":"With NumPy","text":"<pre><code>import numpy as np\nimport openpkpd\n\nopenpkpd.init_julia()\n\nresult = openpkpd.simulate_pk_iv_bolus(\n    cl=5.0, v=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0, t1=24.0,\n    saveat=list(np.linspace(0, 24, 49))\n)\n\nt = np.array(result[\"t\"])\nconc = np.array(result[\"observations\"][\"conc\"])\n\nprint(f\"Cmax: {np.max(conc):.2f}\")\nprint(f\"AUC: {np.trapz(conc, t):.2f}\")\n</code></pre>"},{"location":"python/#with-pandas","title":"With Pandas","text":"<pre><code>import pandas as pd\nimport openpkpd\n\nopenpkpd.init_julia()\n\nresult = openpkpd.simulate_population_iv_bolus(\n    cl=5.0, v=50.0,\n    doses=[{\"time\": 0.0, \"amount\": 100.0}],\n    t0=0.0, t1=24.0,\n    saveat=[float(t) for t in range(25)],\n    n=100, seed=12345,\n    omegas={\"CL\": 0.3, \"V\": 0.2}\n)\n\n# Create parameter DataFrame\nparams_df = pd.DataFrame(result[\"params\"])\nprint(params_df.describe())\n\n# Create concentration DataFrame\ndata = []\nfor i, ind in enumerate(result[\"individuals\"]):\n    for t, c in zip(ind[\"t\"], ind[\"observations\"][\"conc\"]):\n        data.append({\"id\": i, \"time\": t, \"conc\": c})\n\nconc_df = pd.DataFrame(data)\nprint(conc_df.groupby(\"time\")[\"conc\"].describe())\n</code></pre>"},{"location":"python/#error-handling","title":"Error Handling","text":"<pre><code>import openpkpd\n\ntry:\n    openpkpd.init_julia()\n    result = openpkpd.simulate_pk_iv_bolus(\n        cl=-5.0,  # Invalid: negative clearance\n        v=50.0,\n        doses=[{\"time\": 0.0, \"amount\": 100.0}],\n        t0=0.0, t1=24.0,\n        saveat=[0.0, 1.0]\n    )\nexcept Exception as e:\n    print(f\"Simulation error: {e}\")\n</code></pre>"},{"location":"python/#performance-tips","title":"Performance Tips","text":"<ol> <li>Initialize Once: Call <code>init_julia()</code> once at the start, not per simulation</li> <li>Batch Simulations: Julia JIT compilation makes subsequent calls faster</li> <li>Use Appropriate Tolerances: Higher tolerance = faster, less accurate</li> <li>Sparse Output: Use fewer <code>saveat</code> points for large populations</li> </ol> <pre><code># Good: Initialize once\nimport openpkpd\nopenpkpd.init_julia()\n\nfor params in parameter_sets:\n    result = openpkpd.simulate_pk_iv_bolus(...)\n</code></pre>"},{"location":"python/#complete-api-reference","title":"Complete API Reference","text":""},{"location":"python/#core-functions","title":"Core Functions","text":"Function Description <code>init_julia()</code> Initialize Julia runtime <code>version()</code> Get OpenPKPD version"},{"location":"python/#simulation-functions","title":"Simulation Functions","text":"Function Model Type <code>simulate_pk_iv_bolus</code> One-compartment IV bolus <code>simulate_pk_oral_first_order</code> One-compartment oral <code>simulate_pk_twocomp_iv_bolus</code> Two-compartment IV bolus <code>simulate_pk_twocomp_oral</code> Two-compartment oral <code>simulate_pk_threecomp_iv_bolus</code> Three-compartment IV bolus <code>simulate_pk_transit_absorption</code> Transit compartment <code>simulate_pk_michaelis_menten</code> Michaelis-Menten elimination <code>simulate_pkpd_direct_emax</code> Direct Emax PD <code>simulate_pkpd_sigmoid_emax</code> Sigmoid Emax (Hill) PD <code>simulate_pkpd_biophase_equilibration</code> Effect compartment PD <code>simulate_pkpd_indirect_response</code> Indirect response PD <code>simulate_population_iv_bolus</code> Population IV bolus <code>simulate_population_oral</code> Population oral <code>run_sensitivity</code> Sensitivity analysis"},{"location":"python/#nca-functions","title":"NCA Functions","text":"Function Description <code>run_nca</code> Full NCA analysis <code>run_population_nca</code> Population NCA <code>summarize_population_nca</code> NCA summary statistics <code>nca_cmax</code>, <code>nca_tmax</code> Peak metrics <code>auc_0_t</code>, <code>auc_0_inf</code> AUC calculations <code>estimate_lambda_z</code> Terminal slope <code>bioequivalence_90ci</code> BE confidence interval <code>tost_analysis</code> Two one-sided t-tests"},{"location":"python/#trial-functions","title":"Trial Functions","text":"Function Description <code>parallel_design</code>, <code>crossover_2x2</code> Study designs <code>dosing_qd</code>, <code>dosing_bid</code> Dosing regimens <code>generate_virtual_population</code> Virtual subjects <code>simulate_trial</code> Trial simulation <code>estimate_power_analytical</code> Power calculation <code>estimate_sample_size</code> Sample size"},{"location":"python/#visualization-functions","title":"Visualization Functions","text":"Function Category <code>plot_conc_time</code>, <code>plot_spaghetti</code> PK plots <code>plot_lambda_z_fit</code>, <code>plot_auc_visualization</code> NCA plots <code>plot_effect_conc</code>, <code>plot_hysteresis</code> PKPD plots <code>plot_vpc</code>, <code>plot_forest</code> Population plots <code>plot_power_curve</code>, <code>plot_tornado</code> Trial plots"},{"location":"reproducibility/","title":"Reproducibility","text":"<p>OpenPKPD is designed for complete reproducibility of simulation results across time, platforms, and versions.</p>"},{"location":"reproducibility/#core-principles","title":"Core Principles","text":"<ol> <li>Deterministic Execution: Same inputs always produce identical outputs</li> <li>Complete Artifacts: All information needed to reproduce results is stored</li> <li>Semantic Versioning: Changes to numerical behavior are tracked and versioned</li> <li>Replay Validation: Artifacts can be replayed to verify reproducibility</li> </ol>"},{"location":"reproducibility/#execution-artifacts","title":"Execution Artifacts","text":"<p>Every simulation can be serialized to a JSON artifact containing everything needed for reproduction.</p>"},{"location":"reproducibility/#what-artifacts-contain","title":"What Artifacts Contain","text":"Component Description Model Specification Kind, parameters, doses Simulation Grid t0, t1, saveat times Solver Settings Algorithm, tolerances, max iterations Results Time series, states, observations Semantics Fingerprint Version information Metadata Engine version, settings snapshot"},{"location":"reproducibility/#creating-artifacts","title":"Creating Artifacts","text":"<p>Julia:</p> <pre><code>using OpenPKPDCore\n\nspec = ModelSpec(...)\ngrid = SimGrid(...)\nsolver = SolverSpec(...)\nresult = simulate(spec, grid, solver)\n\nwrite_execution_json(\n    \"my_simulation.json\";\n    model_spec=spec,\n    grid=grid,\n    solver=solver,\n    result=result\n)\n</code></pre> <p>Python:</p> <pre><code>import openpkpd\n\nopenpkpd.write_single_artifact(\n    \"my_simulation.json\",\n    model={...},\n    grid={...},\n    solver={...}\n)\n</code></pre>"},{"location":"reproducibility/#artifact-types","title":"Artifact Types","text":"Type Function Contents Single <code>write_execution_json</code> Single simulation Population <code>write_population_json</code> Population simulation Sensitivity (Single) <code>write_sensitivity_json</code> Single sensitivity analysis Sensitivity (Population) <code>write_population_sensitivity_json</code> Population sensitivity"},{"location":"reproducibility/#replay-system","title":"Replay System","text":"<p>Artifacts can be replayed to reproduce simulations.</p>"},{"location":"reproducibility/#replay-functions","title":"Replay Functions","text":"<pre><code># Read artifact\nartifact = read_execution_json(\"simulation.json\")\n\n# Replay single execution\nresult = replay_execution(artifact)\n\n# Replay population\nresult = replay_population_execution(artifact)\n\n# Replay sensitivity\nresult = replay_sensitivity_execution(artifact)\n\n# Replay population sensitivity\nresult = replay_population_sensitivity_execution(artifact)\n</code></pre>"},{"location":"reproducibility/#python-replay","title":"Python Replay","text":"<pre><code>import openpkpd\n\nresult = openpkpd.replay_artifact(\"simulation.json\")\n</code></pre>"},{"location":"reproducibility/#cli-replay","title":"CLI Replay","text":"<pre><code>./bin/openpkpd replay --artifact simulation.json\n./bin/openpkpd replay --artifact simulation.json --out replayed.json\n</code></pre>"},{"location":"reproducibility/#golden-artifacts","title":"Golden Artifacts","text":"<p>Golden artifacts are the regression contract for OpenPKPD.</p>"},{"location":"reproducibility/#location","title":"Location","text":"<pre><code>validation/golden/\n\u251c\u2500\u2500 pk_iv_bolus.json\n\u251c\u2500\u2500 pk_oral_first_order.json\n\u251c\u2500\u2500 pkpd_direct_emax.json\n\u251c\u2500\u2500 pkpd_indirect_coupled.json\n\u251c\u2500\u2500 population_iv_bolus.json\n\u251c\u2500\u2500 population_iov.json\n\u251c\u2500\u2500 population_covariates.json\n\u251c\u2500\u2500 population_time_varying.json\n\u251c\u2500\u2500 sensitivity_single.json\n\u2514\u2500\u2500 sensitivity_population.json\n</code></pre>"},{"location":"reproducibility/#purpose","title":"Purpose","text":"<ul> <li>Regression Testing: Verify numerical behavior hasn't changed</li> <li>Contract Documentation: Define expected outputs for given inputs</li> <li>Cross-Version Validation: Ensure compatibility across releases</li> </ul>"},{"location":"reproducibility/#generating-golden-artifacts","title":"Generating Golden Artifacts","text":"<pre><code># Run generation script\njulia validation/scripts/generate_golden_artifacts.jl\n</code></pre>"},{"location":"reproducibility/#validating-golden-artifacts","title":"Validating Golden Artifacts","text":"<pre><code># CLI validation\n./bin/openpkpd validate-golden\n\n# Script validation\njulia validation/scripts/run_golden_validation.jl\n</code></pre>"},{"location":"reproducibility/#validation-process","title":"Validation Process","text":""},{"location":"reproducibility/#what-validation-checks","title":"What Validation Checks","text":"<ol> <li>Artifact Readability: JSON parses correctly</li> <li>Schema Compliance: Required fields present</li> <li>Replay Success: Simulation runs without error</li> <li>Result Match: Replayed results match stored results</li> </ol>"},{"location":"reproducibility/#comparison-criteria","title":"Comparison Criteria","text":"<p>Results are compared with exact floating-point equality:</p> <pre><code>@test replayed.t == stored.t\n@test replayed.observations[:conc] == stored.observations[:conc]\n</code></pre>"},{"location":"reproducibility/#handling-failures","title":"Handling Failures","text":"<p>When validation fails:</p> <ol> <li>Bug: Fix the code, validation should pass</li> <li>Intentional Change:</li> <li>Bump semantic version</li> <li>Re-generate golden artifacts</li> <li>Document change</li> </ol>"},{"location":"reproducibility/#determinism-guarantees","title":"Determinism Guarantees","text":""},{"location":"reproducibility/#random-number-generation","title":"Random Number Generation","text":"<p>IIV and IOV use deterministic seeding:</p> <pre><code>iiv = IIVSpec(\n    LogNormalIIV(),\n    Dict(:CL =&gt; 0.3),\n    UInt64(12345),  # Deterministic seed\n    100\n)\n</code></pre> <p>Guarantees:</p> <ul> <li>Same seed \u2192 same random sequence</li> <li>Independent of simulation order</li> <li>Reproducible across platforms</li> </ul>"},{"location":"reproducibility/#output-grid","title":"Output Grid","text":"<p>Results are aligned exactly to <code>saveat</code> times:</p> <pre><code>grid = SimGrid(0.0, 24.0, [0.0, 1.0, 2.0])\nresult = simulate(spec, grid, solver)\n\n# result.t is exactly [0.0, 1.0, 2.0]\n</code></pre>"},{"location":"reproducibility/#floating-point-precision","title":"Floating-Point Precision","text":"<ul> <li>IEEE 754 double precision throughout</li> <li>No intermediate rounding</li> <li>Full precision in artifacts</li> </ul>"},{"location":"reproducibility/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"reproducibility/#github-actions-example","title":"GitHub Actions Example","text":"<pre><code>name: Golden Validation\non: [push, pull_request]\n\njobs:\n  validate:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - uses: julia-actions/setup-julia@v1\n        with:\n          version: '1.9'\n\n      - name: Install dependencies\n        run: |\n          julia --project=core/OpenPKPDCore -e 'using Pkg; Pkg.instantiate()'\n\n      - name: Run tests\n        run: |\n          julia --project=core/OpenPKPDCore -e 'using Pkg; Pkg.test()'\n\n      - name: Validate golden artifacts\n        run: |\n          ./bin/openpkpd validate-golden\n</code></pre>"},{"location":"reproducibility/#pre-commit-hook","title":"Pre-Commit Hook","text":"<pre><code>#!/bin/bash\n# .git/hooks/pre-commit\n\n# Validate golden artifacts before commit\n./bin/openpkpd validate-golden\nif [ $? -ne 0 ]; then\n    echo \"Golden validation failed. Commit aborted.\"\n    exit 1\nfi\n</code></pre>"},{"location":"reproducibility/#troubleshooting","title":"Troubleshooting","text":""},{"location":"reproducibility/#results-dont-match-stored-values","title":"\"Results don't match stored values\"","text":"<p>Causes:</p> <ol> <li>Code change affected numerical output</li> <li>Tolerance settings changed</li> <li>Random seed handling changed</li> </ol> <p>Solutions:</p> <ul> <li>Review recent changes</li> <li>Check semantic versions</li> <li>Re-generate golden artifacts if intentional</li> </ul>"},{"location":"reproducibility/#artifact-cant-be-read","title":"\"Artifact can't be read\"","text":"<p>Causes:</p> <ol> <li>Corrupted JSON</li> <li>Schema version mismatch</li> <li>Missing required fields</li> </ol> <p>Solutions:</p> <ul> <li>Validate JSON syntax</li> <li>Check artifact schema version</li> <li>Regenerate artifact</li> </ul>"},{"location":"reproducibility/#replay-produces-different-results","title":"\"Replay produces different results\"","text":"<p>Causes:</p> <ol> <li>Semantic version mismatch</li> <li>Solver configuration differences</li> <li>Platform-specific floating-point behavior</li> </ol> <p>Solutions:</p> <ul> <li>Use same OpenPKPD version</li> <li>Match solver settings exactly</li> <li>Report platform-specific issues</li> </ul>"},{"location":"reproducibility/#best-practices","title":"Best Practices","text":""},{"location":"reproducibility/#1-always-save-artifacts","title":"1. Always Save Artifacts","text":"<pre><code># Save every important simulation\nwrite_execution_json(\"research/exp_001.json\"; ...)\n</code></pre>"},{"location":"reproducibility/#2-use-explicit-seeds","title":"2. Use Explicit Seeds","text":"<pre><code># Never rely on implicit randomness\niiv = IIVSpec(..., UInt64(42), n)  # Explicit seed\n</code></pre>"},{"location":"reproducibility/#3-use-high-precision","title":"3. Use High Precision","text":"<pre><code># Golden-standard tolerances\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n</code></pre>"},{"location":"reproducibility/#4-version-control-artifacts","title":"4. Version Control Artifacts","text":"<pre><code># Track golden artifacts in git\ngit add validation/golden/*.json\ngit commit -m \"Update golden artifacts for v1.1.0\"\n</code></pre>"},{"location":"reproducibility/#5-document-changes","title":"5. Document Changes","text":"<p>When numerical behavior changes:</p> <ol> <li>Update <code>CHANGELOG.md</code></li> <li>Bump appropriate semantic version</li> <li>Regenerate affected artifacts</li> <li>Update documentation</li> </ol>"},{"location":"reproducibility/#artifact-lifecycle","title":"Artifact Lifecycle","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Create    \u2502\u2500\u2500\u2500\u2500\u25b6\u2502    Store    \u2502\u2500\u2500\u2500\u2500\u25b6\u2502   Replay    \u2502\n\u2502 Simulation  \u2502     \u2502  Artifact   \u2502     \u2502   Verify    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502                   \u2502                   \u2502\n       \u25bc                   \u25bc                   \u25bc\n  SimResult           JSON File          SimResult\n  (in memory)       (persistent)        (reproduced)\n                          \u2502\n                          \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502   Version   \u2502\n                    \u2502   Control   \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"reproducibility/#example-complete-reproducibility-workflow","title":"Example: Complete Reproducibility Workflow","text":"<pre><code>using OpenPKPDCore\n\n# 1. Define simulation (all parameters explicit)\nspec = ModelSpec(\n    OneCompIVBolus(),\n    \"reproducibility_example\",\n    OneCompIVBolusParams(5.0, 50.0),\n    [DoseEvent(0.0, 100.0)]\n)\n\ngrid = SimGrid(0.0, 24.0, collect(0.0:0.5:24.0))\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\n# 2. Run simulation\nresult = simulate(spec, grid, solver)\n\n# 3. Save artifact\nwrite_execution_json(\n    \"reproducible_sim.json\";\n    model_spec=spec,\n    grid=grid,\n    solver=solver,\n    result=result\n)\n\n# 4. Later: replay and verify\nartifact = read_execution_json(\"reproducible_sim.json\")\nreplayed = replay_execution(artifact)\n\n# 5. Confirm exact match\n@assert result.t == replayed.t\n@assert result.observations[:conc] == replayed.observations[:conc]\nprintln(\"Reproducibility verified!\")\n</code></pre>"},{"location":"semantics/","title":"Semantics","text":"<p>OpenPKPD uses semantic versioning for numerical behavior to ensure reproducibility across versions.</p>"},{"location":"semantics/#version-constants","title":"Version Constants","text":"<p>Three independent version numbers track different aspects of system behavior:</p> <pre><code>OPENPKPD_VERSION = \"0.1.0\"           # Software version\nEVENT_SEMANTICS_VERSION = \"1.0.0\"    # Dose event handling\nSOLVER_SEMANTICS_VERSION = \"1.0.0\"   # ODE solver behavior\nARTIFACT_SCHEMA_VERSION = \"1.0.0\"    # JSON artifact format\n</code></pre>"},{"location":"semantics/#event-semantics-v100","title":"Event Semantics (v1.0.0)","text":"<p>Event semantics define how dose events are normalized and applied.</p>"},{"location":"semantics/#dose-normalization-rules","title":"Dose Normalization Rules","text":"<p>Given doses and simulation window <code>[t0, t1]</code>:</p> <ol> <li>Doses at t0: Added to initial state <code>u0</code></li> <li>Doses in (t0, t1]: Applied via ODE callbacks</li> <li>Doses outside [t0, t1]: Ignored</li> <li>Duplicate times: Summed together</li> </ol> <pre><code># Example: doses at [0, 0, 12] with t0=0, t1=24\n# - Doses at t=0 (100 + 50 = 150) \u2192 added to u0\n# - Dose at t=12 \u2192 callback\ndoses = [\n    DoseEvent(0.0, 100.0),\n    DoseEvent(0.0, 50.0),\n    DoseEvent(12.0, 75.0)\n]\n</code></pre>"},{"location":"semantics/#dose-target","title":"Dose Target","text":"<p>Each model defines which compartment receives doses:</p> Model Dose Target <code>OneCompIVBolus</code> Central (index 1) <code>OneCompOralFirstOrder</code> Gut (index 1)"},{"location":"semantics/#callback-timing","title":"Callback Timing","text":"<p>Doses in <code>(t0, t1]</code> are applied as preset time callbacks:</p> <ul> <li>Exact time precision (no interpolation)</li> <li>State discontinuity at dose time</li> <li>Solver restarts after callback</li> </ul>"},{"location":"semantics/#solver-semantics-v100","title":"Solver Semantics (v1.0.0)","text":"<p>Solver semantics define ODE solving behavior and defaults.</p>"},{"location":"semantics/#supported-algorithms","title":"Supported Algorithms","text":"Algorithm Type Use Case <code>Tsit5</code> Explicit Runge-Kutta (5th order) Non-stiff problems (default) <code>Rosenbrock23</code> Rosenbrock method Stiff problems"},{"location":"semantics/#tolerance-interpretation","title":"Tolerance Interpretation","text":"<ul> <li><code>reltol</code>: Relative error tolerance per step</li> <li><code>abstol</code>: Absolute error tolerance per step</li> <li>Error estimate: <code>err \u2264 abstol + reltol * |u|</code></li> </ul>"},{"location":"semantics/#golden-standard-settings","title":"Golden Standard Settings","text":"<p>For reproducibility, use:</p> <pre><code>solver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n</code></pre>"},{"location":"semantics/#output-grid-alignment","title":"Output Grid Alignment","text":"<p>Results are aligned exactly to <code>saveat</code> times:</p> <ul> <li>No interpolation artifacts</li> <li>Deterministic output regardless of internal step size</li> <li>Callback discontinuities preserved</li> </ul>"},{"location":"semantics/#state-continuity","title":"State Continuity","text":"<p>For segmented simulations (IOV, time-varying covariates):</p> <ul> <li>End state of segment N \u2192 initial state of segment N+1</li> <li>No discontinuity except at dose times</li> </ul>"},{"location":"semantics/#artifact-schema-v100","title":"Artifact Schema (v1.0.0)","text":"<p>Artifact schema defines the JSON structure for serialized simulations.</p>"},{"location":"semantics/#common-fields","title":"Common Fields","text":"<p>Every artifact contains:</p> <pre><code>{\n  \"artifact_schema_version\": \"1.0.0\",\n  \"semantics_fingerprint\": {\n    \"artifact_schema_version\": \"1.0.0\",\n    \"event_semantics_version\": \"1.0.0\",\n    \"solver_semantics_version\": \"1.0.0\"\n  }\n}\n</code></pre>"},{"location":"semantics/#artifact-types","title":"Artifact Types","text":"Type <code>artifact_type</code> Value Single execution <code>\"single\"</code> or absent Population <code>\"population\"</code> Sensitivity (single) <code>\"sensitivity_single\"</code> Sensitivity (population) <code>\"sensitivity_population\"</code>"},{"location":"semantics/#numeric-precision","title":"Numeric Precision","text":"<ul> <li>All floating-point values stored with full precision</li> <li>No rounding or truncation</li> <li>JSON uses IEEE 754 double representation</li> </ul>"},{"location":"semantics/#semantics-fingerprint","title":"Semantics Fingerprint","text":"<p>Every artifact includes a fingerprint for version tracking:</p> <pre><code>semantics_fingerprint() = Dict(\n    \"artifact_schema_version\" =&gt; ARTIFACT_SCHEMA_VERSION,\n    \"event_semantics_version\" =&gt; EVENT_SEMANTICS_VERSION,\n    \"solver_semantics_version\" =&gt; SOLVER_SEMANTICS_VERSION,\n)\n</code></pre>"},{"location":"semantics/#fingerprint-verification","title":"Fingerprint Verification","text":"<p>When replaying artifacts:</p> <ol> <li>Read stored fingerprint</li> <li>Compare to current versions</li> <li>Warn if mismatch (results may differ)</li> </ol>"},{"location":"semantics/#version-bump-policy","title":"Version Bump Policy","text":""},{"location":"semantics/#when-to-bump-event-semantics","title":"When to Bump Event Semantics","text":"<ul> <li>Change to dose normalization rules</li> <li>Change to dose application order</li> <li>Change to callback timing</li> <li>Change to dose target assignment</li> </ul>"},{"location":"semantics/#when-to-bump-solver-semantics","title":"When to Bump Solver Semantics","text":"<ul> <li>Change to default tolerances</li> <li>Change to algorithm selection logic</li> <li>Change to output grid alignment</li> <li>Change to segmentation behavior</li> </ul>"},{"location":"semantics/#when-to-bump-artifact-schema","title":"When to Bump Artifact Schema","text":"<ul> <li>Change to JSON field names</li> <li>Change to JSON structure</li> <li>Addition of required fields</li> <li>Removal of fields</li> </ul>"},{"location":"semantics/#process-for-bumping","title":"Process for Bumping","text":"<ol> <li>Identify Change: Document what behavior changes</li> <li>Bump Version: Increment appropriate version number</li> <li>Update Golden: Re-generate all affected golden artifacts</li> <li>Update Tests: Ensure tests pass with new behavior</li> <li>Document: Add entry to changelog</li> </ol>"},{"location":"semantics/#compatibility","title":"Compatibility","text":""},{"location":"semantics/#forward-compatibility","title":"Forward Compatibility","text":"<p>Newer OpenPKPD versions can replay older artifacts:</p> <ul> <li>Missing fields use defaults</li> <li>Schema upgrades are automatic</li> </ul>"},{"location":"semantics/#backward-compatibility","title":"Backward Compatibility","text":"<p>Older OpenPKPD versions may not replay newer artifacts:</p> <ul> <li>Unknown fields are ignored</li> <li>Missing required fields cause errors</li> </ul>"},{"location":"semantics/#cross-platform-compatibility","title":"Cross-Platform Compatibility","text":"<p>Same artifact should produce identical results on:</p> <ul> <li>Different operating systems</li> <li>Different Julia versions (\u22651.9)</li> <li>Different hardware architectures</li> </ul>"},{"location":"semantics/#iiviov-semantics","title":"IIV/IOV Semantics","text":""},{"location":"semantics/#random-number-generation","title":"Random Number Generation","text":"<ul> <li>Uses <code>Random.Xoshiro</code> PRNG</li> <li>Seed fully determines sequence</li> <li>Separate seeds for IIV and IOV</li> </ul>"},{"location":"semantics/#log-normal-transform","title":"Log-Normal Transform","text":"<pre><code>theta_i = theta_pop * exp(eta)\neta ~ Normal(0, omega^2)\n</code></pre>"},{"location":"semantics/#occasion-semantics-v1","title":"Occasion Semantics (v1)","text":"<p>Occasion boundaries derived from dose times:</p> <ol> <li><code>t0</code> always starts occasion 1</li> <li>Each unique dose time &gt; t0 starts new occasion</li> <li>Times sorted and deduplicated</li> <li>Only times in [t0, t1] considered</li> </ol>"},{"location":"semantics/#covariate-semantics","title":"Covariate Semantics","text":""},{"location":"semantics/#application-order","title":"Application Order","text":"<p>Covariate effects applied in declaration order:</p> <pre><code>effects = [\n    CovariateEffect(PowerCovariate(), :CL, :WT, 0.75, 70.0),\n    CovariateEffect(LinearCovariate(), :CL, :AGE, -0.01, 40.0)\n]\n# Applied: CL \u2192 (WT effect) \u2192 (AGE effect)\n</code></pre>"},{"location":"semantics/#time-varying-interpolation","title":"Time-Varying Interpolation","text":"<p>Step: Value from rightmost knot \u2264 t <pre><code>series.times = [0, 24, 48]\nseries.values = [1, 2, 3]\nvalue_at(15) = 1  # Uses knot at 0\nvalue_at(24) = 2  # Uses knot at 24\n</code></pre></p> <p>Linear: Interpolate between knots <pre><code>value_at(12) = 1.5  # Interpolate 0\u219224\n</code></pre></p>"},{"location":"semantics/#sensitivity-semantics","title":"Sensitivity Semantics","text":""},{"location":"semantics/#perturbation-application","title":"Perturbation Application","text":"<p>Perturbations applied in declaration order:</p> <pre><code>plan.perturbations = [\n    Perturbation(RelativePerturbation(), :CL, 0.1),\n    Perturbation(AbsolutePerturbation(), :V, 5.0)\n]\n# Applied: CL \u2192 CL * 1.1, then V \u2192 V + 5\n</code></pre>"},{"location":"semantics/#metric-computation","title":"Metric Computation","text":"<p>All metrics computed element-wise on output series:</p> <pre><code>max_abs_delta = max(|base[i] - pert[i]|)\nmax_rel_delta = max(|base[i] - pert[i]| / |base[i]|)\nl2_norm_delta = sqrt(sum((base[i] - pert[i])^2))\n</code></pre>"},{"location":"semantics/#examples","title":"Examples","text":""},{"location":"semantics/#verifying-semantics-match","title":"Verifying Semantics Match","text":"<pre><code>using OpenPKPDCore\n\n# Check current versions\nprintln(\"Event semantics: \", EVENT_SEMANTICS_VERSION)\nprintln(\"Solver semantics: \", SOLVER_SEMANTICS_VERSION)\nprintln(\"Artifact schema: \", ARTIFACT_SCHEMA_VERSION)\n\n# Check artifact fingerprint\nartifact = read_execution_json(\"my_artifact.json\")\nfingerprint = artifact[\"semantics_fingerprint\"]\n\nif fingerprint[\"event_semantics_version\"] != EVENT_SEMANTICS_VERSION\n    @warn \"Event semantics version mismatch\"\nend\n</code></pre>"},{"location":"semantics/#ensuring-reproducibility","title":"Ensuring Reproducibility","text":"<pre><code># Use explicit, high-precision settings\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\n# Use deterministic seeds\niiv = IIVSpec(LogNormalIIV(), omegas, UInt64(12345), n)\n\n# Save artifact for future validation\nwrite_execution_json(\"reproducible.json\"; ...)\n</code></pre>"},{"location":"sensitivity/","title":"Sensitivity Analysis","text":"<p>OpenPKPD provides tools for analyzing how parameter changes affect model outputs, essential for understanding model behavior and identifying critical parameters.</p>"},{"location":"sensitivity/#overview","title":"Overview","text":"<p>Sensitivity analysis answers questions like:</p> <ul> <li>How much does concentration change if clearance increases by 10%?</li> <li>Which parameters have the largest impact on drug exposure?</li> <li>How does population variability affect therapeutic outcomes?</li> </ul> <p>OpenPKPD supports both single-subject and population-level sensitivity analysis.</p>"},{"location":"sensitivity/#perturbation-types","title":"Perturbation Types","text":""},{"location":"sensitivity/#relative-perturbation","title":"Relative Perturbation","text":"<p>Changes parameter by a fraction of its base value:</p> \\[\\theta_{new} = \\theta_{base} \\cdot (1 + \\delta)\\] <pre><code>RelativePerturbation()\n</code></pre> <p>Example: <code>delta = 0.1</code> increases parameter by 10%</p>"},{"location":"sensitivity/#absolute-perturbation","title":"Absolute Perturbation","text":"<p>Changes parameter by a fixed amount:</p> \\[\\theta_{new} = \\theta_{base} + \\delta\\] <pre><code>AbsolutePerturbation()\n</code></pre> <p>Example: <code>delta = 1.0</code> increases parameter by 1 unit</p>"},{"location":"sensitivity/#perturbation-specification","title":"Perturbation Specification","text":""},{"location":"sensitivity/#single-perturbation","title":"Single Perturbation","text":"<pre><code>struct Perturbation{K&lt;:PerturbationKind}\n    kind::K           # RelativePerturbation or AbsolutePerturbation\n    param::Symbol     # Parameter to perturb\n    delta::Float64    # Change magnitude\nend\n</code></pre>"},{"location":"sensitivity/#perturbation-plan","title":"Perturbation Plan","text":"<p>A plan groups multiple perturbations to be applied together:</p> <pre><code>struct PerturbationPlan\n    name::String\n    perturbations::Vector{Perturbation}  # Applied in sequence\nend\n</code></pre>"},{"location":"sensitivity/#sensitivity-metrics","title":"Sensitivity Metrics","text":"<p>OpenPKPD computes three metrics comparing base and perturbed output series:</p> <pre><code>struct SensitivityMetric\n    max_abs_delta::Float64   # Maximum |base - pert|\n    max_rel_delta::Float64   # Maximum |base - pert| / |base|\n    l2_norm_delta::Float64   # sqrt(sum((base - pert)^2))\nend\n</code></pre> Metric Formula Use Case <code>max_abs_delta</code> \\(\\max\\|y_{base} - y_{pert}\\|\\) Maximum deviation <code>max_rel_delta</code> \\(\\max\\frac{\\|y_{base} - y_{pert}\\|}{\\|y_{base}\\|}\\) Relative impact <code>l2_norm_delta</code> \\(\\sqrt{\\sum(y_{base} - y_{pert})^2}\\) Overall deviation"},{"location":"sensitivity/#single-subject-sensitivity","title":"Single-Subject Sensitivity","text":""},{"location":"sensitivity/#function","title":"Function","text":"<pre><code>run_sensitivity(spec, grid, solver; plan, observation=:conc)\n</code></pre> Parameter Description <code>spec</code> Model specification <code>grid</code> Simulation grid <code>solver</code> Solver specification <code>plan</code> Perturbation plan <code>observation</code> Output to analyze (default <code>:conc</code>)"},{"location":"sensitivity/#result-structure","title":"Result Structure","text":"<pre><code>struct SensitivityResult\n    plan::PerturbationPlan\n    observation::Symbol\n    base_metric_series::Vector{Float64}\n    pert_metric_series::Vector{Float64}\n    metrics::SensitivityMetric\n    metadata::Dict{String, Any}\nend\n</code></pre>"},{"location":"sensitivity/#example-cl-sensitivity","title":"Example: CL Sensitivity","text":"<pre><code>using OpenPKPDCore\n\n# Define model\nparams = OneCompIVBolusParams(5.0, 50.0)\nspec = ModelSpec(\n    OneCompIVBolus(),\n    \"sensitivity_example\",\n    params,\n    [DoseEvent(0.0, 100.0)]\n)\n\ngrid = SimGrid(0.0, 24.0, collect(0.0:0.5:24.0))\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\n# Perturbation plan: 10% increase in CL\nplan = PerturbationPlan(\n    \"CL_10pct_increase\",\n    [Perturbation(RelativePerturbation(), :CL, 0.1)]\n)\n\n# Run sensitivity analysis\nresult = run_sensitivity(spec, grid, solver; plan=plan, observation=:conc)\n\nprintln(\"Base concentrations: \", result.base_metric_series)\nprintln(\"Perturbed concentrations: \", result.pert_metric_series)\nprintln(\"Max absolute delta: \", result.metrics.max_abs_delta)\nprintln(\"Max relative delta: \", result.metrics.max_rel_delta)\nprintln(\"L2 norm delta: \", result.metrics.l2_norm_delta)\n</code></pre>"},{"location":"sensitivity/#example-multiple-parameter-perturbation","title":"Example: Multiple Parameter Perturbation","text":"<pre><code># Perturbation plan: increase CL by 10% and decrease V by 5%\nplan = PerturbationPlan(\n    \"CL_up_V_down\",\n    [\n        Perturbation(RelativePerturbation(), :CL, 0.1),   # +10% CL\n        Perturbation(RelativePerturbation(), :V, -0.05)  # -5% V\n    ]\n)\n\nresult = run_sensitivity(spec, grid, solver; plan=plan)\n</code></pre>"},{"location":"sensitivity/#example-absolute-perturbation","title":"Example: Absolute Perturbation","text":"<pre><code># Perturbation plan: increase CL by 1 L/h\nplan = PerturbationPlan(\n    \"CL_plus_1\",\n    [Perturbation(AbsolutePerturbation(), :CL, 1.0)]\n)\n\nresult = run_sensitivity(spec, grid, solver; plan=plan)\n</code></pre>"},{"location":"sensitivity/#population-sensitivity","title":"Population Sensitivity","text":"<p>Population sensitivity analysis evaluates how parameter perturbations affect population-level summaries (mean, quantiles).</p>"},{"location":"sensitivity/#function_1","title":"Function","text":"<pre><code>run_population_sensitivity(pop, grid, solver; plan, observation=:conc, probs=[0.05, 0.95])\n</code></pre> Parameter Description <code>pop</code> Population specification <code>grid</code> Simulation grid <code>solver</code> Solver specification <code>plan</code> Perturbation plan <code>observation</code> Output to analyze (default <code>:conc</code>) <code>probs</code> Quantile probabilities (default <code>[0.05, 0.95]</code>)"},{"location":"sensitivity/#result-structure_1","title":"Result Structure","text":"<pre><code>struct PopulationSensitivityResult\n    plan::PerturbationPlan\n    observation::Symbol\n    probs::Vector{Float64}\n    base_summary_mean::Vector{Float64}\n    pert_summary_mean::Vector{Float64}\n    base_quantiles::Dict{Float64, Vector{Float64}}\n    pert_quantiles::Dict{Float64, Vector{Float64}}\n    metrics_mean::SensitivityMetric\n    metadata::Dict{String, Any}\nend\n</code></pre>"},{"location":"sensitivity/#example-population-cl-sensitivity","title":"Example: Population CL Sensitivity","text":"<pre><code>using OpenPKPDCore\n\n# Define population\nparams = OneCompIVBolusParams(5.0, 50.0)\nbase_spec = ModelSpec(\n    OneCompIVBolus(),\n    \"pop_sens\",\n    params,\n    [DoseEvent(0.0, 100.0)]\n)\n\niiv = IIVSpec(\n    LogNormalIIV(),\n    Dict(:CL =&gt; 0.3, :V =&gt; 0.2),\n    UInt64(12345),\n    100\n)\n\npop = PopulationSpec(base_spec, iiv, nothing, nothing, [])\n\ngrid = SimGrid(0.0, 24.0, collect(0.0:0.5:24.0))\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\n# Perturbation plan: 20% increase in typical CL\nplan = PerturbationPlan(\n    \"CL_20pct\",\n    [Perturbation(RelativePerturbation(), :CL, 0.2)]\n)\n\n# Run population sensitivity\nresult = run_population_sensitivity(\n    pop, grid, solver;\n    plan=plan,\n    observation=:conc,\n    probs=[0.05, 0.50, 0.95]\n)\n\nprintln(\"Base mean: \", result.base_summary_mean)\nprintln(\"Perturbed mean: \", result.pert_summary_mean)\nprintln(\"Mean metrics: \", result.metrics_mean)\n\n# Compare quantiles\nprintln(\"Base 5th percentile: \", result.base_quantiles[0.05])\nprintln(\"Pert 5th percentile: \", result.pert_quantiles[0.05])\n</code></pre>"},{"location":"sensitivity/#helper-functions","title":"Helper Functions","text":""},{"location":"sensitivity/#apply-single-perturbation","title":"Apply Single Perturbation","text":"<pre><code>new_params = apply_perturbation(params, perturbation)\n</code></pre>"},{"location":"sensitivity/#apply-perturbation-plan","title":"Apply Perturbation Plan","text":"<pre><code>new_params = apply_plan(params, plan)\n</code></pre>"},{"location":"sensitivity/#compute-metrics","title":"Compute Metrics","text":"<pre><code>metrics = compute_metrics(base_series, pert_series)\n</code></pre>"},{"location":"sensitivity/#sensitivity-analysis-workflow","title":"Sensitivity Analysis Workflow","text":""},{"location":"sensitivity/#1-define-baseline-model","title":"1. Define Baseline Model","text":"<pre><code>params = OneCompIVBolusParams(5.0, 50.0)\nspec = ModelSpec(OneCompIVBolus(), \"baseline\", params, [DoseEvent(0.0, 100.0)])\n</code></pre>"},{"location":"sensitivity/#2-create-perturbation-plans","title":"2. Create Perturbation Plans","text":"<pre><code>plans = [\n    PerturbationPlan(\"CL+10%\", [Perturbation(RelativePerturbation(), :CL, 0.1)]),\n    PerturbationPlan(\"CL-10%\", [Perturbation(RelativePerturbation(), :CL, -0.1)]),\n    PerturbationPlan(\"V+10%\", [Perturbation(RelativePerturbation(), :V, 0.1)]),\n    PerturbationPlan(\"V-10%\", [Perturbation(RelativePerturbation(), :V, -0.1)]),\n]\n</code></pre>"},{"location":"sensitivity/#3-run-sensitivity-for-each-plan","title":"3. Run Sensitivity for Each Plan","text":"<pre><code>results = Dict{String, SensitivityResult}()\nfor plan in plans\n    results[plan.name] = run_sensitivity(spec, grid, solver; plan=plan)\nend\n</code></pre>"},{"location":"sensitivity/#4-analyze-results","title":"4. Analyze Results","text":"<pre><code>println(\"Parameter Sensitivity Summary:\")\nprintln(\"=\" ^ 50)\nfor (name, res) in results\n    println(\"$name:\")\n    println(\"  Max absolute delta: $(res.metrics.max_abs_delta)\")\n    println(\"  Max relative delta: $(res.metrics.max_rel_delta)\")\n    println()\nend\n</code></pre>"},{"location":"sensitivity/#serialization","title":"Serialization","text":"<p>Sensitivity results can be saved to JSON artifacts.</p>"},{"location":"sensitivity/#single-sensitivity-artifact","title":"Single Sensitivity Artifact","text":"<pre><code>write_sensitivity_json(\n    \"sensitivity_result.json\";\n    model_spec=spec,\n    grid=grid,\n    solver=solver,\n    result=result\n)\n</code></pre>"},{"location":"sensitivity/#population-sensitivity-artifact","title":"Population Sensitivity Artifact","text":"<pre><code>write_population_sensitivity_json(\n    \"pop_sensitivity_result.json\";\n    population_spec=pop,\n    grid=grid,\n    solver=solver,\n    result=result\n)\n</code></pre>"},{"location":"sensitivity/#replay-sensitivity-artifact","title":"Replay Sensitivity Artifact","text":"<pre><code>artifact = read_execution_json(\"sensitivity_result.json\")\nreplayed = replay_sensitivity_execution(artifact)\n</code></pre>"},{"location":"sensitivity/#complete-example-parameter-ranking","title":"Complete Example: Parameter Ranking","text":"<pre><code>using OpenPKPDCore\n\n# Model setup\nparams = OneCompOralFirstOrderParams(1.5, 5.0, 50.0)\nspec = ModelSpec(\n    OneCompOralFirstOrder(),\n    \"oral_sensitivity\",\n    params,\n    [DoseEvent(0.0, 200.0)]\n)\n\ngrid = SimGrid(0.0, 24.0, collect(0.0:0.25:24.0))\nsolver = SolverSpec(:Tsit5, 1e-10, 1e-12, 10_000_000)\n\n# Parameter perturbations (all +10%)\nparam_names = [:Ka, :CL, :V]\nsensitivity_results = Dict{Symbol, Float64}()\n\nfor param in param_names\n    plan = PerturbationPlan(\n        \"$(param)_sensitivity\",\n        [Perturbation(RelativePerturbation(), param, 0.1)]\n    )\n    result = run_sensitivity(spec, grid, solver; plan=plan)\n    sensitivity_results[param] = result.metrics.max_rel_delta\nend\n\n# Rank parameters by sensitivity\nsorted_params = sort(collect(sensitivity_results), by=x-&gt;x[2], rev=true)\n\nprintln(\"Parameter Sensitivity Ranking (10% perturbation):\")\nprintln(\"=\" ^ 50)\nfor (i, (param, sens)) in enumerate(sorted_params)\n    println(\"$i. $param: max relative delta = $(round(sens, digits=4))\")\nend\n</code></pre>"},{"location":"sensitivity/#best-practices","title":"Best Practices","text":"<ol> <li>Use Relative Perturbations for comparing parameters with different scales</li> <li>Match Perturbation Size to expected variability (e.g., IIV omega values)</li> <li>Consider Multiple Metrics - max_abs for safety margins, max_rel for proportional impact</li> <li>Population Sensitivity for understanding variability-parameter interactions</li> <li>Document Plans with meaningful names for reproducibility</li> </ol>"},{"location":"trial/","title":"Clinical Trial Simulation Reference","text":"<p>OpenPKPD provides comprehensive clinical trial simulation capabilities for pharmacometric studies, including study design, dosing regimens, virtual population generation, and statistical analysis.</p>"},{"location":"trial/#overview","title":"Overview","text":"<p>The trial simulation module supports:</p> <ul> <li>Study Designs: Parallel, crossover, dose-escalation, adaptive, bioequivalence</li> <li>Dosing Regimens: QD, BID, TID, QID, titration, custom schedules</li> <li>Virtual Populations: Demographic modeling, disease states, covariates</li> <li>Trial Events: Enrollment, dropout, compliance</li> <li>Statistical Analysis: Power analysis, sample size, alpha spending, BE analysis</li> </ul>"},{"location":"trial/#quick-start","title":"Quick Start","text":"<pre><code>from openpkpd import trial\n\n# Create a parallel design study\ndesign = trial.parallel_design(2)\n\n# Create dosing regimens\nplacebo = trial.dosing_qd(0.0, 28)\nactive = trial.dosing_qd(100.0, 28)\n\n# Create treatment arms\narms = [\n    trial.TreatmentArm(\"Placebo\", placebo, 50, placebo=True),\n    trial.TreatmentArm(\"Active\", active, 50),\n]\n\n# Create trial specification\nspec = trial.TrialSpec(\n    name=\"Phase 2 Study\",\n    design=design,\n    arms=arms,\n    duration_days=28,\n    seed=42\n)\n\n# Run simulation\nresult = trial.simulate_trial(spec)\n\nprint(f\"Completion rate: {result.overall_completion_rate:.1%}\")\n</code></pre>"},{"location":"trial/#study-designs","title":"Study Designs","text":""},{"location":"trial/#parallel-group-design","title":"Parallel Group Design","text":"<p>Standard parallel group design with independent treatment arms.</p> <pre><code>from openpkpd.trial import parallel_design, ParallelDesign\n\n# Two-arm parallel design (1:1 randomization)\ndesign = parallel_design(2)\n\n# Three-arm with custom randomization (2:1:1)\ndesign = parallel_design(3, randomization_ratio=[0.5, 0.25, 0.25])\n\n# With stratification factors\ndesign = parallel_design(\n    2,\n    stratification_factors=[\"age_group\", \"disease_severity\"]\n)\n</code></pre> <p>Attributes:</p> Attribute Type Description <code>n_arms</code> int Number of treatment arms <code>randomization_ratio</code> List[float] Allocation ratio (sums to 1.0) <code>stratification_factors</code> List[str] Stratification variables"},{"location":"trial/#crossover-designs","title":"Crossover Designs","text":""},{"location":"trial/#2x2-crossover-ab-ba","title":"2x2 Crossover (AB, BA)","text":"<pre><code>from openpkpd.trial import crossover_2x2\n\ndesign = crossover_2x2(washout_duration=14.0)\n# Sequences: [[1, 2], [2, 1]]\n</code></pre>"},{"location":"trial/#3x3-latin-square","title":"3x3 Latin Square","text":"<pre><code>from openpkpd.trial import crossover_3x3\n\ndesign = crossover_3x3(washout_duration=21.0)\n# Sequences: [[1, 2, 3], [2, 3, 1], [3, 1, 2]]\n</code></pre>"},{"location":"trial/#williams-design","title":"Williams Design","text":"<p>Balanced for first-order carryover effects.</p> <pre><code>from openpkpd.trial import williams_design\n\n# 2-treatment Williams (same as 2x2)\ndesign = williams_design(2, washout_duration=7.0)\n\n# 3-treatment Williams (6 sequences)\ndesign = williams_design(3, washout_duration=14.0)\n\n# 4-treatment Williams (8 sequences)\ndesign = williams_design(4, washout_duration=21.0)\n</code></pre> <p>Crossover Attributes:</p> Attribute Type Description <code>n_periods</code> int Number of treatment periods <code>n_sequences</code> int Number of treatment sequences <code>washout_duration</code> float Washout period in days <code>sequence_assignments</code> List[List[int]] Treatment order per sequence"},{"location":"trial/#dose-escalation-designs","title":"Dose Escalation Designs","text":"<p>For Phase I first-in-human studies.</p>"},{"location":"trial/#33-design","title":"3+3 Design","text":"<p>Traditional rule-based escalation.</p> <pre><code>from openpkpd.trial import dose_escalation_3plus3\n\ndose_levels = [10.0, 25.0, 50.0, 100.0, 200.0]\ndesign = dose_escalation_3plus3(\n    dose_levels,\n    starting_dose=10.0,\n    max_dlt_rate=0.33,\n    cohort_size=3,\n    max_subjects=30\n)\n</code></pre>"},{"location":"trial/#mtpi-modified-toxicity-probability-interval","title":"mTPI (Modified Toxicity Probability Interval)","text":"<pre><code>from openpkpd.trial import dose_escalation_mtpi\n\ndesign = dose_escalation_mtpi(\n    dose_levels=[10.0, 25.0, 50.0, 100.0],\n    target_dlt_rate=0.25,\n    cohort_size=3\n)\n</code></pre>"},{"location":"trial/#crm-continual-reassessment-method","title":"CRM (Continual Reassessment Method)","text":"<p>Model-based escalation.</p> <pre><code>from openpkpd.trial import dose_escalation_crm\n\ndesign = dose_escalation_crm(\n    dose_levels=[10.0, 25.0, 50.0, 100.0, 200.0],\n    target_dlt_rate=0.25,\n    cohort_size=1  # CRM typically uses single-patient cohorts\n)\n</code></pre> <p>Escalation Attributes:</p> Attribute Type Description <code>dose_levels</code> List[float] Available dose levels <code>starting_dose</code> float Initial dose (default: first level) <code>escalation_rule</code> str \"3+3\", \"mTPI\", or \"CRM\" <code>cohort_size</code> int Subjects per cohort <code>target_dlt_rate</code> float Target DLT probability"},{"location":"trial/#adaptive-designs","title":"Adaptive Designs","text":"<p>Designs with pre-planned interim analyses.</p> <pre><code>from openpkpd.trial import adaptive_design, parallel_design\n\nbase = parallel_design(2)\n\ndesign = adaptive_design(\n    base,\n    interim_analyses=[0.5, 0.75],  # At 50% and 75% information\n    alpha_spending=\"obrien_fleming\",\n    futility_boundary=0.10\n)\n</code></pre> <p>Alpha Spending Functions:</p> Function Description Early Stopping <code>obrien_fleming</code> Conservative early, liberal late Rare early stops <code>pocock</code> Equal spending across analyses More early stops <code>haybittle_peto</code> Fixed boundary (p&lt;0.001) for interim Very conservative"},{"location":"trial/#bioequivalence-designs","title":"Bioequivalence Designs","text":"<pre><code>from openpkpd.trial import bioequivalence_design\n\n# FDA standard BE study\ndesign = bioequivalence_design(\n    n_periods=2,\n    n_sequences=2,\n    washout_duration=7.0,\n    bioequivalence_limits=(0.80, 1.25),\n    parameters=[\"cmax\", \"auc_0_inf\"],\n    regulatory_guidance=\"fda\"\n)\n\n# EMA highly variable drugs\ndesign = bioequivalence_design(\n    bioequivalence_limits=(0.6984, 1.4319),\n    regulatory_guidance=\"ema\"\n)\n</code></pre>"},{"location":"trial/#dosing-regimens","title":"Dosing Regimens","text":""},{"location":"trial/#standard-regimens","title":"Standard Regimens","text":"<pre><code>from openpkpd.trial import dosing_qd, dosing_bid, dosing_tid, dosing_qid\n\n# Once daily - 100 mg for 28 days\nregimen = dosing_qd(100.0, 28)\n\n# Twice daily - 50 mg for 14 days\nregimen = dosing_bid(50.0, 14)\n\n# Three times daily - 25 mg for 7 days\nregimen = dosing_tid(25.0, 7)\n\n# Four times daily - 20 mg for 5 days\nregimen = dosing_qid(20.0, 5)\n\n# With loading dose\nregimen = dosing_qd(100.0, 28, loading_dose=200.0)\n</code></pre> <p>Default Dose Times (hours after midnight):</p> Frequency Dose Times QD [8:00] BID [8:00, 20:00] TID [8:00, 14:00, 20:00] QID [8:00, 12:00, 16:00, 20:00]"},{"location":"trial/#custom-regimens","title":"Custom Regimens","text":"<pre><code>from openpkpd.trial import dosing_custom\n\n# Custom timing: 6 AM and 10 PM\nregimen = dosing_custom(75.0, 21, dose_times=[6.0, 22.0])\n</code></pre>"},{"location":"trial/#titration-regimens","title":"Titration Regimens","text":"<pre><code>from openpkpd.trial import titration_regimen\n\n# Titrate from 25 to 100 mg in 4 steps, 7 days each\nregimen = titration_regimen(\n    start_dose=25.0,\n    target_dose=100.0,\n    n_steps=4,\n    days_per_step=7\n)\n\n# With maintenance phase\nregimen = titration_regimen(\n    start_dose=25.0,\n    target_dose=100.0,\n    n_steps=4,\n    days_per_step=7,\n    maintenance_days=28  # 28 days at target dose\n)\n</code></pre>"},{"location":"trial/#dose-event-calculations","title":"Dose Event Calculations","text":"<pre><code>from openpkpd.trial import dose_event_times, total_regimen_duration\n\nregimen = dosing_bid(50.0, 3)\n\n# Get all dose times\ntimes = dose_event_times(regimen)\n# [8.0, 20.0, 32.0, 44.0, 56.0, 68.0]\n\n# Get total duration\nduration = total_regimen_duration(regimen)\n# 3 (days)\n</code></pre>"},{"location":"trial/#virtual-population-generation","title":"Virtual Population Generation","text":""},{"location":"trial/#basic-population","title":"Basic Population","text":"<pre><code>from openpkpd.trial import generate_virtual_population\n\n# Generate 100 subjects with default demographics\npopulation = generate_virtual_population(100, seed=42)\n\nfor subject in population[:3]:\n    print(f\"ID: {subject.id}, Age: {subject.age:.1f}, \"\n          f\"Weight: {subject.weight:.1f} kg, Sex: {subject.sex}\")\n</code></pre>"},{"location":"trial/#demographic-specifications","title":"Demographic Specifications","text":"<pre><code>from openpkpd.trial import DemographicSpec, generate_virtual_population\n\n# Custom demographics\ndemo = DemographicSpec(\n    age_mean=50.0,\n    age_sd=12.0,\n    age_range=(30.0, 70.0),\n    weight_mean=80.0,\n    weight_sd=15.0,\n    weight_range=(50.0, 120.0),\n    female_proportion=0.45,\n    race_distribution={\n        \"caucasian\": 0.65,\n        \"asian\": 0.15,\n        \"black\": 0.15,\n        \"hispanic\": 0.05\n    }\n)\n\npopulation = generate_virtual_population(100, demographics=demo, seed=42)\n</code></pre>"},{"location":"trial/#pre-defined-populations","title":"Pre-defined Populations","text":"<pre><code>from openpkpd.trial import (\n    default_demographic_spec,\n    healthy_volunteer_spec,\n    patient_population_spec\n)\n\n# Healthy volunteers (Phase I)\ndemo = healthy_volunteer_spec()\n# Age 30\u00b18, 18-45 years, 72\u00b110 kg\n\n# Disease-specific populations\ndemo, disease = patient_population_spec(\"diabetes\")\ndemo, disease = patient_population_spec(\"renal\")\ndemo, disease = patient_population_spec(\"hepatic\")\ndemo, disease = patient_population_spec(\"oncology\")\n</code></pre>"},{"location":"trial/#population-with-disease-state","title":"Population with Disease State","text":"<pre><code>demo, disease = patient_population_spec(\"diabetes\")\n\npopulation = generate_virtual_population(\n    100,\n    demographics=demo,\n    disease=disease,\n    seed=42\n)\n\nfor subject in population[:3]:\n    print(f\"ID: {subject.id}, Severity: {subject.disease_severity}, \"\n          f\"Biomarker: {subject.baseline_biomarker:.1f}\")\n</code></pre>"},{"location":"trial/#population-summary","title":"Population Summary","text":"<pre><code>from openpkpd.trial import summarize_population\n\nsummary = summarize_population(population)\n\nprint(f\"N: {summary['n']}\")\nprint(f\"Age: {summary['age_mean']:.1f} \u00b1 {summary['age_sd']:.1f}\")\nprint(f\"Weight: {summary['weight_mean']:.1f} \u00b1 {summary['weight_sd']:.1f}\")\nprint(f\"Female: {summary['female_proportion']:.1%}\")\nprint(f\"Race: {summary['race_distribution']}\")\n</code></pre>"},{"location":"trial/#trial-simulation","title":"Trial Simulation","text":""},{"location":"trial/#trial-specification","title":"Trial Specification","text":"<pre><code>from openpkpd.trial import (\n    TrialSpec, TreatmentArm, parallel_design, dosing_qd,\n    VirtualPopulationSpec, DemographicSpec,\n    DropoutSpec, ComplianceSpec\n)\n\nspec = TrialSpec(\n    name=\"Phase 2 Study\",\n    design=parallel_design(2),\n    arms=[\n        TreatmentArm(\"Placebo\", dosing_qd(0.0, 28), 50, placebo=True),\n        TreatmentArm(\"Active\", dosing_qd(100.0, 28), 50),\n    ],\n    population_spec=VirtualPopulationSpec(\n        demographics=DemographicSpec(age_mean=55.0)\n    ),\n    duration_days=28,\n    enrollment_rate=5.0,  # Subjects per day\n    dropout=DropoutSpec(random_rate_per_day=0.005),\n    compliance=ComplianceSpec(mean_compliance=0.90, pattern=\"decay\"),\n    pk_sampling_times=[0, 1, 2, 4, 8, 12, 24],\n    endpoints=[\"pk_exposure\"],\n    n_replicates=1,\n    seed=42\n)\n</code></pre>"},{"location":"trial/#running-simulations","title":"Running Simulations","text":"<pre><code>from openpkpd.trial import simulate_trial, simulate_trial_replicates\n\n# Single simulation\nresult = simulate_trial(spec)\n\nprint(f\"Trial: {result.trial_name}\")\nprint(f\"Completion: {result.overall_completion_rate:.1%}\")\nprint(f\"Compliance: {result.overall_compliance:.1%}\")\n\n# Access arm results\nfor arm_name, arm_result in result.arms.items():\n    print(f\"\\n{arm_name}:\")\n    print(f\"  Enrolled: {arm_result.n_enrolled}\")\n    print(f\"  Completed: {arm_result.n_completed}\")\n    print(f\"  Compliance: {arm_result.mean_compliance:.1%}\")\n\n# Multiple replicates\nresults = simulate_trial_replicates(spec, n_replicates=100)\n</code></pre>"},{"location":"trial/#dropout-modeling","title":"Dropout Modeling","text":"<pre><code>from openpkpd.trial import simulate_dropout, DropoutSpec\n\n# Random dropout at 1% per day\nspec = DropoutSpec(random_rate_per_day=0.01)\n\ndropout_days = simulate_dropout(100, 28.0, spec, seed=42)\nn_dropouts = sum(1 for d in dropout_days if d is not None)\nprint(f\"Dropouts: {n_dropouts}/100\")\n</code></pre>"},{"location":"trial/#compliance-modeling","title":"Compliance Modeling","text":"<pre><code>from openpkpd.trial import apply_compliance, ComplianceSpec\n\ntimes = list(range(0, 168, 24))  # 7 days\namounts = [100.0] * 7\n\n# Random non-compliance\nspec = ComplianceSpec(mean_compliance=0.80, pattern=\"random\")\n\n# Patterns:\n# - \"random\": Random misses\n# - \"weekend_miss\": Higher miss rate on weekends\n# - \"decay\": Compliance decreases over time\n# - \"early_good\": Better compliance early in study\n\nactual = apply_compliance(times, amounts, spec, seed=42)\ntaken = sum(1 for d in actual if d &gt; 0)\nprint(f\"Doses taken: {taken}/7\")\n</code></pre>"},{"location":"trial/#statistical-analysis","title":"Statistical Analysis","text":""},{"location":"trial/#power-analysis","title":"Power Analysis","text":"<pre><code>from openpkpd.trial import estimate_power_analytical, PowerResult\n\n# Calculate power for given sample size and effect size\nresult = estimate_power_analytical(\n    n_per_arm=50,\n    effect_size=0.5,  # Cohen's d\n    sd=1.0,\n    alpha=0.05,\n    alternative=\"two-sided\"\n)\n\nprint(f\"Power: {result.power:.1%}\")\n</code></pre>"},{"location":"trial/#sample-size-estimation","title":"Sample Size Estimation","text":"<pre><code>from openpkpd.trial import estimate_sample_size\n\nresult = estimate_sample_size(\n    target_power=0.80,\n    effect_size=0.5,\n    alpha=0.05\n)\n\nprint(f\"N per arm: {result.n_per_arm}\")\nprint(f\"Total N: {result.total_n}\")\nprint(f\"Achieved power: {result.achieved_power:.1%}\")\n</code></pre>"},{"location":"trial/#effect-size-and-sample-size-table","title":"Effect Size and Sample Size Table","text":"Cohen's d N per arm (80% power) N per arm (90% power) 0.2 (small) ~394 ~526 0.5 (medium) ~64 ~86 0.8 (large) ~26 ~34"},{"location":"trial/#alpha-spending-functions","title":"Alpha Spending Functions","text":"<pre><code>from openpkpd.trial import alpha_spending_function, incremental_alpha\n\n# At 50% information\nalpha_50 = alpha_spending_function(0.5, 0.05, \"obrien_fleming\")\nprint(f\"Cumulative alpha at 50%: {alpha_50:.4f}\")\n\n# Incremental alpha for multiple analyses\nfractions = [0.5, 0.75, 1.0]\nalphas = incremental_alpha(fractions, 0.05, \"obrien_fleming\")\nprint(f\"Alpha per analysis: {alphas}\")\n# Approximately: [0.0031, 0.0106, 0.0363]\n</code></pre>"},{"location":"trial/#arm-comparison","title":"Arm Comparison","text":"<pre><code>from openpkpd.trial import compare_arms\n\nactive_values = [12.5, 14.2, 11.8, 15.1, 13.0, 12.8, 14.5]\nplacebo_values = [10.2, 9.8, 11.1, 10.5, 9.5, 10.8, 10.0]\n\nresult = compare_arms(active_values, placebo_values, \"Active\", \"Placebo\")\n\nprint(f\"Difference: {result.difference:.2f}\")\nprint(f\"95% CI: [{result.ci_lower:.2f}, {result.ci_upper:.2f}]\")\nprint(f\"p-value: {result.p_value:.4f}\")\nprint(f\"Significant: {result.significant}\")\n</code></pre>"},{"location":"trial/#responder-analysis","title":"Responder Analysis","text":"<pre><code>from openpkpd.trial import responder_analysis\n\nvalues = [10.2, 15.5, 8.1, 12.3, 9.5, 14.2, 11.8, 13.0, 7.5, 16.0]\n\nresult = responder_analysis(\n    values,\n    threshold=10.0,\n    direction=\"greater\",  # Response if value &gt; threshold\n    confidence=0.95\n)\n\nprint(f\"Response rate: {result.response_rate:.1%}\")\nprint(f\"Responders: {result.n_responders}/{result.n_total}\")\nprint(f\"95% CI: [{result.ci_lower:.1%}, {result.ci_upper:.1%}]\")\n</code></pre>"},{"location":"trial/#bioequivalence-assessment","title":"Bioequivalence Assessment","text":"<pre><code>from openpkpd.trial import bioequivalence_90ci, assess_bioequivalence\n\ntest = [95.2, 102.1, 98.5, 105.3, 97.8, 100.2]\nref = [100.0, 98.5, 101.2, 99.8, 100.5, 97.2]\n\n# 90% CI\nlower, upper = bioequivalence_90ci(test, ref)\nprint(f\"90% CI: [{lower:.4f}, {upper:.4f}]\")\n\n# Full assessment\nresult = assess_bioequivalence(test, ref)\nprint(f\"GMR: {result['point_estimate']:.4f}\")\nprint(f\"Bioequivalent: {result['bioequivalent']}\")\n</code></pre>"},{"location":"trial/#complete-workflow-examples","title":"Complete Workflow Examples","text":""},{"location":"trial/#phase-i-dose-escalation","title":"Phase I Dose Escalation","text":"<pre><code>from openpkpd import trial\n\n# Design 3+3 escalation\ndose_levels = [10, 25, 50, 100, 200]\ndesign = trial.dose_escalation_3plus3(dose_levels)\n\nprint(f\"Starting at: {design.starting_dose} mg\")\nprint(f\"Cohort size: {design.cohort_size}\")\nprint(f\"Rule: {design.escalation_rule}\")\n\n# Create regimens for each dose level\nfor dose in dose_levels:\n    regimen = trial.dosing_qd(dose, 7)\n    print(f\"Dose {dose} mg: {trial.total_regimen_duration(regimen)} days\")\n</code></pre>"},{"location":"trial/#phase-ii-parallel-study-with-power-analysis","title":"Phase II Parallel Study with Power Analysis","text":"<pre><code>from openpkpd import trial\n\n# 1. Determine sample size\nsample_size = trial.estimate_sample_size(\n    target_power=0.80,\n    effect_size=0.5\n)\nn_per_arm = sample_size.n_per_arm\nprint(f\"Need {n_per_arm} per arm for 80% power\")\n\n# 2. Set up study\nspec = trial.TrialSpec(\n    name=\"Phase 2 Efficacy\",\n    design=trial.parallel_design(2),\n    arms=[\n        trial.TreatmentArm(\"Placebo\", trial.dosing_qd(0.0, 56), n_per_arm, placebo=True),\n        trial.TreatmentArm(\"Active\", trial.dosing_qd(100.0, 56), n_per_arm),\n    ],\n    duration_days=56,\n    dropout=trial.DropoutSpec(random_rate_per_day=0.002),\n    seed=42\n)\n\n# 3. Simulate multiple trials\nresults = trial.simulate_trial_replicates(spec, n_replicates=100)\n\n# 4. Analyze completion rates\ncompletion_rates = [r.overall_completion_rate for r in results]\nprint(f\"Mean completion: {sum(completion_rates)/len(completion_rates):.1%}\")\n</code></pre>"},{"location":"trial/#bioequivalence-study-simulation","title":"Bioequivalence Study Simulation","text":"<pre><code>from openpkpd import trial\nimport random\n\n# Design\ndesign = trial.bioequivalence_design(regulatory_guidance=\"fda\")\n\n# Generate virtual BE data (crossover)\nrandom.seed(42)\nn_subjects = 24\n\ntest_auc = [random.gauss(100, 15) for _ in range(n_subjects)]\nref_auc = [random.gauss(100, 15) for _ in range(n_subjects)]\n\ntest_cmax = [random.gauss(20, 4) for _ in range(n_subjects)]\nref_cmax = [random.gauss(20, 4) for _ in range(n_subjects)]\n\n# Assess BE for both parameters\nfor param, test_vals, ref_vals in [\n    (\"AUC\", test_auc, ref_auc),\n    (\"Cmax\", test_cmax, ref_cmax)\n]:\n    result = trial.assess_bioequivalence(test_vals, ref_vals)\n    print(f\"\\n{param}:\")\n    print(f\"  GMR: {result['point_estimate']:.4f}\")\n    print(f\"  90% CI: [{result['ci_90_lower']:.4f}, {result['ci_90_upper']:.4f}]\")\n    print(f\"  BE: {'Yes' if result['bioequivalent'] else 'No'}\")\n</code></pre>"},{"location":"trial/#see-also","title":"See Also","text":"<ul> <li>Models Reference - PK/PD model documentation</li> <li>NCA Reference - Non-compartmental analysis</li> <li>Visualization - Trial result plots</li> <li>Population Simulation - IIV and covariate modeling</li> </ul>"},{"location":"visualization/","title":"Visualization Reference","text":"<p>OpenPKPD provides comprehensive visualization capabilities for pharmacometric data using both Matplotlib (static) and Plotly (interactive) backends.</p>"},{"location":"visualization/#overview","title":"Overview","text":"<p>The visualization module includes:</p> <ul> <li>PK Plots: Concentration-time, spaghetti, mean with ribbon</li> <li>PKPD Plots: Effect-concentration, hysteresis, dose-response</li> <li>Population Plots: VPC, parameter distributions, forest plots, boxplots</li> <li>NCA Plots: Lambda-z fit, AUC visualization, dose proportionality</li> <li>Trial Plots: Power curves, tornado diagrams, Kaplan-Meier</li> </ul>"},{"location":"visualization/#quick-start","title":"Quick Start","text":"<pre><code>from openpkpd import viz\n\n# Set backend\nviz.set_backend(\"matplotlib\")  # or \"plotly\"\n\n# Basic concentration-time plot\nresult = openpkpd.simulate_pk_iv_bolus(cl=5.0, v=50.0, ...)\nviz.plot_conc_time(result)\n</code></pre>"},{"location":"visualization/#backend-selection","title":"Backend Selection","text":""},{"location":"visualization/#matplotlib-static","title":"Matplotlib (Static)","text":"<p>Best for publication-quality figures and reports.</p> <pre><code>from openpkpd import viz\n\nviz.set_backend(\"matplotlib\")\n\n# All plots return matplotlib Figure/Axes\nfig = viz.plot_conc_time(result)\nfig.savefig(\"pk_profile.png\", dpi=300)\n</code></pre>"},{"location":"visualization/#plotly-interactive","title":"Plotly (Interactive)","text":"<p>Best for data exploration and web applications.</p> <pre><code>viz.set_backend(\"plotly\")\n\n# All plots return Plotly Figure objects\nfig = viz.plot_conc_time(result)\nfig.show()  # Opens in browser\nfig.write_html(\"pk_profile.html\")\n</code></pre>"},{"location":"visualization/#backend-detection","title":"Backend Detection","text":"<pre><code>backend = viz.get_backend()\nprint(f\"Current backend: {backend}\")\n\nif viz.is_plotly_available():\n    viz.set_backend(\"plotly\")\n</code></pre>"},{"location":"visualization/#themes","title":"Themes","text":""},{"location":"visualization/#openpkpd-theme","title":"OpenPKPD Theme","text":"<p>Professional theme optimized for pharmacometric visualizations.</p> <pre><code>from openpkpd.viz import apply_openpkpd_theme, OPENPKPD_COLORS\n\napply_openpkpd_theme()  # Apply to all subsequent plots\n\n# Access color palette\nprint(OPENPKPD_COLORS)\n# {'primary': '#1f77b4', 'secondary': '#ff7f0e', 'tertiary': '#2ca02c', ...}\n</code></pre>"},{"location":"visualization/#color-palette","title":"Color Palette","text":"Name Hex Use Case primary #1f77b4 Main data series secondary #ff7f0e Comparison/reference tertiary #2ca02c Third series error #d62728 Errors/warnings highlight #9467bd Emphasis muted #7f7f7f Background/secondary"},{"location":"visualization/#pk-plots","title":"PK Plots","text":""},{"location":"visualization/#concentration-time-plot","title":"Concentration-Time Plot","text":"<pre><code>from openpkpd import viz\n\nfig = viz.plot_conc_time(\n    result,\n    log_scale=False,           # Linear or log y-axis\n    show_doses=True,           # Show dose markers\n    title=\"PK Profile\",\n    xlabel=\"Time (h)\",\n    ylabel=\"Concentration (mg/L)\"\n)\n</code></pre> <p>Options:</p> Parameter Type Default Description <code>log_scale</code> bool False Log-scale y-axis <code>show_doses</code> bool True Mark dose times <code>time_unit</code> str \"h\" Time unit for label <code>conc_unit</code> str \"mg/L\" Concentration unit"},{"location":"visualization/#spaghetti-plot-population","title":"Spaghetti Plot (Population)","text":"<p>Individual PK profiles overlaid.</p> <pre><code>fig = viz.plot_spaghetti(\n    pop_result,\n    n_subjects=None,     # None = all subjects\n    alpha=0.3,           # Line transparency\n    highlight_mean=True, # Show population mean\n    color_by=None        # Optional: 'sex', 'weight_group'\n)\n</code></pre>"},{"location":"visualization/#mean-with-confidence-ribbon","title":"Mean with Confidence Ribbon","text":"<pre><code>fig = viz.plot_mean_ribbon(\n    pop_result,\n    ci_levels=[0.05, 0.95],    # 90% CI\n    show_median=True,\n    show_individual=False,      # Overlay individual profiles\n    n_bootstrap=1000            # Bootstrap samples for CI\n)\n</code></pre>"},{"location":"visualization/#individual-fits","title":"Individual Fits","text":"<p>Grid of individual PK profiles for model validation.</p> <pre><code>fig = viz.plot_individual_fits(\n    pop_result,\n    observed_data=obs_df,    # DataFrame with observed data\n    n_cols=4,                # Number of columns in grid\n    n_subjects=16,           # Subjects to show\n    show_residuals=False     # Add residual subplot\n)\n</code></pre>"},{"location":"visualization/#pkpd-plots","title":"PKPD Plots","text":""},{"location":"visualization/#effect-concentration-plot","title":"Effect-Concentration Plot","text":"<pre><code>fig = viz.plot_effect_conc(\n    pkpd_result,\n    color_by_time=True,      # Color gradient by time\n    show_regression=True,    # Fit Emax curve\n    ec50_line=True          # Show EC50 reference\n)\n</code></pre>"},{"location":"visualization/#hysteresis-plot","title":"Hysteresis Plot","text":"<p>Visualize PK-PD temporal delay.</p> <pre><code>fig = viz.plot_hysteresis(\n    pkpd_result,\n    arrow_frequency=5,      # Arrows every 5 points\n    show_time_labels=True,  # Time annotations\n    absorption_color=\"blue\",\n    elimination_color=\"red\"\n)\n</code></pre> <p>Interpretation: - Clockwise loop: Effect lags concentration (indirect response) - Counter-clockwise loop: Effect precedes concentration (tolerance)</p>"},{"location":"visualization/#dose-response-curve","title":"Dose-Response Curve","text":"<pre><code># From multiple dose simulations\ndose_results = [simulate_at_dose(d) for d in [10, 25, 50, 100, 200]]\ndoses = [10, 25, 50, 100, 200]\n\nfig = viz.plot_dose_response(\n    dose_results,\n    doses,\n    endpoint=\"effect\",\n    fit_model=\"emax\",       # \"emax\", \"emax_hill\", \"linear\", \"log_linear\"\n    show_ci=True,\n    ed50_line=True\n)\n</code></pre>"},{"location":"visualization/#population-plots","title":"Population Plots","text":""},{"location":"visualization/#visual-predictive-check-vpc","title":"Visual Predictive Check (VPC)","text":"<p>Standard validation plot for population models.</p> <pre><code>fig = viz.plot_vpc(\n    sim_results,                    # List of simulation results\n    observed_data=obs_df,          # Observed data DataFrame\n    prediction_intervals=[0.05, 0.50, 0.95],\n    bin_method=\"equal_n\",          # \"equal_n\", \"equal_width\", \"optimal\"\n    n_bins=10,\n    show_ci=True,\n    log_scale=False\n)\n</code></pre> <p>VPC Elements:</p> Element Description Shaded regions Predicted PI (5th, 50th, 95th) Lines Observed PI Points Individual observations"},{"location":"visualization/#parameter-distributions","title":"Parameter Distributions","text":"<pre><code># Histogram of population parameters\nfig = viz.plot_parameter_distributions(\n    pop_result,\n    parameters=[\"CL\", \"V\", \"Ka\"],\n    plot_type=\"histogram\",    # \"histogram\", \"kde\", \"violin\"\n    n_cols=3,\n    show_typical=True,        # Mark typical values\n    log_scale=False\n)\n</code></pre>"},{"location":"visualization/#forest-plot","title":"Forest Plot","text":"<p>For meta-analysis or subgroup effects.</p> <pre><code>effects = [\n    {\"group\": \"Overall\", \"estimate\": 1.0, \"ci_lower\": 0.85, \"ci_upper\": 1.18},\n    {\"group\": \"Age &lt;65\", \"estimate\": 0.92, \"ci_lower\": 0.75, \"ci_upper\": 1.12},\n    {\"group\": \"Age &gt;=65\", \"estimate\": 1.15, \"ci_lower\": 0.90, \"ci_upper\": 1.47},\n    {\"group\": \"Male\", \"estimate\": 0.98, \"ci_lower\": 0.80, \"ci_upper\": 1.20},\n    {\"group\": \"Female\", \"estimate\": 1.05, \"ci_lower\": 0.85, \"ci_upper\": 1.30},\n]\n\nfig = viz.plot_forest(\n    effects,\n    reference_line=1.0,\n    show_weights=True,\n    diamond_for_overall=True\n)\n</code></pre>"},{"location":"visualization/#boxplot-violin-plot","title":"Boxplot / Violin Plot","text":"<p>Compare distributions across groups.</p> <pre><code>fig = viz.plot_boxplot(\n    pop_result,\n    groups=[\"treatment\", \"sex\"],\n    metric=\"cmax\",              # \"cmax\", \"auc\", \"cl\"\n    violin=False,               # True for violin plot\n    show_points=True,           # Overlay individual points\n    show_means=True\n)\n</code></pre>"},{"location":"visualization/#nca-plots","title":"NCA Plots","text":""},{"location":"visualization/#lambda-z-fit-visualization","title":"Lambda-z Fit Visualization","text":"<pre><code>from openpkpd import viz\n\nfig = viz.plot_lambda_z_fit(\n    nca_result,\n    times,\n    conc,\n    show_excluded=True,      # Show points not used in fit\n    show_equation=True,      # Display regression equation\n    show_r2=True            # Show R\u00b2 value\n)\n</code></pre>"},{"location":"visualization/#auc-visualization","title":"AUC Visualization","text":"<pre><code>fig = viz.plot_auc_visualization(\n    times,\n    conc,\n    nca_result,\n    show_extrapolation=True,   # Show AUC extrapolated portion\n    fill_alpha=0.3,\n    method=\"lin_log_mixed\"\n)\n</code></pre>"},{"location":"visualization/#dose-proportionality","title":"Dose Proportionality","text":"<pre><code># NCA results at multiple doses\nnca_results = [run_nca(t, c, d) for d in doses]\ndoses = [10, 25, 50, 100]\n\nfig = viz.plot_dose_proportionality(\n    nca_results,\n    doses,\n    metric=\"auc\",           # \"auc\", \"cmax\", \"cl_f\"\n    power_model=True,       # Fit power model\n    log_scale=True,\n    show_reference=True     # Proportionality reference line\n)\n</code></pre> <p>Dose Proportionality Assessment:</p> Slope (log-log) Interpretation ~1.0 Dose proportional &lt;1.0 Less than proportional &gt;1.0 Greater than proportional"},{"location":"visualization/#trial-plots","title":"Trial Plots","text":""},{"location":"visualization/#power-curve","title":"Power Curve","text":"<pre><code># Power at different sample sizes\nsample_sizes = [20, 30, 40, 50, 60, 80, 100]\npowers = [estimate_power(n=n, effect_size=0.5).power for n in sample_sizes]\n\nfig = viz.plot_power_curve(\n    sample_sizes,\n    powers,\n    target_power=0.80,\n    target_n=None,           # Highlight specific N\n    show_80_line=True,\n    show_90_line=True\n)\n</code></pre>"},{"location":"visualization/#tornado-diagram-sensitivity","title":"Tornado Diagram (Sensitivity)","text":"<pre><code>sensitivity_results = [\n    {\"parameter\": \"CL\", \"low\": 0.85, \"high\": 1.20},\n    {\"parameter\": \"V\", \"low\": 0.90, \"high\": 1.15},\n    {\"parameter\": \"Ka\", \"low\": 0.95, \"high\": 1.08},\n    {\"parameter\": \"F\", \"low\": 0.75, \"high\": 1.30},\n]\n\nfig = viz.plot_tornado(\n    sensitivity_results,\n    baseline_value=1.0,\n    sort_by_range=True,\n    show_values=True,\n    symmetric_axis=True\n)\n</code></pre>"},{"location":"visualization/#kaplan-meier-survival-curve","title":"Kaplan-Meier Survival Curve","text":"<pre><code># Time-to-event data\ntime_to_event = [10, 15, 22, 30, 45, 60, 90, 120, 150, 180]\nevent_occurred = [1, 1, 1, 0, 1, 0, 1, 0, 0, 0]  # 1=event, 0=censored\ngroups = [\"A\", \"A\", \"A\", \"A\", \"A\", \"B\", \"B\", \"B\", \"B\", \"B\"]\n\nfig = viz.plot_kaplan_meier(\n    time_to_event,\n    event_occurred,\n    groups=groups,\n    ci=0.95,\n    show_censored=True,\n    show_median=True,\n    show_at_risk=True        # Number at risk table\n)\n</code></pre>"},{"location":"visualization/#endpoint-distribution-by-arm","title":"Endpoint Distribution by Arm","text":"<pre><code>fig = viz.plot_endpoint_distribution(\n    trial_result,\n    endpoint=\"pk_exposure\",\n    by_arm=True,\n    plot_type=\"violin\",      # \"histogram\", \"kde\", \"violin\", \"box\"\n    show_stats=True\n)\n</code></pre>"},{"location":"visualization/#plot-customization","title":"Plot Customization","text":""},{"location":"visualization/#figure-size-and-dpi","title":"Figure Size and DPI","text":"<pre><code># Matplotlib\nfig = viz.plot_conc_time(result, figsize=(10, 6), dpi=150)\n\n# Plotly\nfig = viz.plot_conc_time(result, width=800, height=600)\n</code></pre>"},{"location":"visualization/#adding-annotations","title":"Adding Annotations","text":"<pre><code>import matplotlib.pyplot as plt\n\nfig = viz.plot_conc_time(result)\nax = fig.axes[0]\n\n# Add annotations\nax.axhline(y=1.0, color='red', linestyle='--', label='Target')\nax.annotate('Cmax', xy=(2, 1.62), xytext=(3, 1.8),\n            arrowprops=dict(arrowstyle='-&gt;'))\nax.legend()\n\nplt.tight_layout()\n</code></pre>"},{"location":"visualization/#multi-panel-figures","title":"Multi-Panel Figures","text":"<pre><code>import matplotlib.pyplot as plt\n\nfig, axes = plt.subplots(2, 2, figsize=(12, 10))\n\n# Plot to each axis\nviz.plot_conc_time(result1, ax=axes[0, 0], title=\"Subject 1\")\nviz.plot_conc_time(result2, ax=axes[0, 1], title=\"Subject 2\")\nviz.plot_effect_conc(result1, ax=axes[1, 0], title=\"PKPD\")\nviz.plot_hysteresis(result1, ax=axes[1, 1], title=\"Hysteresis\")\n\nplt.tight_layout()\nplt.savefig(\"multi_panel.png\", dpi=300)\n</code></pre>"},{"location":"visualization/#saving-plots","title":"Saving Plots","text":""},{"location":"visualization/#matplotlib","title":"Matplotlib","text":"<pre><code>fig = viz.plot_conc_time(result)\n\n# PNG (raster)\nfig.savefig(\"plot.png\", dpi=300, bbox_inches='tight')\n\n# SVG (vector)\nfig.savefig(\"plot.svg\", format='svg', bbox_inches='tight')\n\n# PDF (publication)\nfig.savefig(\"plot.pdf\", format='pdf', bbox_inches='tight')\n</code></pre>"},{"location":"visualization/#plotly","title":"Plotly","text":"<pre><code>fig = viz.plot_conc_time(result)\n\n# Interactive HTML\nfig.write_html(\"plot.html\")\n\n# Static image (requires kaleido)\nfig.write_image(\"plot.png\", scale=2)\nfig.write_image(\"plot.svg\")\nfig.write_image(\"plot.pdf\")\n\n# JSON (for web apps)\nfig.write_json(\"plot.json\")\n</code></pre>"},{"location":"visualization/#common-workflows","title":"Common Workflows","text":""},{"location":"visualization/#publication-ready-pk-figure","title":"Publication-Ready PK Figure","text":"<pre><code>from openpkpd import viz\nimport matplotlib.pyplot as plt\n\nviz.set_backend(\"matplotlib\")\nviz.apply_openpkpd_theme()\n\n# Create figure\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))\n\n# Linear scale\nviz.plot_conc_time(result, ax=ax1, log_scale=False)\nax1.set_title(\"A) Linear Scale\")\n\n# Log scale\nviz.plot_conc_time(result, ax=ax2, log_scale=True)\nax2.set_title(\"B) Semi-log Scale\")\n\nplt.tight_layout()\nfig.savefig(\"pk_figure.pdf\", format='pdf', dpi=300)\n</code></pre>"},{"location":"visualization/#interactive-dashboard-plot","title":"Interactive Dashboard Plot","text":"<pre><code>viz.set_backend(\"plotly\")\n\nfig = viz.plot_spaghetti(pop_result, alpha=0.5)\n\n# Add dropdown for log scale\nfig.update_layout(\n    updatemenus=[\n        dict(\n            type=\"buttons\",\n            buttons=[\n                dict(label=\"Linear\", method=\"relayout\",\n                     args=[{\"yaxis.type\": \"linear\"}]),\n                dict(label=\"Log\", method=\"relayout\",\n                     args=[{\"yaxis.type\": \"log\"}]),\n            ],\n        )\n    ]\n)\n\nfig.write_html(\"interactive_pk.html\")\n</code></pre>"},{"location":"visualization/#trial-report-figures","title":"Trial Report Figures","text":"<pre><code>from openpkpd import viz, trial\nimport matplotlib.pyplot as plt\n\n# Run trial simulation\nspec = trial.TrialSpec(...)\nresult = trial.simulate_trial(spec)\n\n# Create report figure\nfig = plt.figure(figsize=(14, 10))\n\n# Sample size vs power\nax1 = fig.add_subplot(2, 2, 1)\nviz.plot_power_curve(sample_sizes, powers, ax=ax1)\nax1.set_title(\"Power Analysis\")\n\n# Completion by arm\nax2 = fig.add_subplot(2, 2, 2)\narms = list(result.arms.keys())\ncompletion = [result.arms[a].completion_rate for a in arms]\nax2.bar(arms, completion)\nax2.set_ylabel(\"Completion Rate\")\nax2.set_title(\"Study Completion\")\n\n# Endpoint distribution\nax3 = fig.add_subplot(2, 2, 3)\nviz.plot_endpoint_distribution(result, ax=ax3)\nax3.set_title(\"Endpoint Distribution\")\n\n# Forest plot\nax4 = fig.add_subplot(2, 2, 4)\nviz.plot_forest(effects, ax=ax4)\nax4.set_title(\"Subgroup Analysis\")\n\nplt.tight_layout()\nfig.savefig(\"trial_report.pdf\", dpi=300)\n</code></pre>"},{"location":"visualization/#troubleshooting","title":"Troubleshooting","text":""},{"location":"visualization/#common-issues","title":"Common Issues","text":"Issue Solution Plot not showing Call <code>plt.show()</code> or <code>fig.show()</code> Fonts not embedding in PDF Use <code>fig.savefig(..., fonttype=42)</code> Plotly images not exporting Install <code>kaleido</code>: <code>pip install kaleido</code> Legend overlapping Use <code>loc='best'</code> or <code>bbox_to_anchor</code> Axis labels cut off Use <code>bbox_inches='tight'</code> when saving"},{"location":"visualization/#performance-tips","title":"Performance Tips","text":"<pre><code># For large datasets, use rasterization\nax.set_rasterization_zorder(0)\n\n# Reduce Plotly file size\nfig.write_html(\"plot.html\", include_plotlyjs='cdn')\n\n# Sample data for quick previews\nviz.plot_spaghetti(pop_result, n_subjects=50)\n</code></pre>"},{"location":"visualization/#see-also","title":"See Also","text":"<ul> <li>Models Reference - PK/PD models</li> <li>NCA Reference - NCA calculations</li> <li>Trial Reference - Trial simulation</li> <li>Population - Population variability</li> </ul>"},{"location":"vpc/","title":"Visual Predictive Checks (VPC)","text":"<p>Visual Predictive Checks (VPC) are a model evaluation tool that compares observed data to model predictions. OpenPKPD supports standard VPC, prediction-corrected VPC (pcVPC), stratification, and bootstrap confidence intervals.</p>"},{"location":"vpc/#overview","title":"Overview","text":"<p>A VPC compares: - Observed data percentiles (e.g., 5th, 50th, 95th) computed from actual observations - Simulated percentiles from model-based population simulations</p> <p>If the model adequately describes the data, observed percentiles should fall within the confidence intervals of simulated percentiles.</p>"},{"location":"vpc/#basic-usage","title":"Basic Usage","text":""},{"location":"vpc/#julia","title":"Julia","text":"<pre><code>using OpenPKPDCore\n\n# Define VPC configuration\nvpc_config = VPCConfig(\n    pi_levels=[0.05, 0.50, 0.95],   # Prediction interval levels\n    ci_level=0.95,                   # Confidence interval for percentiles\n    binning=QuantileBinning(n_bins=10),\n    prediction_corrected=false,\n    stratify_by=Symbol[],\n    lloq=nothing,                    # Lower limit of quantification\n    n_bootstrap=500,\n    seed=UInt64(12345)\n)\n\n# Compute VPC\nvpc_result = compute_vpc(\n    observed_data,    # ObservedData struct\n    pop_spec,         # PopulationSpec with model\n    grid,             # SimGrid\n    solver;           # SolverSpec\n    config=vpc_config,\n    error_spec=residual_error_spec  # Optional residual error\n)\n</code></pre>"},{"location":"vpc/#python","title":"Python","text":"<pre><code>from openpkpd.analysis import compute_vpc, VPCConfig\n\nconfig = VPCConfig(\n    pi_levels=[0.05, 0.50, 0.95],\n    ci_level=0.95,\n    n_bins=10,\n    binning_strategy=\"quantile\",\n    prediction_corrected=False,\n    n_bootstrap=500,\n    seed=12345\n)\n\nvpc_result = compute_vpc(\n    observed_data,\n    pop_spec,\n    grid,\n    solver,\n    config=config\n)\n\n# Visualize\nfrom openpkpd import viz\nviz.plot_vpc(vpc_result)\n</code></pre>"},{"location":"vpc/#configuration-options","title":"Configuration Options","text":""},{"location":"vpc/#prediction-intervals","title":"Prediction Intervals","text":"<pre><code>config = VPCConfig(\n    pi_levels=[0.05, 0.50, 0.95]  # 5th, 50th, 95th percentiles\n)\n</code></pre> <p>Common choices: - <code>[0.05, 0.50, 0.95]</code> - Standard 90% prediction interval - <code>[0.10, 0.50, 0.90]</code> - 80% prediction interval - <code>[0.025, 0.50, 0.975]</code> - 95% prediction interval</p>"},{"location":"vpc/#confidence-intervals","title":"Confidence Intervals","text":"<pre><code>config = VPCConfig(\n    ci_level=0.95,      # 95% CI for percentiles\n    n_bootstrap=500     # Number of bootstrap samples\n)\n</code></pre> <p>Higher <code>n_bootstrap</code> gives more stable CIs but increases computation time.</p>"},{"location":"vpc/#binning-strategies","title":"Binning Strategies","text":""},{"location":"vpc/#quantile-binning-default","title":"Quantile Binning (Default)","text":"<p>Bins have equal numbers of observations.</p> <pre><code>binning = QuantileBinning(n_bins=10)\n</code></pre>"},{"location":"vpc/#equal-width-binning","title":"Equal Width Binning","text":"<p>Bins have equal time width.</p> <pre><code>binning = EqualWidthBinning(n_bins=10)\n</code></pre>"},{"location":"vpc/#custom-bins","title":"Custom Bins","text":"<pre><code>config = VPCConfig(\n    binning_strategy=\"custom\",\n    bin_edges=[0, 1, 2, 4, 8, 12, 24]\n)\n</code></pre>"},{"location":"vpc/#lower-limit-of-quantification-lloq","title":"Lower Limit of Quantification (LLOQ)","text":"<p>Handle BLQ (below limit of quantification) data:</p> <pre><code>config = VPCConfig(\n    lloq=0.1  # Values below 0.1 are BLQ\n)\n</code></pre>"},{"location":"vpc/#prediction-corrected-vpc-pcvpc","title":"Prediction-Corrected VPC (pcVPC)","text":"<p>pcVPC normalizes observations and predictions to account for design differences (e.g., different doses, times). This is especially useful for sparse data or studies with varying protocols.</p>"},{"location":"vpc/#how-pcvpc-works","title":"How pcVPC Works","text":"<ol> <li>For each bin, compute the typical prediction (median of simulated data)</li> <li>Normalize observations: <code>obs_corrected = obs * median_pred / pred</code></li> <li>Compute percentiles on corrected data</li> </ol>"},{"location":"vpc/#usage","title":"Usage","text":"<pre><code>vpc_config = VPCConfig(\n    pi_levels=[0.05, 0.50, 0.95],\n    ci_level=0.95,\n    binning=QuantileBinning(n_bins=10),\n    prediction_corrected=true,  # Enable pcVPC\n    n_bootstrap=500,\n    seed=UInt64(12345)\n)\n</code></pre> <pre><code>config = VPCConfig(\n    prediction_corrected=True\n)\n</code></pre>"},{"location":"vpc/#stratification","title":"Stratification","text":"<p>Stratify VPC by categorical covariates (e.g., study, dose group, formulation):</p> <pre><code>vpc_config = VPCConfig(\n    stratify_by=[:STUDY, :DOSE_GRP],\n    # ... other settings\n)\n</code></pre> <pre><code>config = VPCConfig(\n    stratify_by=[\"STUDY\", \"DOSE_GRP\"]\n)\n</code></pre> <p>This produces separate VPC panels for each stratum.</p>"},{"location":"vpc/#vpc-result-structure","title":"VPC Result Structure","text":"<p>The <code>VPCResult</code> contains:</p> Field Description <code>config</code> VPC configuration used <code>bins</code> List of VPCBin objects <code>observed_data</code> Original observed data <code>n_simulations</code> Number of simulated datasets <p>Each <code>VPCBin</code> contains:</p> Field Description <code>time_lower</code> Bin lower time bound <code>time_upper</code> Bin upper time bound <code>time_median</code> Median time in bin <code>obs_percentiles</code> Observed data percentiles <code>sim_percentiles</code> Simulated percentiles (median) <code>sim_ci_lower</code> Lower CI for simulated percentiles <code>sim_ci_upper</code> Upper CI for simulated percentiles <code>n_obs</code> Number of observations in bin"},{"location":"vpc/#visualization","title":"Visualization","text":""},{"location":"vpc/#standard-vpc-plot","title":"Standard VPC Plot","text":"<pre><code>from openpkpd import viz\n\nfig = viz.plot_vpc(\n    vpc_result,\n    log_scale=False,\n    title=\"Visual Predictive Check\",\n    xlabel=\"Time (h)\",\n    ylabel=\"Concentration (mg/L)\",\n    figsize=(10, 6)\n)\n</code></pre>"},{"location":"vpc/#vpc-from-dict-legacy","title":"VPC from Dict (Legacy)","text":"<pre><code># For VPC results returned as dicts\nfig = viz.plot_vpc(vpc_dict)\n</code></pre>"},{"location":"vpc/#customization","title":"Customization","text":"<pre><code>fig = viz.plot_vpc(\n    vpc_result,\n    show_observed=True,      # Show observed points\n    show_pi=True,            # Show prediction intervals\n    show_ci=True,            # Show confidence intervals\n    obs_alpha=0.3,           # Observed point transparency\n    ci_alpha=0.2,            # CI ribbon transparency\n    colors={\n        \"obs\": \"black\",\n        \"median\": \"blue\",\n        \"pi\": \"lightblue\",\n        \"ci\": \"lightgray\"\n    }\n)\n</code></pre>"},{"location":"vpc/#cli-usage","title":"CLI Usage","text":"<pre><code>./packages/cli/bin/openpkpd vpc --spec vpc_spec.json --out vpc_result.json\n</code></pre> <p>Specification Format: <pre><code>{\n  \"observed_data\": \"observed.csv\",\n  \"population_spec\": {\n    \"base_model\": {\n      \"kind\": \"OneCompIVBolus\",\n      \"params\": {\"CL\": 5.0, \"V\": 50.0},\n      \"doses\": [{\"time\": 0.0, \"amount\": 100.0}]\n    },\n    \"iiv\": {\n      \"kind\": \"LogNormalIIV\",\n      \"omegas\": {\"CL\": 0.3, \"V\": 0.2},\n      \"n\": 1000\n    }\n  },\n  \"config\": {\n    \"pi_levels\": [0.05, 0.50, 0.95],\n    \"ci_level\": 0.95,\n    \"binning\": {\n      \"strategy\": \"quantile\",\n      \"n_bins\": 10\n    },\n    \"prediction_corrected\": false,\n    \"lloq\": null,\n    \"n_bootstrap\": 500,\n    \"seed\": 12345\n  },\n  \"error_spec\": {\n    \"kind\": \"proportional\",\n    \"sigma\": 0.1\n  },\n  \"grid\": {\n    \"t0\": 0.0,\n    \"t1\": 24.0,\n    \"saveat\": [0, 0.5, 1, 2, 4, 8, 12, 24]\n  },\n  \"solver\": {\n    \"alg\": \"Tsit5\",\n    \"reltol\": 1e-8,\n    \"abstol\": 1e-10\n  }\n}\n</code></pre></p>"},{"location":"vpc/#interpreting-vpc-results","title":"Interpreting VPC Results","text":""},{"location":"vpc/#good-model-fit","title":"Good Model Fit","text":"<ul> <li>Observed percentiles (lines) fall within simulated CIs (ribbons)</li> <li>Median observed data follows median simulated data</li> <li>No systematic trends in deviations</li> </ul>"},{"location":"vpc/#signs-of-misspecification","title":"Signs of Misspecification","text":"Pattern Possible Issue Observed median below simulated Model overpredicts Observed PI outside simulated PI Variability underestimated Trend in residuals Structural model issue Time-dependent bias Absorption/elimination misspecified"},{"location":"vpc/#tips-and-best-practices","title":"Tips and Best Practices","text":"<ol> <li> <p>Sample Size: Use at least 500-1000 simulations for stable percentiles</p> </li> <li> <p>Binning: Use quantile binning when observation times vary; use equal-width when times are similar</p> </li> <li> <p>pcVPC: Use for studies with multiple doses or varying protocols</p> </li> <li> <p>Stratification: Stratify when you suspect different subpopulations behave differently</p> </li> <li> <p>LLOQ: Always specify LLOQ if your data has BLQ observations</p> </li> <li> <p>Residual Error: Include residual error for realistic variability</p> </li> </ol>"},{"location":"vpc/#see-also","title":"See Also","text":"<ul> <li>Parameter Estimation - Fitting models to data</li> <li>Population Simulation - Running population simulations</li> <li>Visualization - Plotting functions</li> </ul>"},{"location":"examples/","title":"OpenPKPD Examples","text":"<p>Comprehensive examples covering all OpenPKPD features across Julia, Python, and CLI interfaces.</p>"},{"location":"examples/#quick-navigation","title":"Quick Navigation","text":"Category Description Languages Quickstart Get started in 5 minutes Julia, Python, CLI Models All 12 PK/PD models Julia, Python, CLI Population IIV, IOV, covariates Julia, Python, CLI Estimation FOCE-I, SAEM, diagnostics Julia, Python NCA Non-compartmental analysis Julia, Python VPC Visual Predictive Checks Julia, Python, CLI Trial Clinical trial simulation Julia, Python, CLI Import NONMEM/Monolix import Julia, Python, CLI Data CDISC data import Julia, Python Visualization Plotting and figures Python Sensitivity Parameter sensitivity Julia, Python, CLI Reproducibility Artifacts and replay Julia, Python, CLI"},{"location":"examples/#end-to-end-use-cases","title":"End-to-End Use Cases","text":"<p>Complete workflows from data to analysis:</p> Use Case Description FIH Dose Exploration First-in-human dose selection PKPD Biomarker Biomarker turnover modeling NONMEM Migration Migrate NONMEM models to OpenPKPD Theophylline Analysis Real-world PK analysis Bioequivalence Study Complete BE workflow Population PKPD Full population analysis"},{"location":"examples/#real-world-validation","title":"Real-World Validation","text":"<p>Validation against published datasets:</p> Study Dataset Features Theophylline SD Single dose PK NCA, estimation Theophylline MD Multiple dose PK Population, VPC Warfarin PKPD PK/PD model Indirect response"},{"location":"examples/#quickstart","title":"Quickstart","text":""},{"location":"examples/#julia-5-minutes","title":"Julia (5 minutes)","text":"<pre><code>using OpenPKPDCore\n\n# Create a one-compartment IV bolus model\nmodel = create_model_spec(\"OneCompIVBolus\",\n    params = Dict(\"CL\" =&gt; 5.0, \"V\" =&gt; 50.0),\n    doses = [DoseEvent(time=0.0, amount=100.0)]\n)\n\n# Simulate\ngrid = SimulationGrid(t0=0.0, t1=24.0, saveat=0:0.5:24)\nresult = simulate(model, grid)\n\n# Extract metrics\nprintln(\"Cmax: \", maximum(result.observations[\"conc\"]))\n</code></pre>"},{"location":"examples/#python-5-minutes","title":"Python (5 minutes)","text":"<pre><code>from openpkpd import simulate, create_model_spec\n\n# Create model\nmodel = create_model_spec(\"OneCompIVBolus\",\n    params={\"CL\": 5.0, \"V\": 50.0},\n    doses=[{\"time\": 0.0, \"amount\": 100.0}]\n)\n\n# Simulate\nresult = simulate(model, t_end=24.0, saveat=0.5)\n\n# Extract metrics\nprint(f\"Cmax: {max(result['observations']['conc'])}\")\n</code></pre>"},{"location":"examples/#cli-5-minutes","title":"CLI (5 minutes)","text":"<pre><code># Run simulation\n./bin/openpkpd simulate --spec quickstart/spec.json --out result.json\n\n# Compute metrics\n./bin/openpkpd metrics --artifact result.json --metrics cmax,tmax,auc\n</code></pre>"},{"location":"examples/#models-reference","title":"Models Reference","text":""},{"location":"examples/#pk-models","title":"PK Models","text":"Model Compartments Administration Key Parameters OneCompIVBolus 1 IV Bolus CL, V OneCompIVInfusion 1 IV Infusion CL, V, duration OneCompOralFirstOrder 1 Oral Ka, CL, V TwoCompIVBolus 2 IV Bolus CL, V1, Q, V2 TwoCompOral 2 Oral Ka, CL, V1, Q, V2 ThreeCompIVBolus 3 IV Bolus CL, V1, Q2, V2, Q3, V3 TransitAbsorption 1 + transit Oral Ktr, n, CL, V MichaelisMentenElimination 1 IV Vmax, Km, V"},{"location":"examples/#pkpd-models","title":"PKPD Models","text":"Model Response Type Key Parameters DirectEmax Direct effect Emax, EC50, E0 SigmoidEmax Sigmoidal Emax, EC50, gamma, E0 BiophaseEquilibration Effect compartment Emax, EC50, Ke0 IndirectResponse Turnover Kin, Kout, Imax/Smax, IC50/SC50"},{"location":"examples/#population-modeling","title":"Population Modeling","text":""},{"location":"examples/#iiv-inter-individual-variability","title":"IIV (Inter-Individual Variability)","text":"<pre><code># Log-normal IIV on CL and V\npop_spec = create_population_spec(\n    base_model = model,\n    iiv = LogNormalIIV(\n        omegas = Dict(\"CL\" =&gt; 0.3, \"V\" =&gt; 0.2),\n        seed = 12345\n    ),\n    n = 100\n)\nresult = simulate_population(pop_spec, grid)\n</code></pre>"},{"location":"examples/#covariates","title":"Covariates","text":"<pre><code># Weight-based allometric scaling\ncovariate_model = create_covariate_model(\n    effects = [\n        CovariateEffect(:WT, :CL, :power, exponent=0.75, reference=70.0),\n        CovariateEffect(:WT, :V, :power, exponent=1.0, reference=70.0)\n    ]\n)\n</code></pre>"},{"location":"examples/#feature-examples","title":"Feature Examples","text":""},{"location":"examples/#parameter-estimation-foce-i","title":"Parameter Estimation (FOCE-I)","text":"<pre><code># Estimate parameters from observed data\nconfig = EstimationConfig(\n    method = FOCEI(),\n    theta_init = [5.0, 50.0, 1.5],\n    theta_lower = [0.1, 1.0, 0.1],\n    theta_upper = [100.0, 500.0, 10.0],\n    omega_init = [0.09, 0.04, 0.16]\n)\nresult = estimate(observed_data, model_spec, config)\n</code></pre>"},{"location":"examples/#visual-predictive-check-vpc","title":"Visual Predictive Check (VPC)","text":"<pre><code># Generate VPC\nvpc_result = compute_vpc(\n    observed_data,\n    pop_spec,\n    n_simulations = 500,\n    quantiles = [0.05, 0.5, 0.95]\n)\n</code></pre>"},{"location":"examples/#non-compartmental-analysis-nca","title":"Non-Compartmental Analysis (NCA)","text":"<pre><code># Compute NCA metrics\nnca_result = compute_nca(\n    times = observed_times,\n    concentrations = observed_conc,\n    dose = 100.0,\n    route = :oral\n)\n# Returns: Cmax, Tmax, AUC_0_t, AUC_0_inf, t_half, CL_F, Vz_F\n</code></pre>"},{"location":"examples/#trial-simulation","title":"Trial Simulation","text":"<pre><code># Simulate bioequivalence study\ntrial_spec = TrialSpec(\n    design = CrossoverDesign(periods=2, sequences=2, washout=7),\n    arm_specs = [\n        ArmSpec(treatment=\"Reference\", n=12),\n        ArmSpec(treatment=\"Test\", n=12)\n    ],\n    endpoints = [BioequivalenceEndpoint(metric=:AUC, acceptance=[0.8, 1.25])]\n)\nresult = simulate_trial(trial_spec, model_spec)\n</code></pre>"},{"location":"examples/#directory-structure","title":"Directory Structure","text":"<pre><code>docs/examples/\n\u251c\u2500\u2500 README.md                    # This file\n\u251c\u2500\u2500 quickstart/                  # Getting started\n\u251c\u2500\u2500 models/                      # All PK/PD models\n\u2502   \u251c\u2500\u2500 pk/                      # PK models (8)\n\u2502   \u2514\u2500\u2500 pkpd/                    # PKPD models (4)\n\u251c\u2500\u2500 population/                  # Population modeling\n\u251c\u2500\u2500 estimation/                  # Parameter estimation\n\u251c\u2500\u2500 nca/                         # Non-compartmental analysis\n\u251c\u2500\u2500 vpc/                         # Visual Predictive Checks\n\u251c\u2500\u2500 trial/                       # Trial simulation\n\u251c\u2500\u2500 import/                      # Model import\n\u2502   \u251c\u2500\u2500 nonmem/                  # NONMEM import\n\u2502   \u2514\u2500\u2500 monolix/                 # Monolix import\n\u251c\u2500\u2500 data/                        # Data import\n\u2502   \u2514\u2500\u2500 cdisc/                   # CDISC format\n\u251c\u2500\u2500 visualization/               # Plotting\n\u251c\u2500\u2500 sensitivity/                 # Sensitivity analysis\n\u251c\u2500\u2500 reproducibility/             # Artifacts and replay\n\u251c\u2500\u2500 use_cases/                   # End-to-end workflows\n\u2514\u2500\u2500 real_world_validation/       # Published datasets\n</code></pre>"},{"location":"examples/#running-examples","title":"Running Examples","text":""},{"location":"examples/#run-all-examples","title":"Run All Examples","text":"<pre><code># Run all example validation\n./docs/examples/run_all.sh\n\n# Run specific category\njulia --project=core/OpenPKPDCore docs/examples/models/run_all.jl\npython docs/examples/estimation/run_all.py\n</code></pre>"},{"location":"examples/#validate-outputs","title":"Validate Outputs","text":"<pre><code># Validate against expected outputs\njulia --project=core/OpenPKPDCore docs/examples/validate_outputs.jl\n</code></pre>"},{"location":"examples/#contributing-examples","title":"Contributing Examples","text":"<ol> <li>Each example should be in its own directory</li> <li>Include Julia, Python, and CLI versions where applicable</li> <li>Add expected output files for CI validation</li> <li>Include a README.md explaining the example</li> <li>Follow the naming convention: <code>01_descriptive_name/</code></li> </ol> <p>See the CONTRIBUTING guide for guidelines.</p>"},{"location":"examples/data/","title":"Data Import Examples","text":"<p>Examples demonstrating import of clinical data in CDISC and custom formats.</p>"},{"location":"examples/data/#cdisc-domains","title":"CDISC Domains","text":"Domain Description Use PC Pharmacokinetic Concentrations Observed PK data EX Exposure Dosing records DM Demographics Subject characteristics VS Vital Signs Covariates (weight, etc.) LB Lab Results Biomarkers, renal function"},{"location":"examples/data/#examples","title":"Examples","text":"Example Description Directory Basic PC/EX Standard PK data import 01_basic_pc_ex With Infusion Infusion data from EXDUR 02_with_infusion XPT Format SAS transport files 03_xpt_format"},{"location":"examples/data/#basic-usage","title":"Basic Usage","text":"<pre><code>from openpkpd.data import load_cdisc\n\n# Load from CSV files\ndata = load_cdisc(\n    pc=\"pc.csv\",\n    ex=\"ex.csv\",\n    dm=\"dm.csv\"\n)\n\n# Access as OpenPKPD format\nprint(f\"Subjects: {len(data.subjects)}\")\nprint(f\"Observations: {len(data.observations)}\")\nprint(f\"Doses: {len(data.doses)}\")\n</code></pre>"},{"location":"examples/data/#cdisc-to-openpkpd-mapping","title":"CDISC to OpenPKPD Mapping","text":""},{"location":"examples/data/#pc-domain","title":"PC Domain","text":"CDISC Variable OpenPKPD USUBJID subject_id PCTPTNUM / PCELTM time PCSTRESN dv PCSPEC compartment PCLLOQ lloq"},{"location":"examples/data/#ex-domain","title":"EX Domain","text":"CDISC Variable OpenPKPD USUBJID subject_id EXSTDTC + EXSTTM dose_time EXDOSE amount EXDUR duration (for infusion) EXROUTE route"},{"location":"examples/data/#dm-domain","title":"DM Domain","text":"CDISC Variable OpenPKPD USUBJID subject_id AGE covariates.age SEX covariates.sex RACE covariates.race"},{"location":"examples/data/#see-also","title":"See Also","text":"<ul> <li>Model Import - NONMEM/Monolix import</li> <li>Population Examples - Using covariates</li> </ul>"},{"location":"examples/data/cdisc/01_basic_pc_ex/","title":"Basic CDISC PC/EX Import","text":"<p>Import pharmacokinetic data from standard CDISC PC (concentrations) and EX (exposure) domains.</p>"},{"location":"examples/data/cdisc/01_basic_pc_ex/#data-structure","title":"Data Structure","text":""},{"location":"examples/data/cdisc/01_basic_pc_ex/#pc-domain-pharmacokinetic-concentrations","title":"PC Domain (Pharmacokinetic Concentrations)","text":"<ul> <li>USUBJID: Subject identifier</li> <li>PCTPTNUM: Nominal time</li> <li>PCSTRESN: Numeric result</li> <li>PCSTAT: Status (if BLQ)</li> <li>PCLLOQ: Lower limit of quantification</li> </ul>"},{"location":"examples/data/cdisc/01_basic_pc_ex/#ex-domain-exposure","title":"EX Domain (Exposure)","text":"<ul> <li>USUBJID: Subject identifier</li> <li>EXSTDTC: Start datetime</li> <li>EXDOSE: Dose amount</li> <li>EXROUTE: Route of administration</li> </ul>"},{"location":"examples/data/cdisc/01_basic_pc_ex/#files","title":"Files","text":"File Description pc.csv PC domain data ex.csv EX domain data dm.csv DM domain data load.py Python loader load.jl Julia loader"},{"location":"examples/data/cdisc/01_basic_pc_ex/#usage","title":"Usage","text":"<pre><code>from openpkpd.data import load_cdisc\n\ndata = load_cdisc(pc=\"pc.csv\", ex=\"ex.csv\", dm=\"dm.csv\")\n</code></pre>"},{"location":"examples/data/cdisc/02_with_infusion/","title":"CDISC Infusion Data Import","text":"<p>Import pharmacokinetic data with IV infusion dosing using EXDUR field.</p>"},{"location":"examples/data/cdisc/02_with_infusion/#key-fields","title":"Key Fields","text":""},{"location":"examples/data/cdisc/02_with_infusion/#ex-domain-for-infusion","title":"EX Domain for Infusion","text":"<ul> <li>EXDOSE: Dose amount</li> <li>EXDOSU: Dose units</li> <li>EXDUR: Infusion duration (e.g., \"PT1H\" for 1 hour)</li> <li>EXROUTE: INTRAVENOUS</li> </ul>"},{"location":"examples/data/cdisc/02_with_infusion/#files","title":"Files","text":"File Description ex.csv EX domain with EXDUR load.py Python loader <p>Note: This example reuses PC data from the basic example.</p>"},{"location":"examples/data/cdisc/02_with_infusion/#infusion-handling","title":"Infusion Handling","text":"<pre><code># EXDUR format: ISO 8601 duration\n# PT1H = 1 hour infusion\n# PT30M = 30 minute infusion\n# PT2H30M = 2.5 hour infusion\n\ndata = load_cdisc(pc=\"pc.csv\", ex=\"ex.csv\")\n\n# Infusion detected from EXDUR\nfor dose in data.doses:\n    print(f\"Dose: {dose.amount} mg, Duration: {dose.duration} h\")\n</code></pre>"},{"location":"examples/data/cdisc/03_xpt_format/","title":"CDISC XPT Format Import","text":"<p>Import pharmacokinetic data from SAS transport (.xpt) files.</p>"},{"location":"examples/data/cdisc/03_xpt_format/#xpt-format","title":"XPT Format","text":"<p>XPT (SAS Transport) is the standard format for CDISC submission packages: - Binary format specified by FDA - Contains datasets in SAS transport format - Common in regulatory submissions</p>"},{"location":"examples/data/cdisc/03_xpt_format/#files","title":"Files","text":"File Description load.py Python XPT loader"},{"location":"examples/data/cdisc/03_xpt_format/#usage","title":"Usage","text":"<pre><code>from openpkpd.data import load_cdisc_xpt\n\n# Load from XPT files\ndata = load_cdisc_xpt(\n    pc=\"pc.xpt\",\n    ex=\"ex.xpt\",\n    dm=\"dm.xpt\"\n)\n</code></pre>"},{"location":"examples/data/cdisc/03_xpt_format/#dependencies","title":"Dependencies","text":"<ul> <li><code>pyreadstat</code> or <code>pandas</code> with SAS support</li> <li>XPT files must be valid SAS transport format</li> </ul>"},{"location":"examples/estimation/","title":"Parameter Estimation Examples","text":"<p>Examples demonstrating non-linear mixed effects (NLME) parameter estimation.</p>"},{"location":"examples/estimation/#estimation-methods","title":"Estimation Methods","text":"Method Description Best For FOCE-I First-Order Conditional Estimation with Interaction Most PK/PD models, standard choice SAEM Stochastic Approximation Expectation Maximization Complex models, multi-modal posteriors Laplacian Laplace approximation Sparse data, categorical outcomes"},{"location":"examples/estimation/#examples","title":"Examples","text":"Example Description Directory FOCE-I Basic One-compartment estimation 01_foce_onecomp SAEM Two-Comp Two-compartment with SAEM 02_saem_twocomp Laplacian Sparse pediatric data 03_laplacian_sparse Diagnostics GOF, CWRES, ETAs 04_estimation_diagnostics Model Comparison AIC/BIC selection 05_model_comparison"},{"location":"examples/estimation/#estimation-workflow","title":"Estimation Workflow","text":"<pre><code>1. Data Preparation\n   \u251c\u2500\u2500 Format observed data (CDISC or custom)\n   \u2514\u2500\u2500 Define dosing events\n\n2. Model Specification\n   \u251c\u2500\u2500 Choose structural model\n   \u251c\u2500\u2500 Define IIV structure\n   \u2514\u2500\u2500 Specify residual error model\n\n3. Initial Values\n   \u251c\u2500\u2500 Set \u03b8\u2080 (fixed effects)\n   \u251c\u2500\u2500 Set \u03a9\u2080 (random effects variance)\n   \u2514\u2500\u2500 Set \u03c3\u2080 (residual error)\n\n4. Run Estimation\n   \u251c\u2500\u2500 Choose method (FOCE-I, SAEM, Laplacian)\n   \u2514\u2500\u2500 Set convergence criteria\n\n5. Evaluate Results\n   \u251c\u2500\u2500 Convergence diagnostics\n   \u251c\u2500\u2500 Parameter estimates \u00b1 SE\n   \u251c\u2500\u2500 Goodness-of-fit plots\n   \u2514\u2500\u2500 Model selection (AIC/BIC)\n</code></pre>"},{"location":"examples/estimation/#key-parameters","title":"Key Parameters","text":""},{"location":"examples/estimation/#estimation-configuration","title":"Estimation Configuration","text":"<pre><code>config = EstimationConfig(\n    method = FOCEI(),\n    # Fixed effects\n    theta_init = [5.0, 50.0, 1.5],\n    theta_lower = [0.1, 1.0, 0.1],\n    theta_upper = [100.0, 500.0, 10.0],\n    # Random effects\n    omega_init = [0.09, 0.04, 0.16],\n    omega_fixed = [false, false, false],\n    # Residual error\n    sigma_init = [0.01],\n    # Algorithm settings\n    maxiter = 500,\n    tol = 1e-6\n)\n</code></pre>"},{"location":"examples/estimation/#error-models","title":"Error Models","text":"Model Formula Use Case Additive Y = F + \u03b5 Low concentrations Proportional Y = F \u00d7 (1 + \u03b5) Wide concentration range Combined Y = F \u00d7 (1 + \u03b5\u2081) + \u03b5\u2082 Best of both"},{"location":"examples/estimation/#output-interpretation","title":"Output Interpretation","text":""},{"location":"examples/estimation/#parameter-estimates","title":"Parameter Estimates","text":"<pre><code>Parameter   Estimate    SE        RSE%      95% CI\nCL          5.23        0.31      5.9       [4.62, 5.84]\nV           48.7        3.2       6.6       [42.4, 55.0]\nKa          1.42        0.18      12.7      [1.07, 1.77]\n\u03c9_CL        0.32        0.04      12.5      [0.24, 0.40]\n\u03c9_V         0.21        0.03      14.3      [0.15, 0.27]\n\u03c3_prop      0.12        0.01      8.3       [0.10, 0.14]\n</code></pre>"},{"location":"examples/estimation/#objective-function","title":"Objective Function","text":"<ul> <li>OFV (Objective Function Value): -2 \u00d7 log-likelihood</li> <li>Lower OFV = better fit</li> <li>\u0394OFV &gt; 3.84 (df=1, \u03b1=0.05) = significant improvement</li> </ul>"},{"location":"examples/estimation/#common-issues","title":"Common Issues","text":"Issue Symptom Solution Non-convergence Max iterations reached Better initial values, simpler model Boundary estimates \u03c9 \u2192 0 or \u2192 \u221e Fix parameter, check data High RSE SE &gt; 50% More data, simpler model Poor GOF Systematic bias Check structural model"},{"location":"examples/estimation/#see-also","title":"See Also","text":"<ul> <li>Population Examples - Population simulation</li> <li>VPC - Visual Predictive Checks</li> <li>NCA - Non-compartmental analysis</li> </ul>"},{"location":"examples/estimation/01_foce_onecomp/","title":"FOCE-I One-Compartment Estimation","text":"<p>Parameter estimation using FOCE-I method on simulated oral PK data.</p>"},{"location":"examples/estimation/01_foce_onecomp/#model","title":"Model","text":"<p>Structural: <pre><code>dA_depot/dt = -Ka \u00d7 A_depot\ndA_central/dt = Ka \u00d7 A_depot - CL/V \u00d7 A_central\n</code></pre></p> <p>Statistical: <pre><code>CL_i = \u03b8_CL \u00d7 exp(\u03b7_CL,i)\nV_i  = \u03b8_V \u00d7 exp(\u03b7_V,i)\nKa_i = \u03b8_Ka \u00d7 exp(\u03b7_Ka,i)\n\nY_ij = F_ij \u00d7 (1 + \u03b5_ij)   # Proportional error\n</code></pre></p>"},{"location":"examples/estimation/01_foce_onecomp/#data","title":"Data","text":"<p>Simulated data for 30 subjects: - 100 mg oral dose at t=0 - Sampling at 0.5, 1, 2, 4, 6, 8, 12, 24h - True parameters: CL=5, V=50, Ka=1.5 - IIV: \u03c9_CL=0.3, \u03c9_V=0.2, \u03c9_Ka=0.4</p>"},{"location":"examples/estimation/01_foce_onecomp/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia estimation <code>python.py</code> Python estimation <code>data.csv</code> Observed data <code>expected_results.json</code> Expected parameter estimates"},{"location":"examples/estimation/02_saem_twocomp/","title":"SAEM Two-Compartment Estimation","text":"<p>Parameter estimation using SAEM algorithm for a two-compartment model.</p>"},{"location":"examples/estimation/02_saem_twocomp/#method","title":"Method","text":"<p>SAEM (Stochastic Approximation Expectation Maximization) is useful for: - Complex models with many parameters - Multi-modal posterior distributions - Models where FOCE may struggle</p>"},{"location":"examples/estimation/02_saem_twocomp/#see-also","title":"See Also","text":"<ul> <li>FOCE-I Example</li> </ul>"},{"location":"examples/estimation/03_laplacian_sparse/","title":"Laplacian Estimation for Sparse Data","text":"<p>Parameter estimation using Laplace approximation for sparse pediatric data.</p>"},{"location":"examples/estimation/03_laplacian_sparse/#use-case","title":"Use Case","text":"<p>Laplacian estimation is ideal for: - Sparse sampling designs - Pediatric populations with limited samples - Binary or categorical outcomes</p>"},{"location":"examples/estimation/03_laplacian_sparse/#see-also","title":"See Also","text":"<ul> <li>FOCE-I Example</li> <li>SAEM Example</li> </ul>"},{"location":"examples/estimation/04_estimation_diagnostics/","title":"Estimation Diagnostics","text":"<p>Goodness-of-fit and diagnostic evaluation after parameter estimation.</p>"},{"location":"examples/estimation/04_estimation_diagnostics/#diagnostic-plots","title":"Diagnostic Plots","text":"<ul> <li>DV vs PRED</li> <li>DV vs IPRED</li> <li>CWRES vs Time</li> <li>CWRES vs PRED</li> <li>ETA distributions</li> <li>QQ plots</li> </ul>"},{"location":"examples/estimation/04_estimation_diagnostics/#see-also","title":"See Also","text":"<ul> <li>Visualization Examples</li> </ul>"},{"location":"examples/estimation/05_model_comparison/","title":"Model Comparison","text":"<p>Comparing models using AIC/BIC and likelihood ratio tests.</p>"},{"location":"examples/estimation/05_model_comparison/#criteria","title":"Criteria","text":"Criterion Formula Use AIC -2LL + 2k General comparison BIC -2LL + k*ln(n) Large sample sizes LRT \u0394OFV vs \u03c7\u00b2 Nested models"},{"location":"examples/estimation/05_model_comparison/#see-also","title":"See Also","text":"<ul> <li>FOCE-I Example</li> </ul>"},{"location":"examples/import/","title":"Model Import Examples","text":"<p>Examples demonstrating import of models from NONMEM and Monolix.</p>"},{"location":"examples/import/#supported-formats","title":"Supported Formats","text":"Source Format Import Function NONMEM .ctl, .mod <code>import_nonmem()</code> Monolix .mlxtran <code>import_monolix()</code>"},{"location":"examples/import/#nonmem-examples","title":"NONMEM Examples","text":"Example ADVAN Description Directory ADVAN1 1-comp IV One-compartment IV bolus 01_advan1_onecomp ADVAN2 1-comp Oral One-compartment first-order absorption 02_advan2_oral ADVAN4 2-comp IV Two-compartment IV bolus 03_advan4_twocomp"},{"location":"examples/import/#monolix-examples","title":"Monolix Examples","text":"Example Model Description Directory pk1cpt 1-comp Oral One-compartment with Ka 01_pk1cpt_oral pk2cpt 2-comp IV Two-compartment IV 02_pk2cpt_iv"},{"location":"examples/import/#import-workflow","title":"Import Workflow","text":"<pre><code>from openpkpd import import_nonmem, import_monolix\n\n# Import NONMEM model\nmodel = import_nonmem(\"run001.ctl\")\n\n# Import Monolix project\nmodel = import_monolix(\"project.mlxtran\")\n\n# Use imported model\nresult = simulate(model.spec, t_end=24.0)\n</code></pre>"},{"location":"examples/import/#what-gets-imported","title":"What Gets Imported","text":"Component NONMEM Monolix Structural model ADVAN/TRANS Structural model Fixed effects (THETA) Yes Yes Random effects (OMEGA) Yes Yes Residual error (SIGMA) Yes Yes Covariate model $COV block Covariate section Initial estimates Yes Yes"},{"location":"examples/import/#validation","title":"Validation","text":"<p>Each import example includes: 1. Original source file 2. Import script 3. Expected OpenPKPD specification 4. Validation by comparing simulations</p>"},{"location":"examples/import/#see-also","title":"See Also","text":"<ul> <li>Data Import - CDISC data import</li> <li>Models - OpenPKPD model specifications</li> </ul>"},{"location":"examples/import/monolix/01_pk1cpt_oral/","title":"Monolix pk1cpt Import","text":"<p>Import a one-compartment oral model from Monolix project.</p>"},{"location":"examples/import/monolix/01_pk1cpt_oral/#monolix-model","title":"Monolix Model","text":"<ul> <li>Structural: lib:oral1_1cpt_kaVCl</li> <li>Parameters: ka=1.5 1/h, V=50.0 L, Cl=5.0 L/h</li> <li>IIV: ka, V, Cl (log-normal)</li> <li>Error: Combined</li> </ul>"},{"location":"examples/import/monolix/01_pk1cpt_oral/#files","title":"Files","text":"File Description project.mlxtran Monolix project file convert.py Python conversion expected.json Expected OpenPKPD spec"},{"location":"examples/import/monolix/01_pk1cpt_oral/#conversion","title":"Conversion","text":"<pre><code>from openpkpd import import_monolix\n\nmodel = import_monolix(\"project.mlxtran\")\nprint(model.spec)\n</code></pre>"},{"location":"examples/import/monolix/01_pk1cpt_oral/#parameter-mapping","title":"Parameter Mapping","text":"Monolix OpenPKPD ka_pop params.Ka V_pop params.V Cl_pop params.CL omega_ka iiv.omegas.Ka omega_V iiv.omegas.V omega_Cl iiv.omegas.CL"},{"location":"examples/import/monolix/02_pk2cpt_iv/","title":"Monolix pk2cpt Import","text":"<p>Import a two-compartment IV model from Monolix project.</p>"},{"location":"examples/import/monolix/02_pk2cpt_iv/#monolix-model","title":"Monolix Model","text":"<ul> <li>Structural: lib:bolus2_2cpt_ClV1QV2</li> <li>Parameters: Cl=5.0 L/h, V1=10.0 L, Q=2.0 L/h, V2=20.0 L</li> <li>IIV: Cl, V1 (log-normal)</li> <li>Error: Proportional</li> </ul>"},{"location":"examples/import/monolix/02_pk2cpt_iv/#files","title":"Files","text":"File Description project.mlxtran Monolix project file convert.py Python conversion expected.json Expected OpenPKPD spec"},{"location":"examples/import/monolix/02_pk2cpt_iv/#parameter-mapping","title":"Parameter Mapping","text":"Monolix OpenPKPD Cl_pop params.CL V1_pop params.V1 Q_pop params.Q V2_pop params.V2"},{"location":"examples/import/nonmem/01_advan1_onecomp/","title":"NONMEM ADVAN1 Import","text":"<p>Import a one-compartment IV bolus model from NONMEM control file.</p>"},{"location":"examples/import/nonmem/01_advan1_onecomp/#nonmem-model","title":"NONMEM Model","text":"<ul> <li>ADVAN: 1 (One-compartment)</li> <li>TRANS: 2 (CL, V parameterization)</li> <li>Parameters: CL=5.0 L/h, V=50.0 L</li> <li>IIV: CL (30% CV), V (25% CV)</li> <li>Error: Proportional (10% CV)</li> </ul>"},{"location":"examples/import/nonmem/01_advan1_onecomp/#files","title":"Files","text":"File Description run001.ctl NONMEM control file convert.py Python conversion convert.jl Julia conversion expected.json Expected OpenPKPD spec"},{"location":"examples/import/nonmem/01_advan1_onecomp/#conversion","title":"Conversion","text":"<pre><code>from openpkpd import import_nonmem\n\nmodel = import_nonmem(\"run001.ctl\")\nprint(model.spec)  # OpenPKPD ModelSpec\n</code></pre>"},{"location":"examples/import/nonmem/01_advan1_onecomp/#parameter-mapping","title":"Parameter Mapping","text":"NONMEM OpenPKPD THETA(1) = CL params.CL THETA(2) = V params.V OMEGA(1,1) iiv.omegas.CL OMEGA(2,2) iiv.omegas.V SIGMA(1,1) error.proportional"},{"location":"examples/import/nonmem/02_advan2_oral/","title":"NONMEM ADVAN2 Import","text":"<p>Import a one-compartment oral model with first-order absorption from NONMEM.</p>"},{"location":"examples/import/nonmem/02_advan2_oral/#nonmem-model","title":"NONMEM Model","text":"<ul> <li>ADVAN: 2 (One-compartment with first-order absorption)</li> <li>TRANS: 2 (CL, V, Ka parameterization)</li> <li>Parameters: Ka=1.5 1/h, CL=5.0 L/h, V=50.0 L</li> <li>IIV: Ka (40% CV), CL (30% CV), V (25% CV)</li> <li>Error: Combined (additive + proportional)</li> </ul>"},{"location":"examples/import/nonmem/02_advan2_oral/#files","title":"Files","text":"File Description run002.ctl NONMEM control file convert.py Python conversion expected.json Expected OpenPKPD spec"},{"location":"examples/import/nonmem/02_advan2_oral/#parameter-mapping","title":"Parameter Mapping","text":"NONMEM OpenPKPD THETA(1) = Ka params.Ka THETA(2) = CL params.CL THETA(3) = V params.V OMEGA(1,1) iiv.omegas.Ka OMEGA(2,2) iiv.omegas.CL OMEGA(3,3) iiv.omegas.V"},{"location":"examples/import/nonmem/03_advan4_twocomp/","title":"NONMEM ADVAN4 Import","text":"<p>Import a two-compartment IV bolus model from NONMEM.</p>"},{"location":"examples/import/nonmem/03_advan4_twocomp/#nonmem-model","title":"NONMEM Model","text":"<ul> <li>ADVAN: 4 (Two-compartment)</li> <li>TRANS: 4 (CL, V1, Q, V2 parameterization)</li> <li>Parameters: CL=5.0 L/h, V1=10.0 L, Q=2.0 L/h, V2=20.0 L</li> <li>IIV: CL (30% CV), V1 (25% CV)</li> <li>Error: Proportional (15% CV)</li> </ul>"},{"location":"examples/import/nonmem/03_advan4_twocomp/#files","title":"Files","text":"File Description run003.ctl NONMEM control file convert.py Python conversion expected.json Expected OpenPKPD spec"},{"location":"examples/import/nonmem/03_advan4_twocomp/#parameter-mapping","title":"Parameter Mapping","text":"NONMEM OpenPKPD THETA(1) = CL params.CL THETA(2) = V1 params.V1 THETA(3) = Q params.Q THETA(4) = V2 params.V2"},{"location":"examples/models/","title":"Model Examples","text":"<p>Complete examples for all OpenPKPD PK and PK/PD models.</p>"},{"location":"examples/models/#pk-models","title":"PK Models","text":"Model Description Directory OneCompIVBolus One-compartment IV bolus 01_onecomp_iv_bolus OneCompIVInfusion One-compartment IV infusion 02_onecomp_iv_infusion OneCompOralFirstOrder One-compartment oral (first-order absorption) 03_onecomp_oral TwoCompIVBolus Two-compartment IV bolus 04_twocomp_iv TwoCompOral Two-compartment oral 05_twocomp_oral ThreeCompIVBolus Three-compartment IV bolus 06_threecomp_iv TransitAbsorption Transit compartment absorption 07_transit_absorption MichaelisMentenElimination Saturable (nonlinear) elimination 08_michaelis_menten"},{"location":"examples/models/#pkpd-models","title":"PK/PD Models","text":"Model Description Directory DirectEmax Direct Emax response 01_direct_emax SigmoidEmax Sigmoidal Emax response 02_sigmoid_emax BiophaseEquilibration Effect compartment model 03_biophase_equilibration IndirectResponse Indirect response (turnover) 04_indirect_response"},{"location":"examples/models/#file-structure","title":"File Structure","text":"<p>Each model directory contains:</p> <pre><code>01_model_name/\n\u251c\u2500\u2500 README.md       # Model equations, parameters, typical values\n\u251c\u2500\u2500 julia.jl        # Julia implementation\n\u251c\u2500\u2500 python.py       # Python implementation\n\u2514\u2500\u2500 cli.json        # CLI specification\n</code></pre>"},{"location":"examples/models/#running-examples","title":"Running Examples","text":""},{"location":"examples/models/#all-models-julia","title":"All Models (Julia)","text":"<pre><code>julia --project=core/OpenPKPDCore docs/examples/models/run_all.jl\n</code></pre>"},{"location":"examples/models/#single-model","title":"Single Model","text":"<pre><code># Julia\njulia --project=core/OpenPKPDCore docs/examples/models/pk/01_onecomp_iv_bolus/julia.jl\n\n# Python\npython docs/examples/models/pk/01_onecomp_iv_bolus/python.py\n\n# CLI\n./bin/openpkpd simulate --spec docs/examples/models/pk/01_onecomp_iv_bolus/cli.json\n</code></pre>"},{"location":"examples/models/#model-selection-guide","title":"Model Selection Guide","text":""},{"location":"examples/models/#by-administration-route","title":"By Administration Route","text":"Route Single Compartment Multi-Compartment IV Bolus OneCompIVBolus TwoCompIVBolus, ThreeCompIVBolus IV Infusion OneCompIVInfusion TwoCompIVInfusion Oral OneCompOralFirstOrder TwoCompOral Oral (complex) TransitAbsorption -"},{"location":"examples/models/#by-elimination-type","title":"By Elimination Type","text":"Elimination Model Linear (first-order) OneCompIVBolus, TwoCompIVBolus, etc. Nonlinear (saturable) MichaelisMentenElimination"},{"location":"examples/models/#by-pd-response","title":"By PD Response","text":"Response Type Model Use Case Direct, hyperbolic DirectEmax Immediate response, receptor binding Direct, sigmoidal SigmoidEmax Steep dose-response, threshold effects Delayed BiophaseEquilibration Effect compartment, hysteresis Indirect IndirectResponse Enzyme/receptor turnover, biomarkers"},{"location":"examples/models/#parameter-conventions","title":"Parameter Conventions","text":""},{"location":"examples/models/#pk-parameters","title":"PK Parameters","text":"Parameter Description Typical Units CL Clearance L/h V, V1 Central volume L Q Inter-compartmental clearance L/h V2, V3 Peripheral volumes L Ka Absorption rate constant 1/h Ktr Transit rate constant 1/h Vmax Maximum elimination rate mg/h Km Michaelis constant mg/L"},{"location":"examples/models/#pd-parameters","title":"PD Parameters","text":"Parameter Description Typical Units E0 Baseline effect varies Emax Maximum effect varies EC50 Concentration at 50% Emax mg/L gamma Hill coefficient dimensionless Ke0 Effect compartment rate constant 1/h Kin Zero-order production rate units/h Kout First-order elimination rate 1/h IC50/SC50 Concentration for 50% inhibition/stimulation mg/L"},{"location":"examples/models/pk/01_onecomp_iv_bolus/","title":"One-Compartment IV Bolus Model","text":"<p>The simplest pharmacokinetic model for intravenous administration.</p>"},{"location":"examples/models/pk/01_onecomp_iv_bolus/#model-schematic","title":"Model Schematic","text":"<pre><code>Dose (IV Bolus)\n     \u2502\n     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Central   \u2502\n\u2502      V      \u2502\u2500\u2500\u2500\u2500 CL \u2500\u2500\u2500\u2500\u25b6 Elimination\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"examples/models/pk/01_onecomp_iv_bolus/#differential-equation","title":"Differential Equation","text":"<pre><code>dA_central/dt = -CL/V \u00d7 A_central\n</code></pre> <p>With initial condition: <code>A_central(0) = Dose</code></p>"},{"location":"examples/models/pk/01_onecomp_iv_bolus/#observation","title":"Observation","text":"<pre><code>Conc = A_central / V\n</code></pre>"},{"location":"examples/models/pk/01_onecomp_iv_bolus/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units CL Clearance 1-50 L/h V Volume of distribution 10-500 L"},{"location":"examples/models/pk/01_onecomp_iv_bolus/#example-values","title":"Example Values","text":"Parameter Value Rationale CL 5.0 L/h Moderate hepatic clearance V 50.0 L Roughly total body water Dose 100 mg Single 100mg IV bolus"},{"location":"examples/models/pk/01_onecomp_iv_bolus/#analytical-solution","title":"Analytical Solution","text":"<pre><code>C(t) = (Dose/V) \u00d7 exp(-CL/V \u00d7 t)\n</code></pre>"},{"location":"examples/models/pk/01_onecomp_iv_bolus/#derived-parameters","title":"Derived Parameters","text":"Parameter Formula Example Value k CL/V 0.1 h\u207b\u00b9 t\u00bd ln(2)/k 6.93 h Cmax Dose/V 2.0 mg/L AUC\u2080\u208b\u221e Dose/CL 20 mg\u00b7h/L"},{"location":"examples/models/pk/01_onecomp_iv_bolus/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/models/pk/01_onecomp_iv_bolus/#running","title":"Running","text":"<pre><code># Julia\njulia --project=core/OpenPKPDCore julia.jl\n\n# Python\npython python.py\n\n# CLI\n./bin/openpkpd simulate --spec cli.json\n</code></pre>"},{"location":"examples/models/pk/02_onecomp_iv_infusion/","title":"One-Compartment IV Infusion Model","text":"<p>One-compartment model with constant-rate intravenous infusion.</p>"},{"location":"examples/models/pk/02_onecomp_iv_infusion/#model-schematic","title":"Model Schematic","text":"<pre><code>Infusion (Rate = Dose/Duration)\n         \u2502\n         \u25bc\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502   Central   \u2502\n    \u2502      V      \u2502\u2500\u2500\u2500\u2500 CL \u2500\u2500\u2500\u2500\u25b6 Elimination\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"examples/models/pk/02_onecomp_iv_infusion/#differential-equation","title":"Differential Equation","text":"<p>During infusion (0 \u2264 t \u2264 T_inf): <pre><code>dA_central/dt = Rate - CL/V \u00d7 A_central\n</code></pre></p> <p>After infusion (t &gt; T_inf): <pre><code>dA_central/dt = -CL/V \u00d7 A_central\n</code></pre></p> <p>Where <code>Rate = Dose / T_inf</code></p>"},{"location":"examples/models/pk/02_onecomp_iv_infusion/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units CL Clearance 1-50 L/h V Volume of distribution 10-500 L duration Infusion duration 0.5-4 h"},{"location":"examples/models/pk/02_onecomp_iv_infusion/#example-values","title":"Example Values","text":"Parameter Value Rationale CL 5.0 L/h Moderate clearance V 50.0 L Total body water Dose 100 mg Total infusion dose Duration 1.0 h 1-hour infusion"},{"location":"examples/models/pk/02_onecomp_iv_infusion/#derived-parameters","title":"Derived Parameters","text":"Parameter Formula Example Value Rate Dose/Duration 100 mg/h Css Rate/CL 20 mg/L (if continued) t\u00bd ln(2)\u00d7V/CL 6.93 h"},{"location":"examples/models/pk/02_onecomp_iv_infusion/#key-features","title":"Key Features","text":"<ul> <li>Cmax occurs at end of infusion (t = T_inf)</li> <li>Lower Cmax compared to bolus for same dose</li> <li>Useful for drugs with narrow therapeutic window</li> <li>Rate-limiting can reduce infusion reactions</li> </ul>"},{"location":"examples/models/pk/02_onecomp_iv_infusion/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/models/pk/03_onecomp_oral/","title":"One-Compartment Oral First-Order Absorption Model","text":"<p>One-compartment model with first-order absorption from an oral dose.</p>"},{"location":"examples/models/pk/03_onecomp_oral/#model-schematic","title":"Model Schematic","text":"<pre><code>Oral Dose\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     Ka      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Gut   \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6  \u2502   Central   \u2502\n\u2502  (A_d)  \u2502             \u2502      V      \u2502\u2500\u2500\u2500\u2500 CL \u2500\u2500\u2500\u2500\u25b6 Elimination\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"examples/models/pk/03_onecomp_oral/#differential-equations","title":"Differential Equations","text":"<pre><code>dA_depot/dt = -Ka \u00d7 A_depot\ndA_central/dt = Ka \u00d7 A_depot - CL/V \u00d7 A_central\n</code></pre> <p>With initial conditions: <code>A_depot(0) = Dose \u00d7 F</code>, <code>A_central(0) = 0</code></p>"},{"location":"examples/models/pk/03_onecomp_oral/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units Ka Absorption rate constant 0.1-5.0 1/h CL Clearance 1-50 L/h V Volume of distribution 10-500 L F Bioavailability 0.1-1.0 -"},{"location":"examples/models/pk/03_onecomp_oral/#example-values","title":"Example Values","text":"Parameter Value Rationale Ka 1.5 1/h Moderate absorption CL 5.0 L/h Moderate clearance V 50.0 L Total body water Dose 100 mg Oral tablet F 1.0 Assumed 100%"},{"location":"examples/models/pk/03_onecomp_oral/#key-features","title":"Key Features","text":"<ul> <li>Absorption phase followed by elimination phase</li> <li>Tmax occurs when absorption rate = elimination rate</li> <li>\"Flip-flop\" kinetics possible when Ka &lt; k</li> </ul>"},{"location":"examples/models/pk/03_onecomp_oral/#derived-parameters","title":"Derived Parameters","text":"Parameter Formula Example Value k CL/V 0.1 h\u207b\u00b9 Tmax ln(Ka/k)/(Ka-k) 1.79 h Cmax (F\u00d7Dose/V)\u00d7(Ka/(Ka-k))\u00d7[exp(-k\u00d7Tmax)-exp(-Ka\u00d7Tmax)] 1.43 mg/L t\u00bd ln(2)/k 6.93 h"},{"location":"examples/models/pk/03_onecomp_oral/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/models/pk/04_twocomp_iv/","title":"Two-Compartment IV Bolus Model","text":"<p>Two-compartment model with rapid distribution to peripheral tissues.</p>"},{"location":"examples/models/pk/04_twocomp_iv/#model-schematic","title":"Model Schematic","text":"<pre><code>IV Bolus\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     Q      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Central   \u2502 \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 \u2502 Peripheral  \u2502\n\u2502     V1      \u2502            \u2502     V2      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u2502 CL\n       \u25bc\n   Elimination\n</code></pre>"},{"location":"examples/models/pk/04_twocomp_iv/#differential-equations","title":"Differential Equations","text":"<pre><code>dA_central/dt = Q/V2 \u00d7 A_peripheral - Q/V1 \u00d7 A_central - CL/V1 \u00d7 A_central\ndA_peripheral/dt = Q/V1 \u00d7 A_central - Q/V2 \u00d7 A_peripheral\n</code></pre>"},{"location":"examples/models/pk/04_twocomp_iv/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units CL Clearance 1-50 L/h V1 Central volume 5-100 L Q Inter-compartmental clearance 1-50 L/h V2 Peripheral volume 10-500 L"},{"location":"examples/models/pk/04_twocomp_iv/#example-values","title":"Example Values","text":"Parameter Value Rationale CL 5.0 L/h Moderate clearance V1 10.0 L Plasma/blood volume Q 10.0 L/h Rapid distribution V2 40.0 L Tissue distribution Dose 100 mg IV bolus"},{"location":"examples/models/pk/04_twocomp_iv/#key-features","title":"Key Features","text":"<ul> <li>Bi-exponential decline (\u03b1 and \u03b2 phases)</li> <li>\u03b1 phase: distribution + elimination</li> <li>\u03b2 phase: terminal elimination</li> <li>V1 + V2 = Vss (volume at steady-state)</li> </ul>"},{"location":"examples/models/pk/04_twocomp_iv/#derived-parameters","title":"Derived Parameters","text":"Parameter Formula Description Vss V1 + V2 Steady-state volume \u03b1, \u03b2 Macro rate constants Eigenvalues t\u00bd\u03b1 ln(2)/\u03b1 Distribution half-life t\u00bd\u03b2 ln(2)/\u03b2 Terminal half-life"},{"location":"examples/models/pk/04_twocomp_iv/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/models/pk/05_twocomp_oral/","title":"Two-Compartment Oral Model","text":"<p>Two-compartment model with first-order oral absorption.</p>"},{"location":"examples/models/pk/05_twocomp_oral/#model-schematic","title":"Model Schematic","text":"<pre><code>Oral Dose\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     Ka      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     Q      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Gut   \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6  \u2502   Central   \u2502 \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 \u2502 Peripheral  \u2502\n\u2502  (A_d)  \u2502             \u2502     V1      \u2502            \u2502     V2      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u2502 CL\n                               \u25bc\n                          Elimination\n</code></pre>"},{"location":"examples/models/pk/05_twocomp_oral/#differential-equations","title":"Differential Equations","text":"<pre><code>dA_depot/dt = -Ka \u00d7 A_depot\ndA_central/dt = Ka \u00d7 A_depot + Q/V2 \u00d7 A_peripheral - Q/V1 \u00d7 A_central - CL/V1 \u00d7 A_central\ndA_peripheral/dt = Q/V1 \u00d7 A_central - Q/V2 \u00d7 A_peripheral\n</code></pre>"},{"location":"examples/models/pk/05_twocomp_oral/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units Ka Absorption rate constant 0.1-5.0 1/h CL Clearance 1-50 L/h V1 Central volume 5-100 L Q Inter-compartmental clearance 1-50 L/h V2 Peripheral volume 10-500 L"},{"location":"examples/models/pk/05_twocomp_oral/#example-values","title":"Example Values","text":"Parameter Value Rationale Ka 1.5 1/h Moderate absorption CL 5.0 L/h Moderate clearance V1 10.0 L Central compartment Q 10.0 L/h Rapid distribution V2 40.0 L Tissue distribution Dose 100 mg Oral dose"},{"location":"examples/models/pk/05_twocomp_oral/#key-features","title":"Key Features","text":"<ul> <li>Tri-exponential profile (absorption + \u03b1 + \u03b2 phases)</li> <li>Distribution occurs during absorption</li> <li>Common for lipophilic drugs with significant tissue binding</li> </ul>"},{"location":"examples/models/pk/05_twocomp_oral/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/models/pk/06_threecomp_iv/","title":"Three-Compartment IV Bolus Model","text":"<p>Three-compartment model for drugs with complex tissue distribution.</p>"},{"location":"examples/models/pk/06_threecomp_iv/#model-schematic","title":"Model Schematic","text":"<pre><code>                  IV Bolus\n                      \u2502\n                      \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  Q2  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  Q3  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Peripheral  \u2502\u25c4\u2500\u2500\u2500\u2500\u25b6\u2502   Central   \u2502\u25c4\u2500\u2500\u2500\u2500\u25b6\u2502 Peripheral  \u2502\n\u2502   Shallow   \u2502      \u2502     V1      \u2502      \u2502    Deep     \u2502\n\u2502     V2      \u2502      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502     V3      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502             \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2502 CL\n                            \u25bc\n                       Elimination\n</code></pre>"},{"location":"examples/models/pk/06_threecomp_iv/#differential-equations","title":"Differential Equations","text":"<pre><code>dA_central/dt = Q2/V2 \u00d7 A_shallow - Q2/V1 \u00d7 A_central\n              + Q3/V3 \u00d7 A_deep - Q3/V1 \u00d7 A_central\n              - CL/V1 \u00d7 A_central\n\ndA_shallow/dt = Q2/V1 \u00d7 A_central - Q2/V2 \u00d7 A_shallow\n\ndA_deep/dt = Q3/V1 \u00d7 A_central - Q3/V3 \u00d7 A_deep\n</code></pre>"},{"location":"examples/models/pk/06_threecomp_iv/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units CL Clearance 1-50 L/h V1 Central volume 5-50 L Q2 Shallow distribution clearance 5-100 L/h V2 Shallow peripheral volume 10-200 L Q3 Deep distribution clearance 0.1-10 L/h V3 Deep peripheral volume 50-1000 L"},{"location":"examples/models/pk/06_threecomp_iv/#example-values","title":"Example Values","text":"Parameter Value Rationale CL 5.0 L/h Moderate clearance V1 10.0 L Plasma volume Q2 20.0 L/h Rapid shallow distribution V2 20.0 L Well-perfused tissues Q3 2.0 L/h Slow deep distribution V3 100.0 L Poorly perfused tissues/fat Dose 100 mg IV bolus"},{"location":"examples/models/pk/06_threecomp_iv/#key-features","title":"Key Features","text":"<ul> <li>Tri-exponential decline (\u03b1, \u03b2, \u03b3 phases)</li> <li>\u03b1 phase: rapid distribution</li> <li>\u03b2 phase: slow distribution</li> <li>\u03b3 phase: terminal elimination</li> <li>Vss = V1 + V2 + V3</li> </ul>"},{"location":"examples/models/pk/06_threecomp_iv/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/models/pk/07_transit_absorption/","title":"Transit Compartment Absorption Model","text":"<p>Model with transit compartments for delayed/complex oral absorption.</p>"},{"location":"examples/models/pk/07_transit_absorption/#model-schematic","title":"Model Schematic","text":"<pre><code>Oral Dose\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  Ktr   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  Ktr   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  Ktr   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  Ka   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502Transit 1\u2502 \u2500\u2500\u2500\u2500\u25b6 \u2502Transit 2\u2502 \u2500\u2500\u2500\u2500\u25b6 \u2502Transit 3\u2502 \u2500\u2500\u2500\u2500\u25b6 \u2502  ... n  \u2502 \u2500\u2500\u2500\u2500\u25b6\u2502   Central   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502      V      \u2502\n                                                                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                                               \u2502 CL\n                                                                               \u25bc\n                                                                          Elimination\n</code></pre>"},{"location":"examples/models/pk/07_transit_absorption/#key-equations","title":"Key Equations","text":"<p>The transit model uses n identical transit compartments with rate constant Ktr:</p> <pre><code>dA\u2081/dt = -Ktr \u00d7 A\u2081\ndA\u1d62/dt = Ktr \u00d7 A\u1d62\u208b\u2081 - Ktr \u00d7 A\u1d62   (for i = 2 to n)\ndA_central/dt = Ktr \u00d7 A\u2099 - CL/V \u00d7 A_central\n</code></pre> <p>Mean Transit Time (MTT): <pre><code>MTT = (n + 1) / Ktr\n</code></pre></p>"},{"location":"examples/models/pk/07_transit_absorption/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units Ktr Transit rate constant 0.5-5.0 1/h n Number of transit compartments 1-10 - CL Clearance 1-50 L/h V Volume of distribution 10-500 L"},{"location":"examples/models/pk/07_transit_absorption/#example-values","title":"Example Values","text":"Parameter Value Rationale Ktr 2.0 1/h MTT \u2248 2h with n=3 n 3 3 transit compartments CL 5.0 L/h Moderate clearance V 50.0 L Total body water Dose 100 mg Oral dose"},{"location":"examples/models/pk/07_transit_absorption/#key-features","title":"Key Features","text":"<ul> <li>Delayed Tmax compared to first-order absorption</li> <li>Sharper peak than first-order absorption</li> <li>More physiologically realistic for enteric-coated tablets</li> <li>Flexible: adjusting n and Ktr can model various profiles</li> </ul>"},{"location":"examples/models/pk/07_transit_absorption/#use-cases","title":"Use Cases","text":"<ul> <li>Enteric-coated formulations</li> <li>Extended-release tablets</li> <li>Drugs with gastric emptying delay</li> <li>Complex absorption profiles</li> </ul>"},{"location":"examples/models/pk/07_transit_absorption/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/models/pk/08_michaelis_menten/","title":"Michaelis-Menten Elimination Model","text":"<p>One-compartment model with saturable (nonlinear) elimination kinetics.</p>"},{"location":"examples/models/pk/08_michaelis_menten/#model-schematic","title":"Model Schematic","text":"<pre><code>IV Bolus\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Central   \u2502\n\u2502      V      \u2502\u2500\u2500\u2500\u2500 Vmax/(Km + C) \u2500\u2500\u2500\u2500\u25b6 Saturable Elimination\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"examples/models/pk/08_michaelis_menten/#differential-equation","title":"Differential Equation","text":"<pre><code>dA_central/dt = -Vmax \u00d7 A_central / (Km \u00d7 V + A_central)\n</code></pre> <p>Or in terms of concentration:</p> <pre><code>dC/dt = -Vmax \u00d7 C / (Km + C) / V\n</code></pre>"},{"location":"examples/models/pk/08_michaelis_menten/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units Vmax Maximum elimination rate 10-1000 mg/h Km Michaelis constant 1-100 mg/L V Volume of distribution 10-500 L"},{"location":"examples/models/pk/08_michaelis_menten/#example-values","title":"Example Values","text":"Parameter Value Rationale Vmax 50.0 mg/h Maximum enzyme capacity Km 10.0 mg/L Half-saturation concentration V 50.0 L Total body water Dose 500 mg High dose to show saturation"},{"location":"examples/models/pk/08_michaelis_menten/#key-features","title":"Key Features","text":"<ul> <li>At low C (C &lt;&lt; Km): First-order kinetics, CL \u2248 Vmax/Km</li> <li>At high C (C &gt;&gt; Km): Zero-order kinetics, rate \u2248 Vmax</li> <li>Nonlinear PK: AUC not proportional to dose</li> <li>Examples: phenytoin, ethanol, aspirin (high dose)</li> </ul>"},{"location":"examples/models/pk/08_michaelis_menten/#derived-parameters","title":"Derived Parameters","text":"Parameter Formula Description CLint Vmax/Km Intrinsic clearance (at low C) t\u00bd (low C) 0.693 \u00d7 V \u00d7 Km / Vmax Half-life at low concentrations"},{"location":"examples/models/pk/08_michaelis_menten/#use-cases","title":"Use Cases","text":"<ul> <li>Drugs with capacity-limited metabolism</li> <li>High-dose regimens</li> <li>Therapeutic drug monitoring</li> <li>Phenytoin dosing optimization</li> </ul>"},{"location":"examples/models/pk/08_michaelis_menten/#clinical-implications","title":"Clinical Implications","text":"<ol> <li>Dose escalation: Small dose increases can cause large concentration changes</li> <li>Steady-state: Takes longer to reach at higher doses</li> <li>Drug interactions: Enzyme inhibitors have greater effect when near saturation</li> </ol>"},{"location":"examples/models/pk/08_michaelis_menten/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/models/pkpd/01_direct_emax/","title":"Direct Emax PD Model","text":"<p>PK/PD model with direct, hyperbolic concentration-effect relationship.</p>"},{"location":"examples/models/pkpd/01_direct_emax/#model-schematic","title":"Model Schematic","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     PK      \u2502\u2500\u2500\u2500\u2500 Conc \u2500\u2500\u2500\u2500\u2510\n\u2502 OneCompIVBolus             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u25bc\n                      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                      \u2502   Direct Effect     \u2502\n                      \u2502                     \u2502\n                      \u2502 E = E0 + Emax \u00d7 C   \u2502\n                      \u2502       \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500    \u2502\n                      \u2502        EC50 + C     \u2502\n                      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"examples/models/pkpd/01_direct_emax/#pd-equation","title":"PD Equation","text":"<pre><code>Effect = E0 + (Emax \u00d7 C) / (EC50 + C)\n</code></pre> <p>Where: - E0 = baseline effect - Emax = maximum effect above baseline - EC50 = concentration producing 50% of Emax - C = drug concentration</p>"},{"location":"examples/models/pkpd/01_direct_emax/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units E0 Baseline effect 0-100 varies Emax Maximum effect 0-100 varies EC50 Potency (C for 50% Emax) 0.1-100 mg/L"},{"location":"examples/models/pkpd/01_direct_emax/#pk-parameters","title":"PK Parameters","text":"Parameter Description Units CL Clearance L/h V Volume L"},{"location":"examples/models/pkpd/01_direct_emax/#example-values","title":"Example Values","text":"Parameter Value Rationale E0 0 No baseline effect Emax 100 Maximum response = 100 units EC50 1.0 mg/L Moderate potency CL 5.0 L/h Moderate clearance V 50.0 L Total body water"},{"location":"examples/models/pkpd/01_direct_emax/#key-features","title":"Key Features","text":"<ul> <li>Immediate response (no hysteresis)</li> <li>Hyperbolic saturation curve</li> <li>Effect at C = EC50 is E0 + Emax/2</li> <li>Effect at C &gt;&gt; EC50 approaches E0 + Emax</li> </ul>"},{"location":"examples/models/pkpd/01_direct_emax/#use-cases","title":"Use Cases","text":"<ul> <li>Receptor binding studies</li> <li>Enzyme inhibition</li> <li>Blood pressure lowering</li> <li>Biomarkers with rapid equilibration</li> </ul>"},{"location":"examples/models/pkpd/01_direct_emax/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/models/pkpd/02_sigmoid_emax/","title":"Sigmoid Emax (Hill) PD Model","text":"<p>PK/PD model with sigmoidal concentration-effect relationship.</p>"},{"location":"examples/models/pkpd/02_sigmoid_emax/#model-schematic","title":"Model Schematic","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     PK      \u2502\u2500\u2500\u2500\u2500 Conc \u2500\u2500\u2500\u2500\u2510\n\u2502 OneCompIVBolus             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u25bc\n                      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                      \u2502   Sigmoid Effect (Hill)   \u2502\n                      \u2502                           \u2502\n                      \u2502 E = E0 + Emax \u00d7 C^\u03b3       \u2502\n                      \u2502       \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500       \u2502\n                      \u2502       EC50^\u03b3 + C^\u03b3        \u2502\n                      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"examples/models/pkpd/02_sigmoid_emax/#pd-equation","title":"PD Equation","text":"<pre><code>Effect = E0 + (Emax \u00d7 C^\u03b3) / (EC50^\u03b3 + C^\u03b3)\n</code></pre> <p>Where: - E0 = baseline effect - Emax = maximum effect - EC50 = concentration at 50% effect - \u03b3 (gamma) = Hill coefficient (sigmoidicity factor)</p>"},{"location":"examples/models/pkpd/02_sigmoid_emax/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units E0 Baseline effect 0-100 varies Emax Maximum effect 0-100 varies EC50 Potency 0.1-100 mg/L gamma Hill coefficient 0.5-5 -"},{"location":"examples/models/pkpd/02_sigmoid_emax/#hill-coefficient-interpretation","title":"Hill Coefficient Interpretation","text":"\u03b3 Value Curve Shape Interpretation &lt; 1 Shallow Negative cooperativity = 1 Hyperbolic No cooperativity (= Emax) &gt; 1 Steep Positive cooperativity &gt;&gt; 1 Switch-like Threshold effect"},{"location":"examples/models/pkpd/02_sigmoid_emax/#example-values","title":"Example Values","text":"Parameter Value Rationale E0 0 No baseline Emax 100 100% max effect EC50 1.0 mg/L Moderate potency gamma 2.0 Positive cooperativity"},{"location":"examples/models/pkpd/02_sigmoid_emax/#key-features","title":"Key Features","text":"<ul> <li>Steeper dose-response than simple Emax</li> <li>Common for drugs with cooperative binding</li> <li>Can model all-or-none responses (high \u03b3)</li> </ul>"},{"location":"examples/models/pkpd/02_sigmoid_emax/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/models/pkpd/03_biophase_equilibration/","title":"Biophase Equilibration (Effect Compartment) Model","text":"<p>PK/PD model with delayed effect due to distribution to an effect site.</p>"},{"location":"examples/models/pkpd/03_biophase_equilibration/#model-schematic","title":"Model Schematic","text":"<pre><code>IV Bolus\n    \u2502\n    \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     Ke0      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Central   \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 \u2502   Effect    \u2502\n\u2502      V      \u2502              \u2502 Compartment \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502    (Ce)     \u2502\n       \u2502                     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502 CL                         \u2502\n       \u25bc                            \u25bc\n   Elimination              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                            \u2502 E = E0 + Emax\u00d7Ce\u2502\n                            \u2502     \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2502\n                            \u2502     EC50 + Ce   \u2502\n                            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"examples/models/pkpd/03_biophase_equilibration/#differential-equations","title":"Differential Equations","text":"<p>PK: <pre><code>dA_central/dt = -CL/V \u00d7 A_central\n</code></pre></p> <p>Effect Compartment: <pre><code>dCe/dt = Ke0 \u00d7 (Cp - Ce)\n</code></pre></p> <p>PD: <pre><code>Effect = E0 + Emax \u00d7 Ce / (EC50 + Ce)\n</code></pre></p>"},{"location":"examples/models/pkpd/03_biophase_equilibration/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units Ke0 Effect site equilibration rate 0.1-5 1/h E0 Baseline effect 0-100 varies Emax Maximum effect 0-100 varies EC50 Effect site EC50 0.1-100 mg/L"},{"location":"examples/models/pkpd/03_biophase_equilibration/#example-values","title":"Example Values","text":"Parameter Value Rationale CL 5.0 L/h Moderate clearance V 50.0 L Central volume Ke0 0.5 1/h 1.4h equilibration half-life E0 0 No baseline Emax 100 Maximum response EC50 1.0 mg/L Effect site potency"},{"location":"examples/models/pkpd/03_biophase_equilibration/#key-features","title":"Key Features","text":"<ul> <li>Counter-clockwise hysteresis: Effect lags behind concentration</li> <li>t\u00bdke0 = ln(2)/Ke0: Time for effect compartment to equilibrate</li> <li>Peak effect occurs after peak concentration</li> <li>Effect persists longer than plasma concentration</li> </ul>"},{"location":"examples/models/pkpd/03_biophase_equilibration/#use-cases","title":"Use Cases","text":"<ul> <li>CNS-active drugs (BBB penetration delay)</li> <li>Anesthetics (propofol, remifentanil)</li> <li>Sedatives/hypnotics</li> <li>Analgesics</li> </ul>"},{"location":"examples/models/pkpd/03_biophase_equilibration/#hysteresis-interpretation","title":"Hysteresis Interpretation","text":"<p>When plotting Effect vs Concentration: - Counter-clockwise loop: Effect delayed (biophase model) - Clockwise loop: Tolerance development</p>"},{"location":"examples/models/pkpd/03_biophase_equilibration/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/models/pkpd/04_indirect_response/","title":"Indirect Response (Turnover) Model","text":"<p>PK/PD model for drugs that affect the synthesis or degradation of a response variable.</p>"},{"location":"examples/models/pkpd/04_indirect_response/#model-schematic","title":"Model Schematic","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     PK      \u2502\u2500\u2500\u2500\u2500 Conc \u2500\u2500\u2500\u2500\u2510\n\u2502 OneCompIVBolus             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n                             \u25bc\n                      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                      \u2502 Inhibition/Stimulation  \u2502\n                      \u2502  of Kin or Kout         \u2502\n                      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                  \u2502\n                                  \u25bc\n                      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                      \u2502   Response Variable     \u2502\n                      \u2502   dR/dt = Kin - Kout\u00d7R  \u2502\n                      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"examples/models/pkpd/04_indirect_response/#four-types-of-indirect-response-models","title":"Four Types of Indirect Response Models","text":"Type Drug Effect Example IRM-I Inhibition of Kin Corticosteroids on cortisol IRM-II Inhibition of Kout Warfarin on clotting factors IRM-III Stimulation of Kin EPO on RBC production IRM-IV Stimulation of Kout Diuretics on sodium excretion"},{"location":"examples/models/pkpd/04_indirect_response/#differential-equations","title":"Differential Equations","text":"<p>Response: <pre><code>dR/dt = Kin \u00d7 (1 - I(C)) - Kout \u00d7 R    (IRM-I: inhibit production)\ndR/dt = Kin - Kout \u00d7 (1 - I(C)) \u00d7 R    (IRM-II: inhibit loss)\ndR/dt = Kin \u00d7 (1 + S(C)) - Kout \u00d7 R    (IRM-III: stimulate production)\ndR/dt = Kin - Kout \u00d7 (1 + S(C)) \u00d7 R    (IRM-IV: stimulate loss)\n</code></pre></p> <p>Where: - <code>I(C) = Imax \u00d7 C / (IC50 + C)</code> (inhibition function) - <code>S(C) = Smax \u00d7 C / (SC50 + C)</code> (stimulation function)</p>"},{"location":"examples/models/pkpd/04_indirect_response/#parameters","title":"Parameters","text":"Parameter Description Typical Range Units Kin Zero-order production rate 0.1-100 units/h Kout First-order loss rate 0.01-1 1/h Imax/Smax Maximum inhibition/stimulation 0.1-1 - IC50/SC50 Potency for effect 0.1-100 mg/L"},{"location":"examples/models/pkpd/04_indirect_response/#example-values-irm-i","title":"Example Values (IRM-I)","text":"Parameter Value Rationale CL 5.0 L/h Drug clearance V 50.0 L Drug volume Kin 10 units/h Production rate Kout 0.1 1/h Loss rate (t\u00bd = 6.9h) Imax 0.9 90% max inhibition IC50 1.0 mg/L Potency"},{"location":"examples/models/pkpd/04_indirect_response/#key-features","title":"Key Features","text":"<ul> <li>Baseline: R\u2080 = Kin/Kout</li> <li>Response half-life: t\u00bd_R = ln(2)/Kout</li> <li>Delayed response (not immediate)</li> <li>Rebound possible after drug washout</li> </ul>"},{"location":"examples/models/pkpd/04_indirect_response/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/nca/","title":"Non-Compartmental Analysis (NCA)","text":"<p>Examples demonstrating NCA metrics computation from concentration-time data.</p>"},{"location":"examples/nca/#computed-metrics","title":"Computed Metrics","text":"Metric Description Units Cmax Maximum concentration mg/L Tmax Time of maximum concentration h AUC_0_t AUC from 0 to last observation mg\u00b7h/L AUC_0_inf AUC extrapolated to infinity mg\u00b7h/L t_half Terminal half-life h CL_F Apparent clearance L/h Vz_F Apparent volume L MRT Mean residence time h"},{"location":"examples/nca/#examples","title":"Examples","text":"Example Description Directory Basic NCA Single subject NCA 01_basic_nca Population NCA Summary statistics 02_population_nca"},{"location":"examples/nca/#usage","title":"Usage","text":"<pre><code>using OpenPKPDCore\n\n# Compute NCA metrics\nresult = compute_nca(\n    times = [0, 0.5, 1, 2, 4, 8, 12, 24],\n    concentrations = [2.0, 1.8, 1.5, 1.2, 0.8, 0.4, 0.2, 0.05],\n    dose = 100.0,\n    route = :iv\n)\n\nprintln(\"Cmax: $(result.cmax)\")\nprintln(\"AUC_0_inf: $(result.auc_0_inf)\")\nprintln(\"t_half: $(result.t_half)\")\n</code></pre> <pre><code>from openpkpd.nca import compute_nca\n\nresult = compute_nca(\n    times=[0, 0.5, 1, 2, 4, 8, 12, 24],\n    concentrations=[2.0, 1.8, 1.5, 1.2, 0.8, 0.4, 0.2, 0.05],\n    dose=100.0,\n    route=\"iv\"\n)\n</code></pre>"},{"location":"examples/nca/01_basic_nca/","title":"Basic NCA Analysis","text":"<p>Single-subject non-compartmental analysis computing standard PK metrics.</p>"},{"location":"examples/nca/01_basic_nca/#computed-metrics","title":"Computed Metrics","text":"Metric Description Cmax Maximum concentration Tmax Time of maximum AUC_0_t AUC to last observation AUC_0_inf AUC extrapolated to infinity t_half Terminal half-life CL/F Apparent clearance Vz/F Apparent volume"},{"location":"examples/nca/01_basic_nca/#files","title":"Files","text":"File Description julia.jl Julia implementation python.py Python implementation"},{"location":"examples/nca/02_population_nca/","title":"Population NCA Analysis","text":"<p>Non-compartmental analysis across multiple subjects with summary statistics.</p>"},{"location":"examples/nca/02_population_nca/#features","title":"Features","text":"<ul> <li>Individual subject NCA metrics</li> <li>Population summary (mean, SD, CV%)</li> <li>Geometric mean for log-normal parameters</li> </ul>"},{"location":"examples/nca/02_population_nca/#see-also","title":"See Also","text":"<ul> <li>Basic NCA</li> </ul>"},{"location":"examples/population/","title":"Population Modeling Examples","text":"<p>Examples demonstrating inter-individual variability (IIV), inter-occasion variability (IOV), and covariate modeling.</p>"},{"location":"examples/population/#examples","title":"Examples","text":"Example Description Directory Basic IIV Log-normal inter-individual variability 01_basic_iiv IOV Inter-occasion variability 02_iov Static Covariates Weight and age effects 03_static_covariates Time-Varying Covariates Creatinine clearance over time 04_time_varying_covariates Complex Model Multiple covariates, IIV, correlations 05_complex_covariate_model"},{"location":"examples/population/#concepts","title":"Concepts","text":""},{"location":"examples/population/#inter-individual-variability-iiv","title":"Inter-Individual Variability (IIV)","text":"<p>IIV describes differences between subjects:</p> <pre><code>\u03b8\u1d62 = \u03b8_pop \u00d7 exp(\u03b7\u1d62)\n</code></pre> <p>Where: - \u03b8\u1d62 = individual parameter - \u03b8_pop = population typical value - \u03b7\u1d62 ~ N(0, \u03c9\u00b2)</p>"},{"location":"examples/population/#inter-occasion-variability-iov","title":"Inter-Occasion Variability (IOV)","text":"<p>IOV describes within-subject variability across occasions:</p> <pre><code>\u03b8\u1d62\u2c7c = \u03b8_pop \u00d7 exp(\u03b7\u1d62 + \u03ba\u2c7c)\n</code></pre> <p>Where: - \u03ba\u2c7c ~ N(0, \u03c0\u00b2) is the occasion-specific random effect</p>"},{"location":"examples/population/#covariate-models","title":"Covariate Models","text":"<p>Covariates explain part of the variability:</p> <p>Power model (weight on CL): <pre><code>CL = CL_pop \u00d7 (WT/70)^0.75 \u00d7 exp(\u03b7_CL)\n</code></pre></p> <p>Linear model (age on V): <pre><code>V = V_pop \u00d7 (1 + \u03b8_age \u00d7 (AGE - 40)) \u00d7 exp(\u03b7_V)\n</code></pre></p> <p>Categorical (sex on CL): <pre><code>CL = CL_pop \u00d7 \u03b8_sex^SEX \u00d7 exp(\u03b7_CL)\n</code></pre></p>"},{"location":"examples/population/#file-structure","title":"File Structure","text":"<p>Each example contains: <pre><code>01_example/\n\u251c\u2500\u2500 README.md       # Detailed explanation\n\u251c\u2500\u2500 julia.jl        # Julia implementation\n\u251c\u2500\u2500 python.py       # Python implementation\n\u2514\u2500\u2500 cli.json        # CLI specification (if applicable)\n</code></pre></p>"},{"location":"examples/population/#running-examples","title":"Running Examples","text":"<pre><code># Julia\njulia --project=core/OpenPKPDCore docs/examples/population/01_basic_iiv/julia.jl\n\n# Python\npython docs/examples/population/01_basic_iiv/python.py\n</code></pre>"},{"location":"examples/population/#key-parameters","title":"Key Parameters","text":""},{"location":"examples/population/#omega-interpretation","title":"Omega (\u03c9) Interpretation","text":"\u03c9\u00b2 \u03c9 (SD) CV% Interpretation 0.01 0.1 ~10% Low variability 0.09 0.3 ~30% Moderate variability 0.25 0.5 ~50% High variability 0.49 0.7 ~70% Very high variability <p>Note: For log-normal, CV \u2248 \u03c9 for \u03c9 &lt; 0.5</p>"},{"location":"examples/population/#common-covariate-exponents","title":"Common Covariate Exponents","text":"Covariate Parameter Exponent Rationale Weight CL 0.75 Allometric scaling Weight V 1.0 Linear scaling Age CL -0.01 to -0.02 Linear decline CrCL CL 0.5-1.0 Renal function Sex CL 0.8-1.2 Categorical"},{"location":"examples/population/#see-also","title":"See Also","text":"<ul> <li>Parameter Estimation - Estimate population parameters</li> <li>VPC - Validate population models</li> <li>Models - Available structural models</li> </ul>"},{"location":"examples/population/01_basic_iiv/","title":"Basic Inter-Individual Variability (IIV)","text":"<p>Population simulation with log-normal IIV on PK parameters.</p>"},{"location":"examples/population/01_basic_iiv/#model","title":"Model","text":"<pre><code>\u03b8\u1d62 = \u03b8_pop \u00d7 exp(\u03b7\u1d62)\n\nWhere \u03b7\u1d62 ~ N(0, \u03c9\u00b2)\n</code></pre>"},{"location":"examples/population/01_basic_iiv/#parameters","title":"Parameters","text":"Parameter Population \u03c9 (SD) CV% CL 5.0 L/h 0.3 ~30% V 50.0 L 0.2 ~20%"},{"location":"examples/population/01_basic_iiv/#what-this-example-shows","title":"What This Example Shows","text":"<ol> <li>Generate 100 virtual subjects</li> <li>Each subject has individual CL and V values</li> <li>Simulate PK for all subjects</li> <li>Compute population summaries (mean, median, 5th/95th percentiles)</li> </ol>"},{"location":"examples/population/01_basic_iiv/#expected-variability","title":"Expected Variability","text":"<p>With \u03c9_CL = 0.3: - 95% of subjects have CL between ~2.7 and ~9.2 L/h - This is 0.55\u00d7 to 1.8\u00d7 the typical value</p>"},{"location":"examples/population/01_basic_iiv/#files","title":"Files","text":"File Description <code>julia.jl</code> Julia implementation <code>python.py</code> Python implementation <code>cli.json</code> CLI specification"},{"location":"examples/population/02_iov/","title":"Inter-Occasion Variability (IOV)","text":"<p>Population simulation with both IIV and IOV for multiple dosing occasions.</p>"},{"location":"examples/population/02_iov/#model","title":"Model","text":"<pre><code>\u03b8\u1d62\u2c7c = \u03b8_pop \u00d7 exp(\u03b7\u1d62 + \u03ba\u2c7c)\n\nWhere:\n- \u03b7\u1d62 ~ N(0, \u03c9\u00b2)  (between-subject)\n- \u03ba\u2c7c ~ N(0, \u03c0\u00b2)  (between-occasion)\n</code></pre>"},{"location":"examples/population/02_iov/#parameters","title":"Parameters","text":"Parameter Population \u03c9 (IIV) \u03c0 (IOV) CL 5.0 L/h 0.3 0.15 V 50.0 L 0.2 0.1"},{"location":"examples/population/02_iov/#what-this-example-shows","title":"What This Example Shows","text":"<ol> <li>50 subjects with 3 dosing occasions each</li> <li>Each subject has consistent IIV across occasions</li> <li>Additional IOV varies by occasion</li> <li>Demonstrates within-subject variability</li> </ol>"},{"location":"examples/population/02_iov/#use-cases","title":"Use Cases","text":"<ul> <li>Multiple dose studies</li> <li>Crossover bioequivalence</li> <li>Chronic therapy monitoring</li> </ul>"},{"location":"examples/population/03_static_covariates/","title":"Static Covariates","text":"<p>Population simulation with weight and age effects on PK parameters.</p>"},{"location":"examples/population/03_static_covariates/#model","title":"Model","text":"<p>Weight on CL and V (allometric): <pre><code>CL = CL_pop \u00d7 (WT/70)^0.75\nV  = V_pop \u00d7 (WT/70)^1.0\n</code></pre></p> <p>Age on CL (linear decline): <pre><code>CL = CL_adj \u00d7 (1 - 0.01 \u00d7 (AGE - 40))\n</code></pre></p>"},{"location":"examples/population/03_static_covariates/#covariate-distribution","title":"Covariate Distribution","text":"Covariate Distribution Range Weight Normal(70, 15) 40-120 kg Age Normal(50, 15) 18-80 years"},{"location":"examples/population/03_static_covariates/#what-this-example-shows","title":"What This Example Shows","text":"<ol> <li>Generate realistic covariate distributions</li> <li>Apply covariate effects to parameters</li> <li>Residual IIV after covariate adjustment</li> <li>Variance explained by covariates</li> </ol>"},{"location":"examples/population/04_time_varying_covariates/","title":"Time-Varying Covariates","text":"<p>Population simulation with covariates that change over time (e.g., renal function).</p>"},{"location":"examples/population/04_time_varying_covariates/#model","title":"Model","text":"<p>Creatinine clearance (CrCL) affecting drug clearance: <pre><code>CL(t) = CL_pop \u00d7 (CrCL(t)/100)^0.5 \u00d7 exp(\u03b7_CL)\n</code></pre></p>"},{"location":"examples/population/04_time_varying_covariates/#use-cases","title":"Use Cases","text":"<ul> <li>Critically ill patients (changing renal function)</li> <li>Chronic therapy (disease progression)</li> <li>Drug interactions (enzyme induction over time)</li> </ul>"},{"location":"examples/population/05_complex_covariate_model/","title":"Complex Covariate Model","text":"<p>Full population model with multiple covariates, IIV, correlations, and residual error.</p>"},{"location":"examples/population/05_complex_covariate_model/#model","title":"Model","text":"<pre><code>CL = CL_pop \u00d7 (WT/70)^0.75 \u00d7 (CrCL/100)^0.5 \u00d7 \u03b8_sex^SEX \u00d7 exp(\u03b7_CL)\nV  = V_pop \u00d7 (WT/70)^1.0 \u00d7 exp(\u03b7_V)\nKa = Ka_pop \u00d7 exp(\u03b7_Ka)\n\nWhere:\n- \u03b7 ~ MVN(0, \u03a9)  with correlation between \u03b7_CL and \u03b7_V\n- \u03b5 ~ N(0, \u03c3\u00b2)   residual error\n</code></pre>"},{"location":"examples/population/05_complex_covariate_model/#covariates","title":"Covariates","text":"Covariate Effect On Type Value Weight CL, V Power 0.75, 1.0 CrCL CL Power 0.5 Sex CL Categorical 0.85 (female)"},{"location":"examples/population/05_complex_covariate_model/#omega-matrix-with-correlations","title":"Omega Matrix (with correlations)","text":"<pre><code>        CL    V     Ka\nCL   [ 0.09  0.02  0    ]\nV    [ 0.02  0.04  0    ]\nKa   [ 0     0     0.16 ]\n</code></pre> <p>Correlation CL-V \u2248 0.33</p>"},{"location":"examples/quickstart/","title":"Quickstart Examples","text":"<p>Get started with OpenPKPD in 5 minutes. These examples demonstrate a basic one-compartment IV bolus simulation.</p>"},{"location":"examples/quickstart/#files","title":"Files","text":"File Description <code>julia_first_simulation.jl</code> Julia quickstart <code>python_first_simulation.py</code> Python quickstart <code>cli_first_simulation.sh</code> CLI quickstart <code>spec.json</code> CLI specification file"},{"location":"examples/quickstart/#what-youll-learn","title":"What You'll Learn","text":"<ol> <li>Create a basic PK model specification</li> <li>Configure simulation parameters</li> <li>Run the simulation</li> <li>Extract key metrics (Cmax, Tmax, AUC)</li> </ol>"},{"location":"examples/quickstart/#the-model","title":"The Model","text":"<p>One-Compartment IV Bolus</p> <pre><code>Dose (100 mg IV)\n     \u2502\n     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Central   \u2502\n\u2502   V = 50 L  \u2502\u2500\u2500\u2500\u2500 CL = 5 L/h \u2500\u2500\u2500\u2500\u25b6 Elimination\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Parameters: - CL = 5 L/h (clearance) - V = 50 L (volume of distribution) - Dose = 100 mg at t=0</p> <p>Expected Results: - Cmax = 2.0 mg/L (at t=0) - AUC\u2080\u208b\u2082\u2084 \u2248 18.1 mg\u00b7h/L - t\u00bd \u2248 6.9 h</p>"},{"location":"examples/quickstart/#running-the-examples","title":"Running the Examples","text":""},{"location":"examples/quickstart/#julia","title":"Julia","text":"<pre><code>julia --project=core/OpenPKPDCore docs/examples/quickstart/julia_first_simulation.jl\n</code></pre>"},{"location":"examples/quickstart/#python","title":"Python","text":"<pre><code>source packages/python/.venv/bin/activate\npython docs/examples/quickstart/python_first_simulation.py\n</code></pre>"},{"location":"examples/quickstart/#cli","title":"CLI","text":"<pre><code>./bin/openpkpd simulate --spec docs/examples/quickstart/spec.json --out result.json\n./bin/openpkpd metrics --artifact result.json --metrics cmax,tmax,auc\n</code></pre>"},{"location":"examples/quickstart/#next-steps","title":"Next Steps","text":"<p>After completing the quickstart:</p> <ol> <li>Explore Models: See models for all available PK/PD models</li> <li>Add Variability: See population for IIV and covariates</li> <li>Fit to Data: See estimation for parameter estimation</li> <li>Real Analysis: See use_cases for complete workflows</li> </ol>"},{"location":"examples/real_world_validation/SOURCE/","title":"theo_md provenance","text":"<p>This dataset is <code>theo_md</code> distributed by the R package <code>nlmixr2data</code>.</p> <p>Description: - Starts with day 1 theophylline concentrations from the nlme/NONMEM teaching dataset - Later observations are simulated under a once-daily regimen as described by nlmixr2data</p> <p>Columns include: - ID, TIME, DV, AMT, EVID, CMT, WT</p>"},{"location":"examples/real_world_validation/datasets/theophylline_theo_md/SOURCE/","title":"theo_md provenance","text":"<p>This dataset is <code>theo_md</code> distributed by the R package <code>nlmixr2data</code>.</p>"},{"location":"examples/real_world_validation/datasets/theophylline_theo_md/SOURCE/#description","title":"Description","text":"<ul> <li>Starts with day 1 theophylline concentrations from the nlme/NONMEM teaching dataset</li> <li>Later observations are simulated under a once-daily regimen as described by nlmixr2data</li> </ul>"},{"location":"examples/real_world_validation/datasets/theophylline_theo_md/SOURCE/#columns","title":"Columns","text":"<ul> <li>ID: Subject identifier</li> <li>TIME: Time since first dose (hours)</li> <li>DV: Dependent variable (concentration, mg/L)</li> <li>AMT: Dose amount</li> <li>EVID: Event ID (0=observation, 1=dose)</li> <li>CMT: Compartment</li> <li>WT: Body weight (kg)</li> </ul>"},{"location":"examples/real_world_validation/datasets/theophylline_theo_sd/","title":"Theophylline theo_sd real-world validation","text":"<p>Dataset: - <code>theo_sd</code> from nlmixr2data (GPL &gt;= 3) - Columns: ID, TIME, DV, AMT, EVID, CMT, WT</p> <p>Design realism addressed: 1. Missing DV rows are ignored (kept for audit, excluded from RMSE). 2. Duplicate observation times are supported. 3. AMT ambiguity is handled explicitly:    - If AMT is small (typical mg/kg scale), dose_mg = AMT * WT    - Else dose_mg = AMT    This rule is recorded in artifact metadata. 4. Optional WT covariate scaling scenario:    - CL_i = CL_ref * (WT/70)^0.75    - V_i = V_ref * (WT/70)^1.0    This is simulation-only, no fitting.</p> <p>Outputs: - Per subject artifacts for:   - fixed params (no WT scaling)   - WT scaled params - Metrics JSON capturing RMSE for each scenario.</p>"},{"location":"examples/real_world_validation/datasets/theophylline_theo_sd/SOURCE/","title":"theo_sd provenance","text":"<p>This dataset is the <code>theo_sd</code> dataset distributed by the R package <code>nlmixr2data</code>.</p> <p>Description: - Day 1 concentrations from the theophylline data used in nlme/NONMEM teaching examples. - Columns include: ID, TIME (hr), DV (mg/L), AMT (mg), EVID, CMT, WT (kg).</p> <p>Upstream references: - nlmixr2data documentation for theo_sd - nlmixr tutorial/vignette describing use and context</p>"},{"location":"examples/real_world_validation/datasets/warfarin_nlmixr2data/","title":"Warfarin PK/PD real-world validation","text":"<p>Dataset: - nlmixr2data::warfarin (GPL &gt;= 3) - dv holds either PK concentration or PD endpoint value - dvid indicates endpoint identity</p> <p>Purpose: - Stress mixed PK/PD observations, dosing records, and deterministic replay. - Validate that coupled PKPD simulation can be compared against interleaved real observations.</p> <p>Model: - PK: 1-comp oral first-order - PD: indirect response turnover driven by concentration</p> <p>Approach: - No fitting. - Fixed parameters chosen solely to generate stable, reproducible predictions. - Compare predictions to observed rows by endpoint (dvid). - Report descriptive RMSE per subject and endpoint.</p> <p>Outputs: - One coupled artifact per subject - Metrics JSON per subject: rmse_pk, rmse_pd</p>"},{"location":"examples/real_world_validation/datasets/warfarin_nlmixr2data/SOURCE/","title":"warfarin provenance","text":"<p>This dataset is <code>warfarin</code> from the R package <code>nlmixr2data</code>.</p> <p>Format: - 519 rows, 9 columns - id (n=32), time (h), amt (mg), dv (warfarin concentration mg/L or PCA measurement),   dvid (endpoint identifier), evid, wt (kg), age (yr), sex (factor)</p> <p>Source reference noted in dataset docs: Funaki T, Holford N, Fujita S (2018). Population PKPD analysis using nlmixr2 and NONMEM.</p>"},{"location":"examples/real_world_validation/studies/theophylline_theo_md/","title":"Theophylline theo_md Multiple-Dose Validation","text":""},{"location":"examples/real_world_validation/studies/theophylline_theo_md/#dataset","title":"Dataset","text":"<ul> <li>Source: <code>theo_md</code> from nlmixr2data (GPL &gt;= 3)</li> <li>Columns: ID, TIME, DV, AMT, EVID, CMT, WT</li> </ul>"},{"location":"examples/real_world_validation/studies/theophylline_theo_md/#purpose","title":"Purpose","text":"<p>Stress test event handling and replay under multiple-dose designs: - Multiple dosing records per subject - Mixed dose and observation records - Long time horizons - Duplicated times and missing DV tolerance</p>"},{"location":"examples/real_world_validation/studies/theophylline_theo_md/#model","title":"Model","text":"<p>One-compartment oral PK with first-order absorption.</p> <p>Fixed parameters (no fitting): | Parameter | Value | Unit | |-----------|-------|------| | Ka | 1.59 | 1/hr | | CL | 2.75 | L/hr | | V | 31.8 | L |</p>"},{"location":"examples/real_world_validation/studies/theophylline_theo_md/#dose-handling","title":"Dose Handling","text":"<ul> <li>All records with AMT &gt; 0 are interpreted as dosing events</li> <li>Dose unit rule is explicit and recorded in metadata:</li> <li>If AMT &lt; 50: treat as mg/kg and multiply by WT</li> <li>Else: treat as mg</li> </ul>"},{"location":"examples/real_world_validation/studies/theophylline_theo_md/#outputs","title":"Outputs","text":"<ul> <li>One execution artifact per subject: <code>subj_&lt;id&gt;.json</code></li> <li>Metrics JSON with per-subject: id, wt, dose_unit_rule, dose_events, rmse</li> </ul>"},{"location":"examples/real_world_validation/studies/theophylline_theo_md/#running","title":"Running","text":"<pre><code># From repository root\njulia docs/examples/real_world_validation/datasets/theophylline_theo_md/run.jl\njulia docs/examples/real_world_validation/datasets/theophylline_theo_md/validate.jl\n</code></pre>"},{"location":"examples/real_world_validation/studies/theophylline_theo_sd/","title":"Theophylline theo_sd Real-World Validation","text":""},{"location":"examples/real_world_validation/studies/theophylline_theo_sd/#dataset","title":"Dataset","text":"<ul> <li>Source: <code>theo_sd</code> from nlmixr2data (GPL &gt;= 3)</li> <li>Columns: ID, TIME, DV, AMT, EVID, CMT, WT</li> </ul>"},{"location":"examples/real_world_validation/studies/theophylline_theo_sd/#design-realism-addressed","title":"Design Realism Addressed","text":"<ol> <li> <p>Missing DV rows: Ignored in RMSE calculation (kept for audit, excluded from metric).</p> </li> <li> <p>Duplicate observation times: Supported via unique grid with mapping back to all observations.</p> </li> <li> <p>AMT ambiguity: Handled explicitly with deterministic rule:</p> </li> <li>If AMT &lt; 50 (typical mg/kg scale): <code>dose_mg = AMT * WT</code></li> <li>Otherwise: <code>dose_mg = AMT</code></li> <li> <p>Rule is recorded in artifact metadata as <code>dose_unit_rule</code></p> </li> <li> <p>WT covariate scaling scenario: Two simulation modes:</p> </li> <li>Fixed: CL = 2.75 L/hr, V = 31.8 L (population typical)</li> <li>WT-scaled:<ul> <li><code>CL_i = CL_ref * (WT/70)^0.75</code></li> <li><code>V_i = V_ref * (WT/70)^1.0</code></li> </ul> </li> </ol> <p>This is simulation-only validation (no fitting).</p>"},{"location":"examples/real_world_validation/studies/theophylline_theo_sd/#model-parameters","title":"Model Parameters","text":"Parameter Value Unit Ka 1.59 1/hr CL_ref 2.75 L/hr V_ref 31.8 L WT_ref 70.0 kg"},{"location":"examples/real_world_validation/studies/theophylline_theo_sd/#outputs","title":"Outputs","text":"<p>Per subject (12 subjects total): - <code>subj_&lt;id&gt;_fixed.json</code> - Fixed parameter artifact - <code>subj_&lt;id&gt;_wt_scaled.json</code> - WT-scaled parameter artifact</p> <p>Metrics JSON with per-subject: - <code>id</code>, <code>wt</code>, <code>dose_mg</code> - <code>dose_unit_rule</code> - How AMT was interpreted - <code>rmse_fixed</code> - RMSE for fixed params - <code>rmse_wt_scaled</code> - RMSE for WT-scaled params</p>"},{"location":"examples/real_world_validation/studies/theophylline_theo_sd/#running","title":"Running","text":"<pre><code># From repository root\njulia docs/examples/real_world_validation/datasets/theophylline_theo_sd/run.jl\n\n# Copy to expected (first time or when regenerating)\nrm -f docs/examples/real_world_validation/studies/theophylline_theo_sd/expected/*.json\ncp docs/examples/real_world_validation/studies/theophylline_theo_sd/output/*.json \\\n   docs/examples/real_world_validation/studies/theophylline_theo_sd/expected/\n\n# Validate\njulia docs/examples/real_world_validation/datasets/theophylline_theo_sd/validate.jl\n</code></pre>"},{"location":"examples/real_world_validation/studies/theophylline_theo_sd/#validation","title":"Validation","text":"<ul> <li>Metrics compared with strict tolerance (1e-12)</li> <li>All artifacts replayed and compared</li> <li>Both fixed and WT-scaled scenarios validated</li> </ul>"},{"location":"examples/real_world_validation/studies/warfarin_pkpd/","title":"Warfarin PKPD Validation Study","text":"<p>Validation of OpenPKPD against warfarin pharmacokinetic-pharmacodynamic data.</p>"},{"location":"examples/real_world_validation/studies/warfarin_pkpd/#dataset","title":"Dataset","text":"<ul> <li>Source: nlmixr2data package</li> <li>Drug: Warfarin (anticoagulant)</li> <li>Type: PKPD (PK + PD effect)</li> </ul>"},{"location":"examples/real_world_validation/studies/warfarin_pkpd/#model","title":"Model","text":"<ul> <li>PK: One-compartment oral</li> <li>PD: Indirect response model</li> </ul>"},{"location":"examples/real_world_validation/studies/warfarin_pkpd/#see-also","title":"See Also","text":"<ul> <li>Theophylline SD Study</li> <li>Theophylline MD Study</li> </ul>"},{"location":"examples/reproducibility/","title":"Reproducibility Examples","text":"<p>Examples demonstrating artifact creation, replay, and version validation.</p>"},{"location":"examples/reproducibility/#examples","title":"Examples","text":"Example Description Artifact Creation Create reproducible simulation artifacts Artifact Replay Replay and validate artifacts Version Validation Validate across OpenPKPD versions"},{"location":"examples/reproducibility/#overview","title":"Overview","text":"<p>OpenPKPD ensures reproducibility through: - Deterministic simulation with seeds - Artifact serialization with full state - Version-aware replay and validation</p>"},{"location":"examples/reproducibility/#see-also","title":"See Also","text":"<ul> <li>Sensitivity Examples</li> <li>Population Examples</li> </ul>"},{"location":"examples/sensitivity/","title":"Sensitivity Analysis Examples","text":"<p>Examples demonstrating parameter sensitivity analysis for pharmacometric models.</p>"},{"location":"examples/sensitivity/#examples","title":"Examples","text":"Example Description Directory Single Subject Parameter perturbation 01_single_subject Population Population-level sensitivity 02_population Tornado Plot Visual sensitivity display 03_tornado_plot"},{"location":"examples/sensitivity/#what-is-sensitivity-analysis","title":"What is Sensitivity Analysis?","text":"<p>Sensitivity analysis examines how changes in model parameters affect outputs:</p> <ul> <li>Local sensitivity: Small perturbations around nominal values</li> <li>Global sensitivity: Large parameter ranges, interactions</li> <li>Parameter ranking: Which parameters most affect outputs</li> </ul>"},{"location":"examples/sensitivity/#key-metrics","title":"Key Metrics","text":"Metric Description Use AUC Area under curve Exposure Cmax Maximum concentration Safety Cmin Trough concentration Efficacy t_half Half-life Dosing interval"},{"location":"examples/sensitivity/#usage","title":"Usage","text":"<pre><code>from openpkpd import compute_sensitivity\n\nresult = compute_sensitivity(\n    model_spec,\n    parameters=[\"CL\", \"V\", \"Ka\"],\n    perturbation=0.10,  # \u00b110%\n    metrics=[\"auc\", \"cmax\", \"tmax\"]\n)\n\nprint(result.sensitivity_matrix)\n</code></pre>"},{"location":"examples/sensitivity/#see-also","title":"See Also","text":"<ul> <li>Models - Model specifications</li> <li>Population - Population modeling</li> </ul>"},{"location":"examples/sensitivity/01_single_subject/","title":"Single Subject Sensitivity","text":"<p>Local sensitivity analysis for individual parameter perturbations.</p>"},{"location":"examples/sensitivity/01_single_subject/#method","title":"Method","text":"<ol> <li>Simulate at nominal parameter values</li> <li>Perturb each parameter by \u00b1X%</li> <li>Compare output metrics</li> <li>Calculate sensitivity coefficients</li> </ol>"},{"location":"examples/sensitivity/01_single_subject/#files","title":"Files","text":"File Description python.py Python implementation julia.jl Julia implementation"},{"location":"examples/sensitivity/02_population/","title":"Population Sensitivity Analysis","text":"<p>Sensitivity analysis at the population level, accounting for IIV.</p>"},{"location":"examples/sensitivity/02_population/#method","title":"Method","text":"<ol> <li>Simulate population at nominal parameters</li> <li>Perturb population parameters (typical values, omegas)</li> <li>Compare population-level metrics (median, CV)</li> <li>Rank parameter importance</li> </ol>"},{"location":"examples/sensitivity/02_population/#files","title":"Files","text":"File Description python.py Python implementation"},{"location":"examples/sensitivity/03_tornado_plot/","title":"Tornado Plot","text":"<p>Visual representation of parameter sensitivity.</p>"},{"location":"examples/sensitivity/03_tornado_plot/#features","title":"Features","text":"<ul> <li>Horizontal bar chart</li> <li>Parameters ranked by impact</li> <li>Positive/negative effects shown</li> <li>Multiple metrics supported</li> </ul>"},{"location":"examples/sensitivity/03_tornado_plot/#files","title":"Files","text":"File Description plot.py Python plotting example"},{"location":"examples/trial/","title":"Clinical Trial Simulation Examples","text":"<p>Examples demonstrating clinical trial design and simulation capabilities.</p>"},{"location":"examples/trial/#examples","title":"Examples","text":"Example Description Directory Parallel Design Two-arm parallel group study 01_parallel_design Crossover Design 2x2 crossover study 02_crossover_design 3+3 Dose Escalation Phase I dose escalation 03_dose_escalation_3plus3 Bioequivalence BE study with TOST analysis 04_bioequivalence_study Power Analysis Sample size and power 05_power_analysis"},{"location":"examples/trial/#study-design-types","title":"Study Design Types","text":"Design Use Case Key Features Parallel Phase II/III efficacy Independent arms, randomization Crossover BE, Phase I Within-subject comparison, washout Dose Escalation Phase I FIH Safety-driven, cohort-based Adaptive Phase II/III Interim analyses, alpha spending"},{"location":"examples/trial/#key-concepts","title":"Key Concepts","text":""},{"location":"examples/trial/#study-components","title":"Study Components","text":"<ol> <li>Design: Structure (parallel, crossover, adaptive)</li> <li>Arms: Treatment groups with dosing regimens</li> <li>Population: Virtual subjects with demographics</li> <li>Endpoints: PK exposure, efficacy, safety</li> </ol>"},{"location":"examples/trial/#simulation-features","title":"Simulation Features","text":"<ul> <li>Enrollment and randomization</li> <li>Dropout modeling</li> <li>Compliance patterns</li> <li>Multiple replicates</li> </ul>"},{"location":"examples/trial/#usage","title":"Usage","text":"<pre><code>from openpkpd import trial\n\n# Simple parallel study\nspec = trial.TrialSpec(\n    name=\"Phase 2 Study\",\n    design=trial.parallel_design(2),\n    arms=[\n        trial.TreatmentArm(\"Placebo\", trial.dosing_qd(0.0, 28), 50, placebo=True),\n        trial.TreatmentArm(\"Active\", trial.dosing_qd(100.0, 28), 50),\n    ],\n    duration_days=28,\n    seed=42\n)\n\nresult = trial.simulate_trial(spec)\nprint(f\"Completion rate: {result.overall_completion_rate:.1%}\")\n</code></pre>"},{"location":"examples/trial/#see-also","title":"See Also","text":"<ul> <li>Population Examples - Virtual population generation</li> <li>NCA Examples - Non-compartmental analysis</li> <li>VPC Examples - Model validation</li> </ul>"},{"location":"examples/trial/01_parallel_design/","title":"Parallel Group Design","text":"<p>Two-arm parallel group Phase II efficacy study simulation.</p>"},{"location":"examples/trial/01_parallel_design/#design","title":"Design","text":"<ul> <li>Type: Parallel, 1:1 randomization</li> <li>Arms: Placebo vs Active (100 mg QD)</li> <li>Duration: 28 days</li> <li>N per arm: 50 subjects</li> <li>Endpoints: PK exposure</li> </ul>"},{"location":"examples/trial/01_parallel_design/#features-demonstrated","title":"Features Demonstrated","text":"<ul> <li>Parallel design creation</li> <li>Treatment arm specification</li> <li>QD dosing regimen</li> <li>Dropout modeling</li> <li>Compliance patterns</li> <li>Trial simulation</li> </ul>"},{"location":"examples/trial/01_parallel_design/#files","title":"Files","text":"File Description python.py Python implementation julia.jl Julia implementation cli.json CLI specification"},{"location":"examples/trial/01_parallel_design/#expected-output","title":"Expected Output","text":"<pre><code>Phase 2 Parallel Study\n======================\nDesign: 2-arm parallel (1:1)\nDuration: 28 days\n\nArm Results:\n  Placebo: 48/50 completed (96.0%)\n  Active:  47/50 completed (94.0%)\n\nOverall completion: 95.0%\nOverall compliance: 89.5%\n</code></pre>"},{"location":"examples/trial/02_crossover_design/","title":"2x2 Crossover Design","text":"<p>Two-period, two-sequence crossover study for within-subject comparison.</p>"},{"location":"examples/trial/02_crossover_design/#design","title":"Design","text":"<ul> <li>Type: 2x2 crossover (AB, BA)</li> <li>Treatments: Reference vs Test formulation</li> <li>Washout: 7 days between periods</li> <li>N per sequence: 12 subjects</li> <li>Endpoints: PK exposure (Cmax, AUC)</li> </ul>"},{"location":"examples/trial/02_crossover_design/#sequences","title":"Sequences","text":"Sequence Period 1 Washout Period 2 AB Reference 7 days Test BA Test 7 days Reference"},{"location":"examples/trial/02_crossover_design/#features-demonstrated","title":"Features Demonstrated","text":"<ul> <li>2x2 crossover design creation</li> <li>Washout period specification</li> <li>Period-specific dosing</li> <li>Within-subject analysis</li> </ul>"},{"location":"examples/trial/02_crossover_design/#files","title":"Files","text":"File Description python.py Python implementation julia.jl Julia implementation cli.json CLI specification"},{"location":"examples/trial/02_crossover_design/#expected-output","title":"Expected Output","text":"<pre><code>2x2 Crossover Study\n===================\nDesign: 2 periods, 2 sequences\nWashout: 7 days\n\nSequence AB: 12 subjects\nSequence BA: 12 subjects\n\nCompletion rate: 95.8%\n</code></pre>"},{"location":"examples/trial/03_dose_escalation_3plus3/","title":"3+3 Dose Escalation Design","text":"<p>Traditional rule-based dose escalation for Phase I first-in-human studies.</p>"},{"location":"examples/trial/03_dose_escalation_3plus3/#design","title":"Design","text":"<ul> <li>Type: 3+3 dose escalation</li> <li>Dose levels: 10, 25, 50, 100, 200 mg</li> <li>Cohort size: 3 subjects</li> <li>Max DLT rate: 33%</li> <li>Max subjects: 30</li> </ul>"},{"location":"examples/trial/03_dose_escalation_3plus3/#escalation-rules","title":"Escalation Rules","text":"DLTs in Cohort Action 0/3 Escalate to next dose 1/3 Expand cohort (+3) 0-1/6 Escalate to next dose 2+/3 or 2+/6 Stop, previous dose is MTD"},{"location":"examples/trial/03_dose_escalation_3plus3/#features-demonstrated","title":"Features Demonstrated","text":"<ul> <li>Dose escalation design</li> <li>Rule-based decisions</li> <li>DLT probability modeling</li> <li>MTD determination</li> </ul>"},{"location":"examples/trial/03_dose_escalation_3plus3/#files","title":"Files","text":"File Description python.py Python implementation julia.jl Julia implementation cli.json CLI specification"},{"location":"examples/trial/03_dose_escalation_3plus3/#expected-output","title":"Expected Output","text":"<pre><code>3+3 Dose Escalation Study\n=========================\nDose levels: [10, 25, 50, 100, 200] mg\nStarting dose: 10 mg\nMax subjects: 30\n\nCohort 1 (10 mg): 0/3 DLTs -&gt; Escalate\nCohort 2 (25 mg): 0/3 DLTs -&gt; Escalate\nCohort 3 (50 mg): 1/3 DLTs -&gt; Expand\nCohort 4 (50 mg): 0/3 DLTs (1/6 total) -&gt; Escalate\nCohort 5 (100 mg): 2/3 DLTs -&gt; Stop\n\nRecommended MTD: 50 mg\nTotal subjects: 15\n</code></pre>"},{"location":"examples/trial/04_bioequivalence_study/","title":"Bioequivalence Study","text":"<p>Complete bioequivalence study with 2x2 crossover design and TOST analysis.</p>"},{"location":"examples/trial/04_bioequivalence_study/#design","title":"Design","text":"<ul> <li>Type: 2x2 crossover bioequivalence</li> <li>Treatments: Reference vs Test formulation</li> <li>N: 24 subjects (12 per sequence)</li> <li>Washout: 7 days</li> <li>BE limits: 80.00% - 125.00%</li> <li>Parameters: Cmax, AUC0-inf</li> </ul>"},{"location":"examples/trial/04_bioequivalence_study/#regulatory-guidance","title":"Regulatory Guidance","text":"<p>Following FDA guidance for BE studies: - 90% CI for GMR must be within [0.80, 1.25] - Log-transformed data - TOST (Two One-Sided Tests) procedure</p>"},{"location":"examples/trial/04_bioequivalence_study/#features-demonstrated","title":"Features Demonstrated","text":"<ul> <li>BE study design</li> <li>NCA parameter calculation</li> <li>90% CI for geometric mean ratio</li> <li>BE assessment per FDA guidance</li> </ul>"},{"location":"examples/trial/04_bioequivalence_study/#files","title":"Files","text":"File Description python.py Python implementation julia.jl Julia implementation cli.json CLI specification"},{"location":"examples/trial/04_bioequivalence_study/#expected-output","title":"Expected Output","text":"<pre><code>Bioequivalence Study\n====================\nDesign: 2x2 crossover\nN: 24 subjects\nBE limits: [0.80, 1.25]\n\nResults:\n--------\nParameter   GMR      90% CI           BE?\nCmax        0.9845   [0.8912, 1.0875] Yes\nAUC0-inf    1.0123   [0.9456, 1.0834] Yes\n\nConclusion: Bioequivalence demonstrated\n</code></pre>"},{"location":"examples/trial/05_power_analysis/","title":"Power Analysis and Sample Size","text":"<p>Statistical power analysis and sample size estimation for clinical trials.</p>"},{"location":"examples/trial/05_power_analysis/#features","title":"Features","text":"<ul> <li>Power calculation for given sample size</li> <li>Sample size estimation for target power</li> <li>Effect size interpretation (Cohen's d)</li> <li>Multiple comparison considerations</li> </ul>"},{"location":"examples/trial/05_power_analysis/#cohens-d-reference","title":"Cohen's d Reference","text":"Effect Size Cohen's d Interpretation Small 0.2 Subtle difference Medium 0.5 Moderate difference Large 0.8 Obvious difference"},{"location":"examples/trial/05_power_analysis/#sample-size-guide-80-power-alpha005","title":"Sample Size Guide (80% power, alpha=0.05)","text":"Effect Size N per arm Small (0.2) ~394 Medium (0.5) ~64 Large (0.8) ~26"},{"location":"examples/trial/05_power_analysis/#features-demonstrated","title":"Features Demonstrated","text":"<ul> <li>Analytical power calculation</li> <li>Sample size estimation</li> <li>Dropout adjustment</li> <li>Power curves</li> </ul>"},{"location":"examples/trial/05_power_analysis/#files","title":"Files","text":"File Description python.py Python implementation julia.jl Julia implementation"},{"location":"examples/trial/05_power_analysis/#expected-output","title":"Expected Output","text":"<pre><code>Power Analysis\n==============\n\nGiven: n=50 per arm, effect=0.5, alpha=0.05\nCalculated power: 69.7%\n\nSample Size Estimation\n======================\nTarget: 80% power, effect=0.5, alpha=0.05\nRequired N per arm: 64\nTotal N: 128\nAchieved power: 80.1%\n\nWith 15% dropout adjustment:\nRequired N per arm: 76\nTotal N: 152\n</code></pre>"},{"location":"examples/use_cases/bioequivalence_study/","title":"Bioequivalence Study Use Case","text":"<p>Complete bioequivalence study workflow from design to analysis.</p>"},{"location":"examples/use_cases/bioequivalence_study/#workflow-steps","title":"Workflow Steps","text":"<ol> <li>Design 2x2 crossover study</li> <li>Simulate virtual trial</li> <li>Compute NCA metrics (Cmax, AUC)</li> <li>Perform TOST statistical analysis</li> <li>Generate report</li> </ol>"},{"location":"examples/use_cases/bioequivalence_study/#see-also","title":"See Also","text":"<ul> <li>Trial Examples</li> <li>NCA Examples</li> </ul>"},{"location":"examples/use_cases/fih_dose_exploration/","title":"FIH dose exploration","text":"<p>This use case models first-in-human dose exploration using a population PK model with covariates.</p> <p>Purpose: - Provide a realistic, reproducible workflow that maps to day-to-day PK decision making. - Validate deterministic execution and artifact replay under a practical scenario.</p> <p>Model: - One-compartment IV bolus PK - Parameters: CL, V - Covariates:   - WT on CL via power model exponent 0.75 (ref 70 kg)   - WT on V via power model exponent 1.0 (ref 70 kg)</p> <p>Population: - Cohort weights: fixed list, deterministic - IIV: log-normal on CL and V - Seeded RNG</p> <p>Scenarios: - Dose levels: 10 mg, 30 mg, 100 mg, 300 mg (single dose)</p> <p>Outputs: - Concentration time series per individual - Summary: mean, median, p05, p95 - Exposure metrics from mean curve: Cmax, AUC0-24</p> <p>Validation: - Artifacts generated by run.jl must replay exactly. - Stored expected artifacts are compared via golden-style validation.</p>"},{"location":"examples/use_cases/nonmem_migration/","title":"NONMEM Migration Use Case","text":"<p>Complete workflow for migrating NONMEM models to OpenPKPD.</p>"},{"location":"examples/use_cases/nonmem_migration/#workflow-steps","title":"Workflow Steps","text":"<ol> <li>Import NONMEM control file</li> <li>Import CDISC data</li> <li>Validate simulation matches NONMEM</li> <li>Re-estimate with FOCE-I</li> <li>Generate VPC</li> <li>Compare results</li> </ol>"},{"location":"examples/use_cases/nonmem_migration/#see-also","title":"See Also","text":"<ul> <li>Model Import Examples</li> <li>Estimation Examples</li> </ul>"},{"location":"examples/use_cases/pkpd_biomarker_turnover/","title":"PKPD Biomarker Turnover","text":"<p>This use case models exposure-driven biomarker suppression using a coupled PKPD indirect response turnover model.</p>"},{"location":"examples/use_cases/pkpd_biomarker_turnover/#purpose","title":"Purpose","text":"<ul> <li>Validate coupled PKPD, regimen comparison, and IOV behavior under realistic workflows</li> <li>Provide a reproducible, replayable contract for response metrics used in decision making</li> </ul>"},{"location":"examples/use_cases/pkpd_biomarker_turnover/#models","title":"Models","text":"<p>PK Model: One-compartment IV bolus (CL=10 L/h, V=50 L typical)</p> <p>PD Model: Indirect response turnover - Baseline R0 = Kin / Kout = 100 - Drug effect: inhibitory Emax (Imax=0.9, IC50=5)</p>"},{"location":"examples/use_cases/pkpd_biomarker_turnover/#scenarios","title":"Scenarios","text":"Regimen Doses QD 100 mg at 0, 24, 48 h BID 50 mg at 0, 12, 24, 36, 48, 60 h <p>Each scenario runs with and without IOV on CL across occasions.</p>"},{"location":"examples/use_cases/pkpd_biomarker_turnover/#outputs","title":"Outputs","text":"<ul> <li>Population artifacts with mean and quantile response summaries</li> <li>Decision metrics: Emin, time below 80% baseline, suppression AUC</li> </ul>"},{"location":"examples/use_cases/pkpd_biomarker_turnover/#running","title":"Running","text":"<pre><code>julia docs/examples/use_cases/pkpd_biomarker_turnover/run.jl\njulia docs/examples/use_cases/pkpd_biomarker_turnover/validate.jl\n</code></pre>"},{"location":"examples/use_cases/population_pkpd_analysis/","title":"Population PKPD Analysis Use Case","text":"<p>Full population pharmacokinetic-pharmacodynamic analysis workflow.</p>"},{"location":"examples/use_cases/population_pkpd_analysis/#workflow-steps","title":"Workflow Steps","text":"<ol> <li>Exploratory data analysis</li> <li>PK model development</li> <li>PD model development</li> <li>Combined PKPD model</li> <li>Covariate analysis</li> <li>VPC for PK and PD</li> <li>Final report</li> </ol>"},{"location":"examples/use_cases/population_pkpd_analysis/#see-also","title":"See Also","text":"<ul> <li>Population Examples</li> <li>Estimation Examples</li> <li>VPC Examples</li> </ul>"},{"location":"examples/use_cases/real_world_theophylline/","title":"Real-World Theophylline Analysis","text":"<p>Complete analysis workflow using real theophylline pharmacokinetic data.</p>"},{"location":"examples/use_cases/real_world_theophylline/#workflow-steps","title":"Workflow Steps","text":"<ol> <li>Data exploration</li> <li>NCA analysis</li> <li>Parameter estimation</li> <li>Model diagnostics</li> <li>VPC validation</li> <li>Report generation</li> </ol>"},{"location":"examples/use_cases/real_world_theophylline/#see-also","title":"See Also","text":"<ul> <li>NCA Examples</li> <li>Estimation Examples</li> <li>VPC Examples</li> </ul>"},{"location":"examples/visualization/","title":"Visualization Examples","text":"<p>Examples demonstrating plotting and visualization for pharmacometric analyses.</p>"},{"location":"examples/visualization/#plot-types","title":"Plot Types","text":"Plot Use Case Directory Concentration-Time Single subject PK 01_concentration_time Spaghetti Plot Population PK 02_population_spaghetti VPC Plot Model validation 03_vpc_plots Diagnostics Estimation GOF 04_estimation_diagnostics"},{"location":"examples/visualization/#quick-start","title":"Quick Start","text":"<pre><code>from openpkpd.viz import plot_concentration_time, plot_vpc, plot_gof\nimport matplotlib.pyplot as plt\n\n# Concentration-time plot\nfig, ax = plot_concentration_time(result, title=\"PK Profile\")\nplt.savefig(\"pk_profile.png\")\n\n# VPC plot\nfig, ax = plot_vpc(vpc_result, title=\"Visual Predictive Check\")\nplt.savefig(\"vpc.png\")\n\n# Goodness-of-fit\nfig = plot_gof(estimation_result)\nplt.savefig(\"gof.png\")\n</code></pre>"},{"location":"examples/visualization/#customization","title":"Customization","text":"<p>All plotting functions return matplotlib figures that can be customized:</p> <pre><code>fig, ax = plot_concentration_time(result)\nax.set_xlabel(\"Time (hours)\")\nax.set_ylabel(\"Concentration (ng/mL)\")\nax.set_xlim(0, 24)\nax.grid(True, alpha=0.3)\nfig.savefig(\"custom_plot.png\", dpi=300, bbox_inches=\"tight\")\n</code></pre>"},{"location":"examples/visualization/#see-also","title":"See Also","text":"<ul> <li>NCA Examples - NCA metrics</li> <li>VPC Examples - VPC computation</li> <li>Estimation Examples - Parameter estimation</li> </ul>"},{"location":"examples/visualization/01_concentration_time/","title":"Concentration-Time Plot","text":"<p>Basic PK concentration-time profile visualization.</p>"},{"location":"examples/visualization/01_concentration_time/#features","title":"Features","text":"<ul> <li>Linear and semi-log scales</li> <li>Multiple compartments</li> <li>Dose annotation</li> <li>Customizable styling</li> </ul>"},{"location":"examples/visualization/01_concentration_time/#files","title":"Files","text":"File Description plot.py Python plotting example"},{"location":"examples/visualization/02_population_spaghetti/","title":"Population Spaghetti Plot","text":"<p>Visualization of population PK profiles with individual trajectories.</p>"},{"location":"examples/visualization/02_population_spaghetti/#features","title":"Features","text":"<ul> <li>Individual subject lines</li> <li>Population median/mean overlay</li> <li>Confidence bands</li> <li>Observed data overlay</li> </ul>"},{"location":"examples/visualization/02_population_spaghetti/#files","title":"Files","text":"File Description plot.py Python plotting example"},{"location":"examples/visualization/03_vpc_plots/","title":"VPC Plots","text":"<p>Visual Predictive Check visualization for model validation.</p>"},{"location":"examples/visualization/03_vpc_plots/#features","title":"Features","text":"<ul> <li>Observed data overlay</li> <li>Simulated prediction intervals</li> <li>Quantile bands (5th, 50th, 95th)</li> <li>BLQ handling</li> </ul>"},{"location":"examples/visualization/03_vpc_plots/#files","title":"Files","text":"File Description plot.py Python plotting example"},{"location":"examples/visualization/04_estimation_diagnostics/","title":"Estimation Diagnostic Plots","text":"<p>Goodness-of-fit and diagnostic plots for parameter estimation.</p>"},{"location":"examples/visualization/04_estimation_diagnostics/#plot-types","title":"Plot Types","text":"<ul> <li>DV vs PRED</li> <li>DV vs IPRED</li> <li>CWRES vs Time</li> <li>CWRES vs PRED</li> <li>ETA distributions</li> <li>QQ plots</li> </ul>"},{"location":"examples/visualization/04_estimation_diagnostics/#files","title":"Files","text":"File Description plot.py Python plotting example"},{"location":"examples/vpc/","title":"Visual Predictive Check (VPC)","text":"<p>Examples demonstrating VPC generation for model validation.</p>"},{"location":"examples/vpc/#what-is-vpc","title":"What is VPC?","text":"<p>VPC compares simulated data from the model to observed data: 1. Simulate n replicates (e.g., 500) using final model estimates 2. Compute quantiles (5th, 50th, 95th) of simulated data at each time 3. Overlay observed data 4. Check if observed quantiles fall within simulated confidence intervals</p>"},{"location":"examples/vpc/#vpc-types","title":"VPC Types","text":"Type Description Use Case Standard VPC Basic VPC Initial validation pcVPC Prediction-corrected Variable dosing Stratified By covariate Covariate effects VPC with BLQ Below LOQ handling Assay limits"},{"location":"examples/vpc/#examples","title":"Examples","text":"Example Description Directory Standard VPC Basic implementation 01_standard_vpc pcVPC Prediction-corrected 02_prediction_corrected_vpc"},{"location":"examples/vpc/#usage","title":"Usage","text":"<pre><code>using OpenPKPDCore\n\n# Generate VPC\nvpc_result = compute_vpc(\n    observed_data,\n    pop_spec,\n    n_simulations = 500,\n    quantiles = [0.05, 0.5, 0.95],\n    seed = 12345\n)\n\n# Access results\nsim_quantiles = vpc_result.simulated_quantiles  # Simulated CI\nobs_quantiles = vpc_result.observed_quantiles   # Observed data\n</code></pre>"},{"location":"examples/vpc/#interpretation","title":"Interpretation","text":"<p>Good VPC: - Observed median close to simulated median - 90% of observed data within 90% simulated PI - No systematic deviations</p> <p>Poor VPC signals: - Median bias \u2192 Structural model misspecification - Over-prediction \u2192 IIV too large - Under-prediction \u2192 IIV too small</p>"},{"location":"examples/vpc/01_standard_vpc/","title":"Standard VPC","text":"<p>Basic Visual Predictive Check implementation.</p>"},{"location":"examples/vpc/01_standard_vpc/#method","title":"Method","text":"<ol> <li>Simulate n replicates (e.g., 500) using final model estimates</li> <li>Compute quantiles (5th, 50th, 95th) of simulated data</li> <li>Overlay observed data</li> <li>Check if observed quantiles fall within simulated CI</li> </ol>"},{"location":"examples/vpc/01_standard_vpc/#files","title":"Files","text":"File Description julia.jl Julia implementation python.py Python implementation"},{"location":"examples/vpc/02_prediction_corrected_vpc/","title":"Prediction-Corrected VPC","text":"<p>VPC with prediction correction for variable dosing scenarios.</p>"},{"location":"examples/vpc/02_prediction_corrected_vpc/#when-to-use","title":"When to Use","text":"<p>pcVPC is useful when: - Different doses across subjects - Variable dosing schedules - Covariate-dependent predictions</p>"},{"location":"examples/vpc/02_prediction_corrected_vpc/#method","title":"Method","text":"<p>Observations and predictions are normalized by the population prediction before computing quantiles.</p>"},{"location":"examples/vpc/02_prediction_corrected_vpc/#see-also","title":"See Also","text":"<ul> <li>Standard VPC</li> </ul>"}]}